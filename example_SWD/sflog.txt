2024-07-27 11:41:16 [INFO] | running setup for all modules
2024-07-27 11:41:29 [INFO] | initializing 30 solver directories
2024-07-27 11:41:42 [INFO] | adding 30 solver dispersion directories
2024-07-27 11:41:52 [INFO] | no optimization checkpoint file, assume 1st iteration
2024-07-27 11:41:55 [INFO] | 
================================================================================
                              RUNNING ITERATION 01                              
================================================================================
2024-07-27 11:41:55 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:41:55 [INFO] | checking true/target model parameters:
2024-07-27 11:41:55 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:41:55 [INFO] | vs: min=482.425; mean=718.291; max=942.621
2024-07-27 11:41:55 [INFO] | running functions ['_generate_synthetic_data_single'] on system 30 times
2024-07-27 11:42:09 [INFO] | running functions ['_generate_dispersion_curve_single'] on system 30 times
2024-07-27 11:42:12 [INFO] | running functions ['_generate_dispersion_curve_single'] on system 30 times
2024-07-27 11:42:15 [INFO] | running functions ['_generate_dispersion_curve_single'] on system 30 times
2024-07-27 11:42:18 [INFO] | running functions ['_generate_dispersion_curve_single'] on system 30 times
2024-07-27 11:42:21 [INFO] | running functions ['_generate_dispersion_curve_single'] on system 30 times
2024-07-27 11:42:24 [INFO] | running functions ['_generate_dispersion_curve_single'] on system 30 times
2024-07-27 11:42:27 [INFO] | running functions ['_generate_dispersion_curve_single'] on system 30 times
2024-07-27 11:42:30 [INFO] | running functions ['_generate_dispersion_curve_single'] on system 30 times
2024-07-27 11:42:33 [INFO] | running functions ['_generate_dispersion_curve_single'] on system 30 times
2024-07-27 11:42:35 [INFO] | running functions ['_generate_dispersion_curve_single'] on system 30 times
2024-07-27 11:42:38 [INFO] | running functions ['_generate_dispersion_curve_single'] on system 30 times
2024-07-27 11:42:41 [INFO] | running functions ['_generate_dispersion_curve_single'] on system 30 times
2024-07-27 11:42:44 [INFO] | running functions ['_generate_dispersion_curve_single'] on system 30 times
2024-07-27 11:42:46 [INFO] | running functions ['_generate_dispersion_curve_single'] on system 30 times
2024-07-27 11:42:49 [INFO] | running functions ['_generate_dispersion_curve_single'] on system 30 times
2024-07-27 11:42:52 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:42:52 [INFO] | evaluating misfit for model in `path_model_init`
2024-07-27 11:42:52 [INFO] | checking model parameters:
2024-07-27 11:42:52 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:42:52 [INFO] | vs: min=481.776; mean=704.544; max=934.848
2024-07-27 11:42:52 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:43:05 [INFO] | misfit f_new (i01s00) = 3.007E+03
2024-07-27 11:43:05 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:43:05 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 11:43:25 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:43:25 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 11:43:53 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:43:53 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:43:54 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:43:54 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 11:43:56 [INFO] | exporting gradient to disk
2024-07-27 11:43:56 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 11:43:56 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:43:56 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 11:43:56 [INFO] | LBFGS iteration incremented -> 1
2024-07-27 11:43:56 [INFO] | first L-BFGS iteration, default to gradient descent (P = -G)
2024-07-27 11:43:56 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:43:56 [INFO] | step length `alpha` = 7.597E+08
2024-07-27 11:43:56 [INFO] | updating model with `dm` (dm_min=-2.01E+00, dm_max = 1.87E+01)
2024-07-27 11:43:56 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:43:56 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 11:43:56 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 11:43:56 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:43:56 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:43:56 [INFO] | vs: min=482.008; mean=708.390; max=935.333
2024-07-27 11:43:56 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:44:14 [INFO] | misfit f_try (i01s01) = 2.547E+03
2024-07-27 11:44:14 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:44:14 [INFO] | saving misfit and step length for step count == 1
2024-07-27 11:44:14 [INFO] | step count  =         0,         1
2024-07-27 11:44:14 [INFO] | step length = 0.000E+00, 7.597E+08
2024-07-27 11:44:14 [INFO] | misfit val  = 3.007E+03, 2.547E+03
2024-07-27 11:44:14 [INFO] | increment step count -> 2
2024-07-27 11:44:14 [INFO] | first iteration, defaulting to bracketing line search
2024-07-27 11:44:14 [INFO] | try: misfit not bracketed, increasing step length using golden ratio
2024-07-27 11:44:14 [INFO] | step length `alpha` = 1.229E+09
2024-07-27 11:44:14 [INFO] | updating model with `dm` (dm_min=-3.25E+00, dm_max = 3.03E+01)
2024-07-27 11:44:14 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 11:44:14 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 11:44:14 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 11:44:14 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:44:14 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:44:14 [INFO] | vs: min=482.152; mean=710.767; max=935.633
2024-07-27 11:44:14 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:44:32 [INFO] | misfit f_try (i01s02) = 2.287E+03
2024-07-27 11:44:32 [INFO] | saving misfit and step length for step count == 2
2024-07-27 11:44:32 [INFO] | step count  =         0,         1,         2
2024-07-27 11:44:32 [INFO] | step length = 0.000E+00, 7.597E+08, 1.229E+09
2024-07-27 11:44:32 [INFO] | misfit val  = 3.007E+03, 2.547E+03, 2.287E+03
2024-07-27 11:44:32 [INFO] | increment step count -> 3
2024-07-27 11:44:32 [INFO] | first iteration, defaulting to bracketing line search
2024-07-27 11:44:32 [INFO] | try: misfit not bracketed, increasing step length using golden ratio
2024-07-27 11:44:32 [INFO] | step length `alpha` = 1.989E+09
2024-07-27 11:44:32 [INFO] | updating model with `dm` (dm_min=-5.26E+00, dm_max = 4.89E+01)
2024-07-27 11:44:32 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 11:44:33 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 11:44:33 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 11:44:33 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:44:33 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:44:33 [INFO] | vs: min=482.385; mean=714.614; max=936.119
2024-07-27 11:44:33 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:44:51 [INFO] | misfit f_try (i01s03) = 1.903E+03
2024-07-27 11:44:51 [INFO] | saving misfit and step length for step count == 3
2024-07-27 11:44:51 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 11:44:51 [INFO] | step length = 0.000E+00, 7.597E+08, 1.229E+09, 1.989E+09
2024-07-27 11:44:51 [INFO] | misfit val  = 3.007E+03, 2.547E+03, 2.287E+03, 1.903E+03
2024-07-27 11:44:51 [INFO] | increment step count -> 4
2024-07-27 11:44:51 [INFO] | first iteration, defaulting to bracketing line search
2024-07-27 11:44:51 [INFO] | try: misfit not bracketed, increasing step length using golden ratio
2024-07-27 11:44:51 [INFO] | step length `alpha` = 3.218E+09
2024-07-27 11:44:51 [INFO] | updating model with `dm` (dm_min=-8.51E+00, dm_max = 7.92E+01)
2024-07-27 11:44:51 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 11:44:52 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 11:44:52 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 11:44:52 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:44:52 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:44:52 [INFO] | vs: min=482.761; mean=720.837; max=936.905
2024-07-27 11:44:52 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:45:10 [INFO] | misfit f_try (i01s04) = 1.379E+03
2024-07-27 11:45:10 [INFO] | saving misfit and step length for step count == 4
2024-07-27 11:45:10 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 11:45:10 [INFO] | step length = 0.000E+00, 7.597E+08, 1.229E+09, 1.989E+09, 3.218E+09
2024-07-27 11:45:10 [INFO] | misfit val  = 3.007E+03, 2.547E+03, 2.287E+03, 1.903E+03, 1.379E+03
2024-07-27 11:45:10 [INFO] | increment step count -> 5
2024-07-27 11:45:10 [INFO] | first iteration, defaulting to bracketing line search
2024-07-27 11:45:10 [INFO] | pass: bracket acceptable and step length The residuals are dropping, what do you want
2024-07-27 11:45:10 [INFO] | final accepted step count == 4
2024-07-27 11:45:10 [INFO] | step length `alpha` = 3.218E+09
2024-07-27 11:45:10 [INFO] | updating model with `dm` (dm_min=-8.51E+00, dm_max = 7.92E+01)
2024-07-27 11:45:10 [INFO] | trial step successful. finalizing line search
2024-07-27 11:45:10 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 11:45:10 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 11:45:10 [INFO] | setting current model as previous model (new -> old)
2024-07-27 11:45:10 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 11:45:10 [INFO] | misfit of accepted trial model is f=1.379E+03
2024-07-27 11:45:10 [INFO] | resetting line search step count to 0
2024-07-27 11:45:10 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:45:10 [INFO] | Force update of model max and min bounds
2024-07-27 11:45:10 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_01
2024-07-27 11:45:10 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 11:45:12 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 11:45:12 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 11:45:14 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 11:45:18 [INFO] | completed 9 tasks from task list
2024-07-27 11:45:18 [INFO] | 
================================================================================
                             COMPLETE ITERATION 01                              
================================================================================
2024-07-27 11:45:18 [INFO] | setting current iteration to: 2
2024-07-27 11:45:18 [INFO] | 
================================================================================
                              RUNNING ITERATION 02                              
================================================================================
2024-07-27 11:45:18 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:45:18 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:45:18 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:45:19 [INFO] | checking model parameters:
2024-07-27 11:45:19 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:45:19 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:45:19 [INFO] | vs: min=482.761; mean=720.837; max=936.905
2024-07-27 11:45:19 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:45:38 [INFO] | misfit f_new (i02s00) = 1.379E+03
2024-07-27 11:45:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:45:38 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 11:45:57 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:45:57 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 11:46:28 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:46:28 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:46:30 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:46:30 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 11:46:31 [INFO] | exporting gradient to disk
2024-07-27 11:46:31 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 11:46:31 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:46:31 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 11:46:31 [INFO] | LBFGS iteration incremented -> 2
2024-07-27 11:46:31 [INFO] | applying inverse Hessian to gradient
2024-07-27 11:46:31 [INFO] | new search direction: 1.66째 from current
2024-07-27 11:46:31 [INFO] | new L-BFGS search direction found
2024-07-27 11:46:31 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:46:31 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 11:46:31 [WARN] | `alpha` has exceeded maximum value 0.23, capping
2024-07-27 11:46:31 [INFO] | step length `alpha` = 1.409E-01
2024-07-27 11:46:31 [INFO] | updating model with `dm` (dm_min=-1.56E+01, dm_max = 1.16E+02)
2024-07-27 11:46:32 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:46:32 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 11:46:32 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 11:46:32 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:46:32 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:46:32 [INFO] | vs: min=485.020; mean=738.879; max=942.660
2024-07-27 11:46:32 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:46:51 [INFO] | misfit f_try (i02s01) = 3.433E+02
2024-07-27 11:46:51 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:46:51 [INFO] | saving misfit and step length for step count == 1
2024-07-27 11:46:51 [INFO] | step count  =         0,         1
2024-07-27 11:46:51 [INFO] | step length = 0.000E+00, 1.409E-01
2024-07-27 11:46:51 [INFO] | misfit val  = 1.379E+03, 3.433E+02
2024-07-27 11:46:51 [INFO] | increment step count -> 2
2024-07-27 11:46:51 [INFO] | pass: misfit decreased, line search successful
2024-07-27 11:46:51 [INFO] | final accepted step count == 1
2024-07-27 11:46:51 [INFO] | step length `alpha` = 1.409E-01
2024-07-27 11:46:51 [INFO] | updating model with `dm` (dm_min=-1.56E+01, dm_max = 1.16E+02)
2024-07-27 11:46:51 [INFO] | trial step successful. finalizing line search
2024-07-27 11:46:51 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 11:46:51 [INFO] | removing previously accepted model files (?_old)
2024-07-27 11:46:51 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 11:46:51 [INFO] | setting current model as previous model (new -> old)
2024-07-27 11:46:51 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 11:46:51 [INFO] | misfit of accepted trial model is f=3.433E+02
2024-07-27 11:46:51 [INFO] | resetting line search step count to 0
2024-07-27 11:46:51 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:46:51 [INFO] | Force update of model max and min bounds
2024-07-27 11:46:51 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_02
2024-07-27 11:46:53 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 11:46:54 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 11:46:54 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 11:46:54 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 11:46:59 [INFO] | completed 9 tasks from task list
2024-07-27 11:46:59 [INFO] | 
================================================================================
                             COMPLETE ITERATION 02                              
================================================================================
2024-07-27 11:46:59 [INFO] | setting current iteration to: 3
2024-07-27 11:46:59 [INFO] | 
================================================================================
                              RUNNING ITERATION 03                              
================================================================================
2024-07-27 11:46:59 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:46:59 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:46:59 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:46:59 [INFO] | checking model parameters:
2024-07-27 11:46:59 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:46:59 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:46:59 [INFO] | vs: min=485.020; mean=738.879; max=942.660
2024-07-27 11:46:59 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:47:18 [INFO] | misfit f_new (i03s00) = 3.433E+02
2024-07-27 11:47:18 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:47:18 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 11:47:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:47:38 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 11:48:09 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:48:09 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:48:10 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:48:10 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 11:48:11 [INFO] | exporting gradient to disk
2024-07-27 11:48:11 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 11:48:11 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:48:11 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 11:48:11 [INFO] | LBFGS iteration incremented -> 3
2024-07-27 11:48:11 [INFO] | applying inverse Hessian to gradient
2024-07-27 11:48:11 [INFO] | new search direction: 18.72째 from current
2024-07-27 11:48:11 [INFO] | new L-BFGS search direction found
2024-07-27 11:48:11 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:48:11 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 11:48:11 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 11:48:11 [INFO] | updating model with `dm` (dm_min=-5.93E+01, dm_max = 4.35E+00)
2024-07-27 11:48:11 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:48:11 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 11:48:11 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 11:48:11 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:48:11 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:48:11 [INFO] | vs: min=484.473; mean=727.745; max=942.660
2024-07-27 11:48:11 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:48:30 [INFO] | misfit f_try (i03s01) = 4.377E+02
2024-07-27 11:48:30 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:48:30 [INFO] | saving misfit and step length for step count == 1
2024-07-27 11:48:30 [INFO] | step count  =         0,         1
2024-07-27 11:48:30 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 11:48:30 [INFO] | misfit val  = 3.433E+02, 4.377E+02
2024-07-27 11:48:30 [INFO] | increment step count -> 2
2024-07-27 11:48:30 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 11:48:30 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 11:48:30 [INFO] | updating model with `dm` (dm_min=-2.96E+01, dm_max = 2.18E+00)
2024-07-27 11:48:30 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 11:48:31 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 11:48:31 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 11:48:31 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:48:31 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:48:31 [INFO] | vs: min=484.747; mean=733.312; max=942.660
2024-07-27 11:48:31 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:48:49 [INFO] | misfit f_try (i03s02) = 3.623E+02
2024-07-27 11:48:49 [INFO] | saving misfit and step length for step count == 2
2024-07-27 11:48:49 [INFO] | step count  =         0,         1,         2
2024-07-27 11:48:49 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 11:48:49 [INFO] | misfit val  = 3.433E+02, 3.623E+02, 4.377E+02
2024-07-27 11:48:49 [INFO] | increment step count -> 3
2024-07-27 11:48:49 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 11:48:49 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 11:48:49 [INFO] | updating model with `dm` (dm_min=-1.48E+01, dm_max = 1.09E+00)
2024-07-27 11:48:49 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 11:48:50 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 11:48:50 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 11:48:50 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:48:50 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:48:50 [INFO] | vs: min=484.883; mean=736.096; max=942.660
2024-07-27 11:48:50 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:49:08 [INFO] | misfit f_try (i03s03) = 3.461E+02
2024-07-27 11:49:08 [INFO] | saving misfit and step length for step count == 3
2024-07-27 11:49:08 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 11:49:08 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 11:49:08 [INFO] | misfit val  = 3.433E+02, 3.461E+02, 3.623E+02, 4.377E+02
2024-07-27 11:49:08 [INFO] | increment step count -> 4
2024-07-27 11:49:08 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 11:49:08 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 11:49:08 [INFO] | updating model with `dm` (dm_min=-7.41E+00, dm_max = 5.44E-01)
2024-07-27 11:49:08 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 11:49:10 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 11:49:10 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 11:49:10 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:49:10 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:49:10 [INFO] | vs: min=484.952; mean=737.487; max=942.660
2024-07-27 11:49:10 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:49:28 [INFO] | misfit f_try (i03s04) = 3.432E+02
2024-07-27 11:49:28 [INFO] | saving misfit and step length for step count == 4
2024-07-27 11:49:28 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 11:49:28 [INFO] | step length = 0.000E+00, 1.250E-01, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 11:49:28 [INFO] | misfit val  = 3.433E+02, 3.432E+02, 3.461E+02, 3.623E+02, 4.377E+02
2024-07-27 11:49:28 [INFO] | increment step count -> 5
2024-07-27 11:49:28 [INFO] | pass: misfit decreased, line search successful
2024-07-27 11:49:28 [INFO] | final accepted step count == 4
2024-07-27 11:49:28 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 11:49:28 [INFO] | updating model with `dm` (dm_min=-7.41E+00, dm_max = 5.44E-01)
2024-07-27 11:49:28 [INFO] | trial step successful. finalizing line search
2024-07-27 11:49:28 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 11:49:28 [INFO] | removing previously accepted model files (?_old)
2024-07-27 11:49:28 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 11:49:29 [INFO] | setting current model as previous model (new -> old)
2024-07-27 11:49:29 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 11:49:29 [INFO] | misfit of accepted trial model is f=3.432E+02
2024-07-27 11:49:29 [INFO] | resetting line search step count to 0
2024-07-27 11:49:29 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:49:29 [INFO] | Force update of model max and min bounds
2024-07-27 11:49:29 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_03
2024-07-27 11:49:30 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 11:49:31 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 11:49:31 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 11:49:32 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 11:49:36 [INFO] | completed 9 tasks from task list
2024-07-27 11:49:36 [INFO] | 
================================================================================
                             COMPLETE ITERATION 03                              
================================================================================
2024-07-27 11:49:36 [INFO] | setting current iteration to: 4
2024-07-27 11:49:36 [INFO] | 
================================================================================
                              RUNNING ITERATION 04                              
================================================================================
2024-07-27 11:49:36 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:49:36 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:49:36 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:49:37 [INFO] | checking model parameters:
2024-07-27 11:49:37 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:49:37 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:49:37 [INFO] | vs: min=484.952; mean=737.487; max=942.660
2024-07-27 11:49:37 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:49:55 [INFO] | misfit f_new (i04s00) = 3.432E+02
2024-07-27 11:49:55 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:49:55 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 11:50:15 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:50:15 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 11:50:46 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:50:46 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:50:47 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:50:47 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 11:50:48 [INFO] | exporting gradient to disk
2024-07-27 11:50:48 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 11:50:48 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:50:48 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 11:50:48 [INFO] | LBFGS iteration incremented -> 4
2024-07-27 11:50:48 [INFO] | applying inverse Hessian to gradient
2024-07-27 11:50:48 [INFO] | new search direction: 9.40째 from current
2024-07-27 11:50:48 [INFO] | new L-BFGS search direction found
2024-07-27 11:50:48 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:50:48 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 11:50:48 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 11:50:48 [INFO] | updating model with `dm` (dm_min=-1.02E+02, dm_max = 1.50E+01)
2024-07-27 11:50:48 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:50:48 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 11:50:48 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 11:50:48 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:50:48 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:50:48 [INFO] | vs: min=485.385; mean=717.798; max=942.660
2024-07-27 11:50:48 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:51:07 [INFO] | misfit f_try (i04s01) = 2.436E+02
2024-07-27 11:51:07 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:51:07 [INFO] | saving misfit and step length for step count == 1
2024-07-27 11:51:07 [INFO] | step count  =         0,         1
2024-07-27 11:51:07 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 11:51:07 [INFO] | misfit val  = 3.432E+02, 2.436E+02
2024-07-27 11:51:07 [INFO] | increment step count -> 2
2024-07-27 11:51:07 [INFO] | pass: misfit decreased, line search successful
2024-07-27 11:51:07 [INFO] | final accepted step count == 1
2024-07-27 11:51:07 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 11:51:07 [INFO] | updating model with `dm` (dm_min=-1.02E+02, dm_max = 1.50E+01)
2024-07-27 11:51:07 [INFO] | trial step successful. finalizing line search
2024-07-27 11:51:07 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 11:51:07 [INFO] | removing previously accepted model files (?_old)
2024-07-27 11:51:07 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 11:51:07 [INFO] | setting current model as previous model (new -> old)
2024-07-27 11:51:07 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 11:51:07 [INFO] | misfit of accepted trial model is f=2.436E+02
2024-07-27 11:51:07 [INFO] | resetting line search step count to 0
2024-07-27 11:51:07 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:51:07 [INFO] | Force update of model max and min bounds
2024-07-27 11:51:07 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_04
2024-07-27 11:51:09 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 11:51:10 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 11:51:10 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 11:51:11 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 11:51:16 [INFO] | completed 9 tasks from task list
2024-07-27 11:51:16 [INFO] | 
================================================================================
                             COMPLETE ITERATION 04                              
================================================================================
2024-07-27 11:51:16 [INFO] | setting current iteration to: 5
2024-07-27 11:51:16 [INFO] | 
================================================================================
                              RUNNING ITERATION 05                              
================================================================================
2024-07-27 11:51:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:51:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:51:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:51:17 [INFO] | checking model parameters:
2024-07-27 11:51:17 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:51:17 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:51:17 [INFO] | vs: min=485.385; mean=717.798; max=942.660
2024-07-27 11:51:17 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:51:36 [INFO] | misfit f_new (i05s00) = 2.436E+02
2024-07-27 11:51:36 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:51:36 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 11:51:56 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:51:56 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 11:52:27 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:52:27 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:52:29 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:52:29 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 11:52:31 [INFO] | exporting gradient to disk
2024-07-27 11:52:31 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 11:52:31 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:52:31 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 11:52:31 [INFO] | LBFGS iteration incremented -> 5
2024-07-27 11:52:31 [INFO] | applying inverse Hessian to gradient
2024-07-27 11:52:31 [INFO] | new search direction: 11.70째 from current
2024-07-27 11:52:31 [INFO] | new L-BFGS search direction found
2024-07-27 11:52:31 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:52:31 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 11:52:31 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 11:52:31 [INFO] | updating model with `dm` (dm_min=-6.34E+00, dm_max = 2.83E+01)
2024-07-27 11:52:33 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:52:33 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 11:52:33 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 11:52:33 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:52:33 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:52:33 [INFO] | vs: min=486.391; mean=720.026; max=942.660
2024-07-27 11:52:33 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:52:51 [INFO] | misfit f_try (i05s01) = 1.619E+02
2024-07-27 11:52:51 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:52:51 [INFO] | saving misfit and step length for step count == 1
2024-07-27 11:52:51 [INFO] | step count  =         0,         1
2024-07-27 11:52:51 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 11:52:51 [INFO] | misfit val  = 2.436E+02, 1.619E+02
2024-07-27 11:52:51 [INFO] | increment step count -> 2
2024-07-27 11:52:51 [INFO] | pass: misfit decreased, line search successful
2024-07-27 11:52:51 [INFO] | final accepted step count == 1
2024-07-27 11:52:51 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 11:52:52 [INFO] | updating model with `dm` (dm_min=-6.34E+00, dm_max = 2.83E+01)
2024-07-27 11:52:52 [INFO] | trial step successful. finalizing line search
2024-07-27 11:52:52 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 11:52:52 [INFO] | removing previously accepted model files (?_old)
2024-07-27 11:52:52 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 11:52:52 [INFO] | setting current model as previous model (new -> old)
2024-07-27 11:52:52 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 11:52:52 [INFO] | misfit of accepted trial model is f=1.619E+02
2024-07-27 11:52:52 [INFO] | resetting line search step count to 0
2024-07-27 11:52:52 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:52:52 [INFO] | Force update of model max and min bounds
2024-07-27 11:52:52 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_05
2024-07-27 11:52:54 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 11:52:54 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 11:52:54 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 11:52:55 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 11:53:01 [INFO] | completed 9 tasks from task list
2024-07-27 11:53:01 [INFO] | 
================================================================================
                             COMPLETE ITERATION 05                              
================================================================================
2024-07-27 11:53:01 [INFO] | setting current iteration to: 6
2024-07-27 11:53:01 [INFO] | 
================================================================================
                              RUNNING ITERATION 06                              
================================================================================
2024-07-27 11:53:01 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:53:01 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:53:01 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:53:01 [INFO] | checking model parameters:
2024-07-27 11:53:01 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:53:01 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:53:01 [INFO] | vs: min=486.391; mean=720.026; max=942.660
2024-07-27 11:53:01 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:53:20 [INFO] | misfit f_new (i06s00) = 1.619E+02
2024-07-27 11:53:20 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:53:20 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 11:53:40 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:53:40 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 11:54:11 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:54:11 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:54:11 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:54:11 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 11:54:13 [INFO] | exporting gradient to disk
2024-07-27 11:54:13 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 11:54:13 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:54:13 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 11:54:13 [INFO] | LBFGS iteration incremented -> 6
2024-07-27 11:54:13 [INFO] | applying inverse Hessian to gradient
2024-07-27 11:54:13 [INFO] | new search direction: 39.40째 from current
2024-07-27 11:54:13 [INFO] | new L-BFGS search direction found
2024-07-27 11:54:13 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:54:13 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 11:54:13 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 11:54:13 [INFO] | updating model with `dm` (dm_min=-1.15E+01, dm_max = 6.54E+00)
2024-07-27 11:54:14 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:54:14 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 11:54:14 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 11:54:14 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:54:14 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:54:14 [INFO] | vs: min=486.783; mean=717.748; max=942.660
2024-07-27 11:54:14 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:54:32 [INFO] | misfit f_try (i06s01) = 1.395E+02
2024-07-27 11:54:32 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:54:32 [INFO] | saving misfit and step length for step count == 1
2024-07-27 11:54:32 [INFO] | step count  =         0,         1
2024-07-27 11:54:32 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 11:54:32 [INFO] | misfit val  = 1.619E+02, 1.395E+02
2024-07-27 11:54:32 [INFO] | increment step count -> 2
2024-07-27 11:54:32 [INFO] | pass: misfit decreased, line search successful
2024-07-27 11:54:32 [INFO] | final accepted step count == 1
2024-07-27 11:54:32 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 11:54:32 [INFO] | updating model with `dm` (dm_min=-1.15E+01, dm_max = 6.54E+00)
2024-07-27 11:54:32 [INFO] | trial step successful. finalizing line search
2024-07-27 11:54:32 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 11:54:32 [INFO] | removing previously accepted model files (?_old)
2024-07-27 11:54:32 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 11:54:33 [INFO] | setting current model as previous model (new -> old)
2024-07-27 11:54:33 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 11:54:33 [INFO] | misfit of accepted trial model is f=1.395E+02
2024-07-27 11:54:33 [INFO] | resetting line search step count to 0
2024-07-27 11:54:33 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:54:33 [INFO] | Force update of model max and min bounds
2024-07-27 11:54:33 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_06
2024-07-27 11:54:33 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 11:54:35 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 11:54:35 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 11:54:36 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 11:54:38 [INFO] | completed 9 tasks from task list
2024-07-27 11:54:38 [INFO] | 
================================================================================
                             COMPLETE ITERATION 06                              
================================================================================
2024-07-27 11:54:38 [INFO] | setting current iteration to: 7
2024-07-27 11:54:38 [INFO] | 
================================================================================
                              RUNNING ITERATION 07                              
================================================================================
2024-07-27 11:54:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:54:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:54:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:54:39 [INFO] | checking model parameters:
2024-07-27 11:54:39 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:54:39 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:54:39 [INFO] | vs: min=486.783; mean=717.748; max=942.660
2024-07-27 11:54:39 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:54:58 [INFO] | misfit f_new (i07s00) = 1.395E+02
2024-07-27 11:54:58 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:54:58 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 11:55:18 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:55:18 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 11:55:47 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:55:47 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:55:48 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:55:48 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 11:55:50 [INFO] | exporting gradient to disk
2024-07-27 11:55:50 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 11:55:50 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:55:50 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 11:55:50 [INFO] | LBFGS iteration incremented -> 7
2024-07-27 11:55:50 [INFO] | applying inverse Hessian to gradient
2024-07-27 11:55:50 [INFO] | new search direction: 20.21째 from current
2024-07-27 11:55:50 [INFO] | new L-BFGS search direction found
2024-07-27 11:55:50 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:55:50 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 11:55:50 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 11:55:50 [INFO] | updating model with `dm` (dm_min=-5.07E+01, dm_max = 1.19E+01)
2024-07-27 11:55:51 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:55:51 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 11:55:51 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 11:55:51 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:55:51 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:55:51 [INFO] | vs: min=487.663; mean=711.250; max=942.660
2024-07-27 11:55:51 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:56:10 [INFO] | misfit f_try (i07s01) = 1.160E+02
2024-07-27 11:56:10 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:56:10 [INFO] | saving misfit and step length for step count == 1
2024-07-27 11:56:10 [INFO] | step count  =         0,         1
2024-07-27 11:56:10 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 11:56:10 [INFO] | misfit val  = 1.395E+02, 1.160E+02
2024-07-27 11:56:10 [INFO] | increment step count -> 2
2024-07-27 11:56:10 [INFO] | pass: misfit decreased, line search successful
2024-07-27 11:56:10 [INFO] | final accepted step count == 1
2024-07-27 11:56:10 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 11:56:10 [INFO] | updating model with `dm` (dm_min=-5.07E+01, dm_max = 1.19E+01)
2024-07-27 11:56:10 [INFO] | trial step successful. finalizing line search
2024-07-27 11:56:10 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 11:56:10 [INFO] | removing previously accepted model files (?_old)
2024-07-27 11:56:10 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 11:56:10 [INFO] | setting current model as previous model (new -> old)
2024-07-27 11:56:10 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 11:56:10 [INFO] | misfit of accepted trial model is f=1.160E+02
2024-07-27 11:56:10 [INFO] | resetting line search step count to 0
2024-07-27 11:56:10 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:56:10 [INFO] | Force update of model max and min bounds
2024-07-27 11:56:10 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_07
2024-07-27 11:56:11 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 11:56:13 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 11:56:13 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 11:56:14 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 11:56:20 [INFO] | completed 9 tasks from task list
2024-07-27 11:56:20 [INFO] | 
================================================================================
                             COMPLETE ITERATION 07                              
================================================================================
2024-07-27 11:56:20 [INFO] | setting current iteration to: 8
2024-07-27 11:56:20 [INFO] | 
================================================================================
                              RUNNING ITERATION 08                              
================================================================================
2024-07-27 11:56:20 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:56:20 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:56:20 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:56:21 [INFO] | checking model parameters:
2024-07-27 11:56:21 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:56:21 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:56:21 [INFO] | vs: min=487.663; mean=711.250; max=942.660
2024-07-27 11:56:21 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:56:40 [INFO] | misfit f_new (i08s00) = 1.160E+02
2024-07-27 11:56:40 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:56:40 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 11:57:01 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:57:01 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 11:57:32 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:57:32 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:57:32 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:57:32 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 11:57:33 [INFO] | exporting gradient to disk
2024-07-27 11:57:33 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 11:57:33 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:57:33 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 11:57:33 [INFO] | LBFGS iteration incremented -> 8
2024-07-27 11:57:33 [INFO] | applying inverse Hessian to gradient
2024-07-27 11:57:33 [INFO] | new search direction: 28.92째 from current
2024-07-27 11:57:33 [INFO] | new L-BFGS search direction found
2024-07-27 11:57:33 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:57:33 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 11:57:33 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 11:57:33 [INFO] | updating model with `dm` (dm_min=-3.98E+00, dm_max = 2.27E+01)
2024-07-27 11:57:33 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:57:33 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 11:57:33 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 11:57:33 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:57:33 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:57:33 [INFO] | vs: min=487.468; mean=715.277; max=942.660
2024-07-27 11:57:33 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:57:52 [INFO] | misfit f_try (i08s01) = 1.151E+02
2024-07-27 11:57:52 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:57:52 [INFO] | saving misfit and step length for step count == 1
2024-07-27 11:57:52 [INFO] | step count  =         0,         1
2024-07-27 11:57:52 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 11:57:52 [INFO] | misfit val  = 1.160E+02, 1.151E+02
2024-07-27 11:57:52 [INFO] | increment step count -> 2
2024-07-27 11:57:52 [INFO] | pass: misfit decreased, line search successful
2024-07-27 11:57:52 [INFO] | final accepted step count == 1
2024-07-27 11:57:52 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 11:57:52 [INFO] | updating model with `dm` (dm_min=-3.98E+00, dm_max = 2.27E+01)
2024-07-27 11:57:52 [INFO] | trial step successful. finalizing line search
2024-07-27 11:57:52 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 11:57:52 [INFO] | removing previously accepted model files (?_old)
2024-07-27 11:57:52 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 11:57:52 [INFO] | setting current model as previous model (new -> old)
2024-07-27 11:57:52 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 11:57:52 [INFO] | misfit of accepted trial model is f=1.151E+02
2024-07-27 11:57:52 [INFO] | resetting line search step count to 0
2024-07-27 11:57:52 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:57:52 [INFO] | Force update of model max and min bounds
2024-07-27 11:57:52 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_08
2024-07-27 11:57:54 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 11:57:55 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 11:57:55 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 11:57:57 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 11:58:00 [INFO] | completed 9 tasks from task list
2024-07-27 11:58:00 [INFO] | 
================================================================================
                             COMPLETE ITERATION 08                              
================================================================================
2024-07-27 11:58:00 [INFO] | setting current iteration to: 9
2024-07-27 11:58:00 [INFO] | 
================================================================================
                              RUNNING ITERATION 09                              
================================================================================
2024-07-27 11:58:00 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:58:00 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:58:00 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:58:02 [INFO] | checking model parameters:
2024-07-27 11:58:02 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:58:02 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:58:02 [INFO] | vs: min=487.468; mean=715.277; max=942.660
2024-07-27 11:58:02 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:58:21 [INFO] | misfit f_new (i09s00) = 1.151E+02
2024-07-27 11:58:21 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:58:21 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 11:58:41 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:58:41 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 11:59:11 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:59:11 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:59:11 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:59:11 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 11:59:12 [INFO] | exporting gradient to disk
2024-07-27 11:59:12 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 11:59:12 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:59:12 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 11:59:12 [INFO] | LBFGS iteration incremented -> 9
2024-07-27 11:59:12 [INFO] | applying inverse Hessian to gradient
2024-07-27 11:59:12 [INFO] | new search direction: 13.49째 from current
2024-07-27 11:59:12 [INFO] | new L-BFGS search direction found
2024-07-27 11:59:12 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:59:12 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 11:59:12 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 11:59:12 [INFO] | updating model with `dm` (dm_min=-6.67E+00, dm_max = 9.24E+00)
2024-07-27 11:59:12 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:59:12 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 11:59:12 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 11:59:12 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:59:12 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:59:12 [INFO] | vs: min=487.739; mean=716.508; max=942.660
2024-07-27 11:59:12 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:59:30 [INFO] | misfit f_try (i09s01) = 1.128E+02
2024-07-27 11:59:30 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:59:30 [INFO] | saving misfit and step length for step count == 1
2024-07-27 11:59:30 [INFO] | step count  =         0,         1
2024-07-27 11:59:30 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 11:59:30 [INFO] | misfit val  = 1.151E+02, 1.128E+02
2024-07-27 11:59:30 [INFO] | increment step count -> 2
2024-07-27 11:59:30 [INFO] | pass: misfit decreased, line search successful
2024-07-27 11:59:30 [INFO] | final accepted step count == 1
2024-07-27 11:59:30 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 11:59:30 [INFO] | updating model with `dm` (dm_min=-6.67E+00, dm_max = 9.24E+00)
2024-07-27 11:59:30 [INFO] | trial step successful. finalizing line search
2024-07-27 11:59:30 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 11:59:30 [INFO] | removing previously accepted model files (?_old)
2024-07-27 11:59:30 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 11:59:30 [INFO] | setting current model as previous model (new -> old)
2024-07-27 11:59:30 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 11:59:30 [INFO] | misfit of accepted trial model is f=1.128E+02
2024-07-27 11:59:30 [INFO] | resetting line search step count to 0
2024-07-27 11:59:30 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:59:30 [INFO] | Force update of model max and min bounds
2024-07-27 11:59:31 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_09
2024-07-27 11:59:32 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 11:59:32 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 11:59:32 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 11:59:34 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 11:59:38 [INFO] | completed 9 tasks from task list
2024-07-27 11:59:38 [INFO] | 
================================================================================
                             COMPLETE ITERATION 09                              
================================================================================
2024-07-27 11:59:38 [INFO] | setting current iteration to: 10
2024-07-27 11:59:38 [INFO] | 
================================================================================
                              RUNNING ITERATION 10                              
================================================================================
2024-07-27 11:59:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:59:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:59:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:59:38 [INFO] | checking model parameters:
2024-07-27 11:59:38 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 11:59:38 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 11:59:38 [INFO] | vs: min=487.739; mean=716.508; max=942.660
2024-07-27 11:59:38 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 11:59:57 [INFO] | misfit f_new (i10s00) = 1.128E+02
2024-07-27 11:59:57 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 11:59:57 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:00:17 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:00:17 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:00:47 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:00:47 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:00:48 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:00:48 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:00:50 [INFO] | exporting gradient to disk
2024-07-27 12:00:50 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:00:50 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:00:50 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:00:50 [INFO] | LBFGS iteration incremented -> 10
2024-07-27 12:00:50 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:00:50 [INFO] | new search direction: 5.77째 from current
2024-07-27 12:00:50 [INFO] | new L-BFGS search direction found
2024-07-27 12:00:50 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:00:50 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:00:50 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:00:50 [INFO] | updating model with `dm` (dm_min=-2.17E+01, dm_max = 2.84E+01)
2024-07-27 12:00:50 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:00:50 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:00:50 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:00:50 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:00:50 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:00:50 [INFO] | vs: min=489.140; mean=717.814; max=942.660
2024-07-27 12:00:50 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:01:09 [INFO] | misfit f_try (i10s01) = 8.073E+01
2024-07-27 12:01:09 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:01:09 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:01:09 [INFO] | step count  =         0,         1
2024-07-27 12:01:09 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:01:09 [INFO] | misfit val  = 1.128E+02, 8.073E+01
2024-07-27 12:01:09 [INFO] | increment step count -> 2
2024-07-27 12:01:09 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:01:09 [INFO] | final accepted step count == 1
2024-07-27 12:01:09 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:01:09 [INFO] | updating model with `dm` (dm_min=-2.17E+01, dm_max = 2.84E+01)
2024-07-27 12:01:09 [INFO] | trial step successful. finalizing line search
2024-07-27 12:01:09 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:01:09 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:01:09 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:01:09 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:01:09 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:01:09 [INFO] | misfit of accepted trial model is f=8.073E+01
2024-07-27 12:01:09 [INFO] | resetting line search step count to 0
2024-07-27 12:01:09 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:01:09 [INFO] | Force update of model max and min bounds
2024-07-27 12:01:09 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_10
2024-07-27 12:01:10 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:01:10 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:01:10 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:01:10 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:01:16 [INFO] | completed 9 tasks from task list
2024-07-27 12:01:16 [INFO] | 
================================================================================
                             COMPLETE ITERATION 10                              
================================================================================
2024-07-27 12:01:16 [INFO] | setting current iteration to: 11
2024-07-27 12:01:16 [INFO] | 
================================================================================
                              RUNNING ITERATION 11                              
================================================================================
2024-07-27 12:01:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:01:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:01:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:01:17 [INFO] | checking model parameters:
2024-07-27 12:01:17 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:01:17 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:01:17 [INFO] | vs: min=489.140; mean=717.814; max=942.660
2024-07-27 12:01:17 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:01:36 [INFO] | misfit f_new (i11s00) = 8.073E+01
2024-07-27 12:01:36 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:01:36 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:01:56 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:01:56 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:02:26 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:02:26 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:02:27 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:02:27 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:02:28 [INFO] | exporting gradient to disk
2024-07-27 12:02:28 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:02:28 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:02:28 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:02:28 [INFO] | LBFGS iteration incremented -> 11
2024-07-27 12:02:28 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:02:29 [INFO] | new search direction: 58.20째 from current
2024-07-27 12:02:29 [INFO] | new L-BFGS search direction found
2024-07-27 12:02:29 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:02:29 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:02:29 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:02:29 [INFO] | updating model with `dm` (dm_min=-6.78E+01, dm_max = 7.02E+01)
2024-07-27 12:02:31 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:02:31 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:02:31 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:02:31 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:02:31 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:02:31 [INFO] | vs: min=493.021; mean=717.635; max=942.660
2024-07-27 12:02:31 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:02:49 [INFO] | misfit f_try (i11s01) = 3.779E+01
2024-07-27 12:02:49 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:02:49 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:02:49 [INFO] | step count  =         0,         1
2024-07-27 12:02:49 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:02:49 [INFO] | misfit val  = 8.073E+01, 3.779E+01
2024-07-27 12:02:49 [INFO] | increment step count -> 2
2024-07-27 12:02:49 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:02:49 [INFO] | final accepted step count == 1
2024-07-27 12:02:49 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:02:49 [INFO] | updating model with `dm` (dm_min=-6.78E+01, dm_max = 7.02E+01)
2024-07-27 12:02:49 [INFO] | trial step successful. finalizing line search
2024-07-27 12:02:49 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:02:49 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:02:49 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:02:49 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:02:49 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:02:49 [INFO] | misfit of accepted trial model is f=3.779E+01
2024-07-27 12:02:49 [INFO] | resetting line search step count to 0
2024-07-27 12:02:49 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:02:49 [INFO] | Force update of model max and min bounds
2024-07-27 12:02:49 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_11
2024-07-27 12:02:51 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:02:52 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:02:52 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:02:54 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:02:57 [INFO] | completed 9 tasks from task list
2024-07-27 12:02:57 [INFO] | 
================================================================================
                             COMPLETE ITERATION 11                              
================================================================================
2024-07-27 12:02:57 [INFO] | setting current iteration to: 12
2024-07-27 12:02:57 [INFO] | 
================================================================================
                              RUNNING ITERATION 12                              
================================================================================
2024-07-27 12:02:57 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:02:57 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:02:57 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:02:58 [INFO] | checking model parameters:
2024-07-27 12:02:58 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:02:58 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:02:58 [INFO] | vs: min=493.021; mean=717.635; max=942.660
2024-07-27 12:02:58 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:03:18 [INFO] | misfit f_new (i12s00) = 3.779E+01
2024-07-27 12:03:18 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:03:18 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:03:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:03:38 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:04:07 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:04:07 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:04:08 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:04:08 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:04:09 [INFO] | exporting gradient to disk
2024-07-27 12:04:09 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:04:09 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:04:09 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:04:09 [INFO] | LBFGS iteration incremented -> 12
2024-07-27 12:04:09 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:04:09 [INFO] | new search direction: 70.15째 from current
2024-07-27 12:04:09 [INFO] | new L-BFGS search direction found
2024-07-27 12:04:09 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:04:09 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:04:09 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:04:10 [INFO] | updating model with `dm` (dm_min=-3.05E+01, dm_max = 2.93E+01)
2024-07-27 12:04:10 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:04:10 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:04:10 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:04:10 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:04:10 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:04:10 [INFO] | vs: min=494.863; mean=717.092; max=942.660
2024-07-27 12:04:10 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:04:28 [INFO] | misfit f_try (i12s01) = 3.008E+01
2024-07-27 12:04:28 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:04:28 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:04:28 [INFO] | step count  =         0,         1
2024-07-27 12:04:28 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:04:28 [INFO] | misfit val  = 3.779E+01, 3.008E+01
2024-07-27 12:04:28 [INFO] | increment step count -> 2
2024-07-27 12:04:28 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:04:28 [INFO] | final accepted step count == 1
2024-07-27 12:04:28 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:04:28 [INFO] | updating model with `dm` (dm_min=-3.05E+01, dm_max = 2.93E+01)
2024-07-27 12:04:28 [INFO] | trial step successful. finalizing line search
2024-07-27 12:04:28 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:04:28 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:04:28 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:04:28 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:04:28 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:04:28 [INFO] | misfit of accepted trial model is f=3.008E+01
2024-07-27 12:04:28 [INFO] | resetting line search step count to 0
2024-07-27 12:04:28 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:04:28 [INFO] | Force update of model max and min bounds
2024-07-27 12:04:28 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_12
2024-07-27 12:04:30 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:04:31 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:04:31 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:04:32 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:04:36 [INFO] | completed 9 tasks from task list
2024-07-27 12:04:36 [INFO] | 
================================================================================
                             COMPLETE ITERATION 12                              
================================================================================
2024-07-27 12:04:36 [INFO] | setting current iteration to: 13
2024-07-27 12:04:36 [INFO] | 
================================================================================
                              RUNNING ITERATION 13                              
================================================================================
2024-07-27 12:04:36 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:04:36 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:04:36 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:04:38 [INFO] | checking model parameters:
2024-07-27 12:04:38 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:04:38 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:04:38 [INFO] | vs: min=494.863; mean=717.092; max=942.660
2024-07-27 12:04:38 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:04:56 [INFO] | misfit f_new (i13s00) = 3.008E+01
2024-07-27 12:04:56 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:04:56 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:05:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:05:16 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:05:45 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:05:45 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:05:45 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:05:45 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:05:46 [INFO] | exporting gradient to disk
2024-07-27 12:05:46 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:05:46 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:05:46 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:05:46 [INFO] | LBFGS iteration incremented -> 13
2024-07-27 12:05:46 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:05:46 [INFO] | new search direction: 22.54째 from current
2024-07-27 12:05:46 [INFO] | new L-BFGS search direction found
2024-07-27 12:05:46 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:05:46 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:05:46 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:05:46 [INFO] | updating model with `dm` (dm_min=-2.09E+01, dm_max = 1.90E+01)
2024-07-27 12:05:47 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:05:47 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:05:47 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:05:47 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:05:47 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:05:47 [INFO] | vs: min=494.852; mean=714.608; max=942.660
2024-07-27 12:05:47 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:06:06 [INFO] | misfit f_try (i13s01) = 3.474E+01
2024-07-27 12:06:06 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:06:06 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:06:06 [INFO] | step count  =         0,         1
2024-07-27 12:06:06 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:06:06 [INFO] | misfit val  = 3.008E+01, 3.474E+01
2024-07-27 12:06:06 [INFO] | increment step count -> 2
2024-07-27 12:06:06 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:06:06 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 12:06:06 [INFO] | updating model with `dm` (dm_min=-1.04E+01, dm_max = 9.50E+00)
2024-07-27 12:06:06 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:06:06 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:06:06 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:06:06 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:06:06 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:06:06 [INFO] | vs: min=494.858; mean=715.850; max=942.660
2024-07-27 12:06:06 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:06:25 [INFO] | misfit f_try (i13s02) = 3.146E+01
2024-07-27 12:06:25 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:06:25 [INFO] | step count  =         0,         1,         2
2024-07-27 12:06:25 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 12:06:25 [INFO] | misfit val  = 3.008E+01, 3.146E+01, 3.474E+01
2024-07-27 12:06:25 [INFO] | increment step count -> 3
2024-07-27 12:06:25 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:06:25 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 12:06:25 [INFO] | updating model with `dm` (dm_min=-5.22E+00, dm_max = 4.75E+00)
2024-07-27 12:06:25 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:06:26 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:06:26 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:06:26 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:06:26 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:06:26 [INFO] | vs: min=494.861; mean=716.471; max=942.660
2024-07-27 12:06:26 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:06:45 [INFO] | misfit f_try (i13s03) = 3.052E+01
2024-07-27 12:06:45 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:06:45 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:06:45 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:06:45 [INFO] | misfit val  = 3.008E+01, 3.052E+01, 3.146E+01, 3.474E+01
2024-07-27 12:06:45 [INFO] | increment step count -> 4
2024-07-27 12:06:45 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:06:45 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 12:06:45 [INFO] | updating model with `dm` (dm_min=-2.61E+00, dm_max = 2.38E+00)
2024-07-27 12:06:45 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:06:46 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 12:06:46 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:06:46 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:06:46 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:06:46 [INFO] | vs: min=494.862; mean=716.782; max=942.660
2024-07-27 12:06:46 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:07:05 [INFO] | misfit f_try (i13s04) = 3.027E+01
2024-07-27 12:07:05 [INFO] | saving misfit and step length for step count == 4
2024-07-27 12:07:05 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 12:07:05 [INFO] | step length = 0.000E+00, 1.250E-01, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:07:05 [INFO] | misfit val  = 3.008E+01, 3.027E+01, 3.052E+01, 3.146E+01, 3.474E+01
2024-07-27 12:07:05 [INFO] | increment step count -> 5
2024-07-27 12:07:05 [INFO] | fail: backtracking line search has failed because the maximum allowable step counts (5) has been exceeded
2024-07-27 12:07:05 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:07:05 [INFO] | Force update of model max and min bounds
2024-07-27 12:07:05 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_13
2024-07-27 12:07:05 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:07:05 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:07:05 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:07:06 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:07:10 [INFO] | completed 9 tasks from task list
2024-07-27 12:07:10 [INFO] | 
================================================================================
                             COMPLETE ITERATION 13                              
================================================================================
2024-07-27 12:07:10 [INFO] | setting current iteration to: 14
2024-07-27 12:07:10 [INFO] | #######################current offset: 45
2024-07-27 12:07:10 [INFO] | 
================================================================================
                              RUNNING ITERATION 14                              
================================================================================
2024-07-27 12:07:10 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:07:10 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:07:10 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:07:11 [INFO] | checking model parameters:
2024-07-27 12:07:11 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:07:11 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:07:11 [INFO] | vs: min=494.863; mean=717.092; max=942.660
2024-07-27 12:07:11 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:07:29 [INFO] | misfit f_new (i14s05) = 3.028E+01
2024-07-27 12:07:29 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:07:29 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:07:49 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:07:49 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:08:20 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:08:20 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:08:20 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:08:20 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:08:21 [INFO] | exporting gradient to disk
2024-07-27 12:08:21 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:08:21 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:08:21 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:08:21 [INFO] | LBFGS iteration incremented -> 14
2024-07-27 12:08:21 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:08:21 [INFO] | new search direction: 29.42째 from current
2024-07-27 12:08:21 [INFO] | new L-BFGS search direction found
2024-07-27 12:08:21 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:08:21 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:08:21 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:08:21 [INFO] | updating model with `dm` (dm_min=-2.52E+01, dm_max = 2.48E+01)
2024-07-27 12:08:22 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:08:22 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:08:22 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:08:22 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:08:22 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:08:22 [INFO] | vs: min=494.606; mean=713.683; max=942.660
2024-07-27 12:08:22 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:08:41 [INFO] | misfit f_try (i14s01) = 3.605E+01
2024-07-27 12:08:41 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:08:41 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:08:41 [INFO] | step count  =         0,         1
2024-07-27 12:08:41 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:08:41 [INFO] | misfit val  = 3.028E+01, 3.605E+01
2024-07-27 12:08:41 [INFO] | increment step count -> 2
2024-07-27 12:08:41 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:08:41 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 12:08:41 [INFO] | updating model with `dm` (dm_min=-1.26E+01, dm_max = 1.24E+01)
2024-07-27 12:08:41 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:08:42 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:08:42 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:08:42 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:08:42 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:08:42 [INFO] | vs: min=494.734; mean=715.388; max=942.660
2024-07-27 12:08:42 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:09:00 [INFO] | misfit f_try (i14s02) = 3.163E+01
2024-07-27 12:09:00 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:09:00 [INFO] | step count  =         0,         1,         2
2024-07-27 12:09:00 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 12:09:00 [INFO] | misfit val  = 3.028E+01, 3.163E+01, 3.605E+01
2024-07-27 12:09:00 [INFO] | increment step count -> 3
2024-07-27 12:09:00 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:09:00 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 12:09:00 [INFO] | updating model with `dm` (dm_min=-6.29E+00, dm_max = 6.20E+00)
2024-07-27 12:09:00 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:09:02 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:09:02 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:09:02 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:09:02 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:09:02 [INFO] | vs: min=494.799; mean=716.240; max=942.660
2024-07-27 12:09:02 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:09:20 [INFO] | misfit f_try (i14s03) = 3.058E+01
2024-07-27 12:09:20 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:09:20 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:09:20 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:09:20 [INFO] | misfit val  = 3.028E+01, 3.058E+01, 3.163E+01, 3.605E+01
2024-07-27 12:09:20 [INFO] | increment step count -> 4
2024-07-27 12:09:20 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:09:20 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 12:09:20 [INFO] | updating model with `dm` (dm_min=-3.15E+00, dm_max = 3.10E+00)
2024-07-27 12:09:20 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:09:21 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 12:09:21 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:09:21 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:09:21 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:09:21 [INFO] | vs: min=494.831; mean=716.666; max=942.660
2024-07-27 12:09:21 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:09:39 [INFO] | misfit f_try (i14s04) = 3.035E+01
2024-07-27 12:09:39 [INFO] | saving misfit and step length for step count == 4
2024-07-27 12:09:39 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 12:09:39 [INFO] | step length = 0.000E+00, 1.250E-01, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:09:39 [INFO] | misfit val  = 3.028E+01, 3.035E+01, 3.058E+01, 3.163E+01, 3.605E+01
2024-07-27 12:09:39 [INFO] | increment step count -> 5
2024-07-27 12:09:39 [INFO] | fail: backtracking line search has failed because the maximum allowable step counts (5) has been exceeded
2024-07-27 12:09:39 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:09:39 [INFO] | Force update of model max and min bounds
2024-07-27 12:09:39 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_14
2024-07-27 12:09:41 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:09:42 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:09:42 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:09:44 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:09:46 [INFO] | completed 9 tasks from task list
2024-07-27 12:09:46 [INFO] | 
================================================================================
                             COMPLETE ITERATION 14                              
================================================================================
2024-07-27 12:09:46 [INFO] | setting current iteration to: 15
2024-07-27 12:09:46 [INFO] | #######################current offset: 42
2024-07-27 12:09:46 [INFO] | 
================================================================================
                              RUNNING ITERATION 15                              
================================================================================
2024-07-27 12:09:46 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:09:46 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:09:46 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:09:47 [INFO] | checking model parameters:
2024-07-27 12:09:47 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:09:47 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:09:47 [INFO] | vs: min=494.863; mean=717.092; max=942.660
2024-07-27 12:09:47 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:10:05 [INFO] | misfit f_new (i15s05) = 3.060E+01
2024-07-27 12:10:05 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:10:05 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:10:25 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:10:25 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:10:56 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:10:56 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:10:57 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:10:57 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:10:58 [INFO] | exporting gradient to disk
2024-07-27 12:10:58 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:10:58 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:10:58 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:10:58 [INFO] | LBFGS iteration incremented -> 15
2024-07-27 12:10:58 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:10:58 [INFO] | new search direction: 12.01째 from current
2024-07-27 12:10:58 [INFO] | new L-BFGS search direction found
2024-07-27 12:10:58 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:10:58 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:10:58 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:10:58 [INFO] | updating model with `dm` (dm_min=-1.17E+01, dm_max = 1.36E+01)
2024-07-27 12:10:59 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:10:59 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:10:59 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:10:59 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:10:59 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:10:59 [INFO] | vs: min=494.899; mean=716.514; max=942.660
2024-07-27 12:10:59 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:11:17 [INFO] | misfit f_try (i15s01) = 3.155E+01
2024-07-27 12:11:17 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:11:17 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:11:17 [INFO] | step count  =         0,         1
2024-07-27 12:11:17 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:11:17 [INFO] | misfit val  = 3.060E+01, 3.155E+01
2024-07-27 12:11:17 [INFO] | increment step count -> 2
2024-07-27 12:11:17 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:11:17 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 12:11:17 [INFO] | updating model with `dm` (dm_min=-5.86E+00, dm_max = 6.81E+00)
2024-07-27 12:11:17 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:11:17 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:11:17 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:11:17 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:11:17 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:11:17 [INFO] | vs: min=494.881; mean=716.803; max=942.660
2024-07-27 12:11:17 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:11:35 [INFO] | misfit f_try (i15s02) = 3.062E+01
2024-07-27 12:11:35 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:11:35 [INFO] | step count  =         0,         1,         2
2024-07-27 12:11:35 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 12:11:35 [INFO] | misfit val  = 3.060E+01, 3.062E+01, 3.155E+01
2024-07-27 12:11:35 [INFO] | increment step count -> 3
2024-07-27 12:11:35 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:11:35 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 12:11:35 [INFO] | updating model with `dm` (dm_min=-2.93E+00, dm_max = 3.40E+00)
2024-07-27 12:11:35 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:11:37 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:11:37 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:11:37 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:11:37 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:11:37 [INFO] | vs: min=494.872; mean=716.948; max=942.660
2024-07-27 12:11:37 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:11:55 [INFO] | misfit f_try (i15s03) = 3.052E+01
2024-07-27 12:11:55 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:11:55 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:11:55 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:11:55 [INFO] | misfit val  = 3.060E+01, 3.052E+01, 3.062E+01, 3.155E+01
2024-07-27 12:11:55 [INFO] | increment step count -> 4
2024-07-27 12:11:55 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:11:55 [INFO] | final accepted step count == 3
2024-07-27 12:11:55 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 12:11:55 [INFO] | updating model with `dm` (dm_min=-2.93E+00, dm_max = 3.40E+00)
2024-07-27 12:11:55 [INFO] | trial step successful. finalizing line search
2024-07-27 12:11:55 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:11:55 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:11:55 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:11:55 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:11:55 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:11:55 [INFO] | misfit of accepted trial model is f=3.052E+01
2024-07-27 12:11:55 [INFO] | resetting line search step count to 0
2024-07-27 12:11:55 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:11:55 [INFO] | Force update of model max and min bounds
2024-07-27 12:11:55 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_15
2024-07-27 12:11:56 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:11:58 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:11:58 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:11:59 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:12:03 [INFO] | completed 9 tasks from task list
2024-07-27 12:12:03 [INFO] | 
================================================================================
                             COMPLETE ITERATION 15                              
================================================================================
2024-07-27 12:12:03 [INFO] | setting current iteration to: 16
2024-07-27 12:12:03 [INFO] | 
================================================================================
                              RUNNING ITERATION 16                              
================================================================================
2024-07-27 12:12:03 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:12:03 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:12:03 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:12:03 [INFO] | checking model parameters:
2024-07-27 12:12:03 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:12:03 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:12:03 [INFO] | vs: min=494.872; mean=716.948; max=942.660
2024-07-27 12:12:03 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:12:22 [INFO] | misfit f_new (i16s00) = 3.052E+01
2024-07-27 12:12:22 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:12:22 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:12:42 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:12:42 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:13:11 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:13:11 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:13:12 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:13:12 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:13:14 [INFO] | exporting gradient to disk
2024-07-27 12:13:14 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:13:14 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:13:14 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:13:14 [INFO] | LBFGS iteration incremented -> 16
2024-07-27 12:13:14 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:13:14 [INFO] | new search direction: 32.67째 from current
2024-07-27 12:13:14 [INFO] | new L-BFGS search direction found
2024-07-27 12:13:14 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:13:14 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:13:14 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:13:14 [INFO] | updating model with `dm` (dm_min=-6.81E+01, dm_max = 5.99E+01)
2024-07-27 12:13:14 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:13:14 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:13:14 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:13:14 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:13:14 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:13:14 [INFO] | vs: min=492.836; mean=713.397; max=942.660
2024-07-27 12:13:14 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:13:33 [INFO] | misfit f_try (i16s01) = 4.484E+01
2024-07-27 12:13:33 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:13:33 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:13:33 [INFO] | step count  =         0,         1
2024-07-27 12:13:33 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:13:33 [INFO] | misfit val  = 3.052E+01, 4.484E+01
2024-07-27 12:13:33 [INFO] | increment step count -> 2
2024-07-27 12:13:33 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:13:33 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 12:13:33 [INFO] | updating model with `dm` (dm_min=-3.41E+01, dm_max = 2.99E+01)
2024-07-27 12:13:33 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:13:34 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:13:34 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:13:34 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:13:34 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:13:34 [INFO] | vs: min=493.854; mean=715.172; max=942.660
2024-07-27 12:13:34 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:13:53 [INFO] | misfit f_try (i16s02) = 3.318E+01
2024-07-27 12:13:53 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:13:53 [INFO] | step count  =         0,         1,         2
2024-07-27 12:13:53 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 12:13:53 [INFO] | misfit val  = 3.052E+01, 3.318E+01, 4.484E+01
2024-07-27 12:13:53 [INFO] | increment step count -> 3
2024-07-27 12:13:53 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:13:53 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 12:13:53 [INFO] | updating model with `dm` (dm_min=-1.70E+01, dm_max = 1.50E+01)
2024-07-27 12:13:53 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:13:54 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:13:54 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:13:54 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:13:54 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:13:54 [INFO] | vs: min=494.363; mean=716.060; max=942.660
2024-07-27 12:13:54 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:14:12 [INFO] | misfit f_try (i16s03) = 3.073E+01
2024-07-27 12:14:12 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:14:12 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:14:12 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:14:12 [INFO] | misfit val  = 3.052E+01, 3.073E+01, 3.318E+01, 4.484E+01
2024-07-27 12:14:12 [INFO] | increment step count -> 4
2024-07-27 12:14:12 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:14:12 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 12:14:12 [INFO] | updating model with `dm` (dm_min=-8.52E+00, dm_max = 7.48E+00)
2024-07-27 12:14:12 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:14:12 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 12:14:12 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:14:12 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:14:12 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:14:12 [INFO] | vs: min=494.618; mean=716.504; max=942.660
2024-07-27 12:14:12 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:14:30 [INFO] | misfit f_try (i16s04) = 3.031E+01
2024-07-27 12:14:30 [INFO] | saving misfit and step length for step count == 4
2024-07-27 12:14:30 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 12:14:30 [INFO] | step length = 0.000E+00, 1.250E-01, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:14:30 [INFO] | misfit val  = 3.052E+01, 3.031E+01, 3.073E+01, 3.318E+01, 4.484E+01
2024-07-27 12:14:30 [INFO] | increment step count -> 5
2024-07-27 12:14:30 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:14:30 [INFO] | final accepted step count == 4
2024-07-27 12:14:30 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 12:14:30 [INFO] | updating model with `dm` (dm_min=-8.52E+00, dm_max = 7.48E+00)
2024-07-27 12:14:30 [INFO] | trial step successful. finalizing line search
2024-07-27 12:14:30 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:14:30 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:14:30 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:14:30 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:14:30 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:14:30 [INFO] | misfit of accepted trial model is f=3.031E+01
2024-07-27 12:14:30 [INFO] | resetting line search step count to 0
2024-07-27 12:14:30 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:14:30 [INFO] | Force update of model max and min bounds
2024-07-27 12:14:30 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_16
2024-07-27 12:14:32 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:14:33 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:14:33 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:14:34 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:14:39 [INFO] | completed 9 tasks from task list
2024-07-27 12:14:39 [INFO] | 
================================================================================
                             COMPLETE ITERATION 16                              
================================================================================
2024-07-27 12:14:39 [INFO] | setting current iteration to: 17
2024-07-27 12:14:39 [INFO] | 
================================================================================
                              RUNNING ITERATION 17                              
================================================================================
2024-07-27 12:14:39 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:14:39 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:14:39 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:14:40 [INFO] | checking model parameters:
2024-07-27 12:14:40 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:14:40 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:14:40 [INFO] | vs: min=494.618; mean=716.504; max=942.660
2024-07-27 12:14:40 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:14:58 [INFO] | misfit f_new (i17s00) = 3.031E+01
2024-07-27 12:14:58 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:14:58 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:15:18 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:15:18 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:15:48 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:15:48 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:15:50 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:15:50 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:15:51 [INFO] | exporting gradient to disk
2024-07-27 12:15:51 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:15:51 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:15:51 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:15:51 [INFO] | LBFGS iteration incremented -> 17
2024-07-27 12:15:51 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:15:52 [INFO] | new search direction: 43.48째 from current
2024-07-27 12:15:52 [INFO] | new L-BFGS search direction found
2024-07-27 12:15:52 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:15:52 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:15:52 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:15:52 [INFO] | updating model with `dm` (dm_min=-8.51E+01, dm_max = 6.65E+01)
2024-07-27 12:15:54 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:15:54 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:15:54 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:15:54 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:15:54 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:15:54 [INFO] | vs: min=491.759; mean=711.003; max=942.660
2024-07-27 12:15:54 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:16:12 [INFO] | misfit f_try (i17s01) = 5.888E+01
2024-07-27 12:16:12 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:16:12 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:16:12 [INFO] | step count  =         0,         1
2024-07-27 12:16:12 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:16:12 [INFO] | misfit val  = 3.031E+01, 5.888E+01
2024-07-27 12:16:12 [INFO] | increment step count -> 2
2024-07-27 12:16:12 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:16:12 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 12:16:12 [INFO] | updating model with `dm` (dm_min=-4.26E+01, dm_max = 3.32E+01)
2024-07-27 12:16:12 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:16:13 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:16:13 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:16:13 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:16:13 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:16:13 [INFO] | vs: min=493.188; mean=713.755; max=942.660
2024-07-27 12:16:13 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:16:31 [INFO] | misfit f_try (i17s02) = 3.675E+01
2024-07-27 12:16:31 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:16:31 [INFO] | step count  =         0,         1,         2
2024-07-27 12:16:31 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 12:16:31 [INFO] | misfit val  = 3.031E+01, 3.675E+01, 5.888E+01
2024-07-27 12:16:31 [INFO] | increment step count -> 3
2024-07-27 12:16:31 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:16:31 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 12:16:31 [INFO] | updating model with `dm` (dm_min=-2.13E+01, dm_max = 1.66E+01)
2024-07-27 12:16:31 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:16:31 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:16:31 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:16:31 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:16:32 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:16:32 [INFO] | vs: min=493.903; mean=715.130; max=942.660
2024-07-27 12:16:32 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:16:49 [INFO] | misfit f_try (i17s03) = 3.177E+01
2024-07-27 12:16:49 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:16:49 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:16:49 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:16:49 [INFO] | misfit val  = 3.031E+01, 3.177E+01, 3.675E+01, 5.888E+01
2024-07-27 12:16:49 [INFO] | increment step count -> 4
2024-07-27 12:16:49 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:16:49 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 12:16:49 [INFO] | updating model with `dm` (dm_min=-1.06E+01, dm_max = 8.31E+00)
2024-07-27 12:16:49 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:16:50 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 12:16:50 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:16:50 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:16:50 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:16:50 [INFO] | vs: min=494.260; mean=715.817; max=942.660
2024-07-27 12:16:50 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:17:08 [INFO] | misfit f_try (i17s04) = 3.062E+01
2024-07-27 12:17:08 [INFO] | saving misfit and step length for step count == 4
2024-07-27 12:17:08 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 12:17:08 [INFO] | step length = 0.000E+00, 1.250E-01, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:17:08 [INFO] | misfit val  = 3.031E+01, 3.062E+01, 3.177E+01, 3.675E+01, 5.888E+01
2024-07-27 12:17:08 [INFO] | increment step count -> 5
2024-07-27 12:17:08 [INFO] | fail: backtracking line search has failed because the maximum allowable step counts (5) has been exceeded
2024-07-27 12:17:08 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:17:08 [INFO] | Force update of model max and min bounds
2024-07-27 12:17:08 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_17
2024-07-27 12:17:09 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:17:10 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:17:10 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:17:12 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:17:16 [INFO] | completed 9 tasks from task list
2024-07-27 12:17:16 [INFO] | 
================================================================================
                             COMPLETE ITERATION 17                              
================================================================================
2024-07-27 12:17:16 [INFO] | setting current iteration to: 18
2024-07-27 12:17:16 [INFO] | #######################current offset: 39
2024-07-27 12:17:16 [INFO] | 
================================================================================
                              RUNNING ITERATION 18                              
================================================================================
2024-07-27 12:17:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:17:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:17:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:17:17 [INFO] | checking model parameters:
2024-07-27 12:17:17 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:17:17 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:17:17 [INFO] | vs: min=494.618; mean=716.504; max=942.660
2024-07-27 12:17:17 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:17:35 [INFO] | misfit f_new (i18s05) = 3.038E+01
2024-07-27 12:17:35 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:17:35 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:17:55 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:17:55 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:18:26 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:18:26 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:18:27 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:18:27 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:18:29 [INFO] | exporting gradient to disk
2024-07-27 12:18:29 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:18:29 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:18:29 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:18:29 [INFO] | LBFGS iteration incremented -> 18
2024-07-27 12:18:29 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:18:29 [INFO] | new search direction: 41.05째 from current
2024-07-27 12:18:29 [INFO] | new L-BFGS search direction found
2024-07-27 12:18:29 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:18:29 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:18:29 [WARN] | `alpha` has exceeded maximum value 0.90, capping
2024-07-27 12:18:29 [INFO] | step length `alpha` = 5.543E-01
2024-07-27 12:18:29 [INFO] | updating model with `dm` (dm_min=-1.16E+02, dm_max = 9.42E+01)
2024-07-27 12:18:31 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:18:31 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:18:31 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:18:31 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:18:31 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:18:31 [INFO] | vs: min=490.839; mean=710.572; max=942.660
2024-07-27 12:18:31 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:18:49 [INFO] | misfit f_try (i18s01) = 8.350E+01
2024-07-27 12:18:49 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:18:49 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:18:49 [INFO] | step count  =         0,         1
2024-07-27 12:18:49 [INFO] | step length = 0.000E+00, 5.543E-01
2024-07-27 12:18:49 [INFO] | misfit val  = 3.038E+01, 8.350E+01
2024-07-27 12:18:49 [INFO] | increment step count -> 2
2024-07-27 12:18:49 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:18:49 [INFO] | step length `alpha` = 2.772E-01
2024-07-27 12:18:49 [INFO] | updating model with `dm` (dm_min=-5.78E+01, dm_max = 4.71E+01)
2024-07-27 12:18:49 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:18:49 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:18:49 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:18:49 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:18:49 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:18:49 [INFO] | vs: min=492.728; mean=713.548; max=942.660
2024-07-27 12:18:49 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:19:07 [INFO] | misfit f_try (i18s02) = 4.287E+01
2024-07-27 12:19:07 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:19:07 [INFO] | step count  =         0,         1,         2
2024-07-27 12:19:07 [INFO] | step length = 0.000E+00, 2.772E-01, 5.543E-01
2024-07-27 12:19:07 [INFO] | misfit val  = 3.038E+01, 4.287E+01, 8.350E+01
2024-07-27 12:19:07 [INFO] | increment step count -> 3
2024-07-27 12:19:07 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:19:07 [INFO] | step length `alpha` = 1.386E-01
2024-07-27 12:19:07 [INFO] | updating model with `dm` (dm_min=-2.89E+01, dm_max = 2.35E+01)
2024-07-27 12:19:07 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:19:08 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:19:08 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:19:08 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:19:08 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:19:08 [INFO] | vs: min=493.673; mean=715.026; max=942.660
2024-07-27 12:19:08 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:19:26 [INFO] | misfit f_try (i18s03) = 3.337E+01
2024-07-27 12:19:26 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:19:26 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:19:26 [INFO] | step length = 0.000E+00, 1.386E-01, 2.772E-01, 5.543E-01
2024-07-27 12:19:26 [INFO] | misfit val  = 3.038E+01, 3.337E+01, 4.287E+01, 8.350E+01
2024-07-27 12:19:26 [INFO] | increment step count -> 4
2024-07-27 12:19:26 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:19:26 [INFO] | step length `alpha` = 6.929E-02
2024-07-27 12:19:26 [INFO] | updating model with `dm` (dm_min=-1.44E+01, dm_max = 1.18E+01)
2024-07-27 12:19:26 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:19:28 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 12:19:28 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:19:28 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:19:28 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:19:28 [INFO] | vs: min=494.145; mean=715.765; max=942.660
2024-07-27 12:19:28 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:19:45 [INFO] | misfit f_try (i18s04) = 3.106E+01
2024-07-27 12:19:45 [INFO] | saving misfit and step length for step count == 4
2024-07-27 12:19:45 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 12:19:45 [INFO] | step length = 0.000E+00, 6.929E-02, 1.386E-01, 2.772E-01, 5.543E-01
2024-07-27 12:19:45 [INFO] | misfit val  = 3.038E+01, 3.106E+01, 3.337E+01, 4.287E+01, 8.350E+01
2024-07-27 12:19:45 [INFO] | increment step count -> 5
2024-07-27 12:19:45 [INFO] | fail: backtracking line search has failed because the maximum allowable step counts (5) has been exceeded
2024-07-27 12:19:45 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:19:45 [INFO] | Force update of model max and min bounds
2024-07-27 12:19:45 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_18
2024-07-27 12:19:47 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:19:48 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:19:48 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:19:50 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:19:54 [INFO] | completed 9 tasks from task list
2024-07-27 12:19:54 [INFO] | 
================================================================================
                             COMPLETE ITERATION 18                              
================================================================================
2024-07-27 12:19:54 [INFO] | setting current iteration to: 19
2024-07-27 12:19:54 [INFO] | #######################current offset: 36
2024-07-27 12:19:54 [INFO] | 
================================================================================
                              RUNNING ITERATION 19                              
================================================================================
2024-07-27 12:19:54 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:19:54 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:19:54 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:19:55 [INFO] | checking model parameters:
2024-07-27 12:19:55 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:19:55 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:19:55 [INFO] | vs: min=494.618; mean=716.504; max=942.660
2024-07-27 12:19:55 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:20:13 [INFO] | misfit f_new (i19s05) = 3.074E+01
2024-07-27 12:20:13 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:20:13 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:20:33 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:20:33 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:21:03 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:21:03 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:21:04 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:21:04 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:21:05 [INFO] | exporting gradient to disk
2024-07-27 12:21:05 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:21:05 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:21:05 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:21:05 [INFO] | LBFGS iteration incremented -> 19
2024-07-27 12:21:05 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:21:05 [INFO] | new search direction: 37.61째 from current
2024-07-27 12:21:05 [INFO] | new L-BFGS search direction found
2024-07-27 12:21:05 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:21:05 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:21:05 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:21:05 [INFO] | updating model with `dm` (dm_min=-1.21E+02, dm_max = 9.53E+01)
2024-07-27 12:21:07 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:21:07 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:21:07 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:21:07 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:21:07 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:21:07 [INFO] | vs: min=491.145; mean=709.257; max=942.660
2024-07-27 12:21:07 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:21:25 [INFO] | misfit f_try (i19s01) = 8.536E+01
2024-07-27 12:21:25 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:21:25 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:21:25 [INFO] | step count  =         0,         1
2024-07-27 12:21:25 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:21:25 [INFO] | misfit val  = 3.074E+01, 8.536E+01
2024-07-27 12:21:25 [INFO] | increment step count -> 2
2024-07-27 12:21:25 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:21:25 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 12:21:25 [INFO] | updating model with `dm` (dm_min=-6.03E+01, dm_max = 4.76E+01)
2024-07-27 12:21:25 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:21:26 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:21:26 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:21:26 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:21:26 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:21:26 [INFO] | vs: min=492.881; mean=712.890; max=942.660
2024-07-27 12:21:26 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:21:44 [INFO] | misfit f_try (i19s02) = 4.306E+01
2024-07-27 12:21:44 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:21:44 [INFO] | step count  =         0,         1,         2
2024-07-27 12:21:44 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 12:21:44 [INFO] | misfit val  = 3.074E+01, 4.306E+01, 8.536E+01
2024-07-27 12:21:44 [INFO] | increment step count -> 3
2024-07-27 12:21:44 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:21:44 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 12:21:44 [INFO] | updating model with `dm` (dm_min=-3.01E+01, dm_max = 2.38E+01)
2024-07-27 12:21:44 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:21:45 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:21:45 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:21:45 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:21:45 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:21:45 [INFO] | vs: min=493.749; mean=714.697; max=942.660
2024-07-27 12:21:45 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:22:03 [INFO] | misfit f_try (i19s03) = 3.332E+01
2024-07-27 12:22:03 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:22:03 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:22:03 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:22:03 [INFO] | misfit val  = 3.074E+01, 3.332E+01, 4.306E+01, 8.536E+01
2024-07-27 12:22:03 [INFO] | increment step count -> 4
2024-07-27 12:22:03 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:22:03 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 12:22:03 [INFO] | updating model with `dm` (dm_min=-1.51E+01, dm_max = 1.19E+01)
2024-07-27 12:22:03 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:22:05 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 12:22:05 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:22:05 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:22:05 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:22:05 [INFO] | vs: min=494.184; mean=715.600; max=942.660
2024-07-27 12:22:05 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:22:22 [INFO] | misfit f_try (i19s04) = 3.114E+01
2024-07-27 12:22:22 [INFO] | saving misfit and step length for step count == 4
2024-07-27 12:22:22 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 12:22:22 [INFO] | step length = 0.000E+00, 1.250E-01, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:22:22 [INFO] | misfit val  = 3.074E+01, 3.114E+01, 3.332E+01, 4.306E+01, 8.536E+01
2024-07-27 12:22:22 [INFO] | increment step count -> 5
2024-07-27 12:22:22 [INFO] | fail: backtracking line search has failed because the maximum allowable step counts (5) has been exceeded
2024-07-27 12:22:22 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:22:22 [INFO] | Force update of model max and min bounds
2024-07-27 12:22:22 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_19
2024-07-27 12:22:23 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:22:25 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:22:25 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:22:26 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:22:31 [INFO] | completed 9 tasks from task list
2024-07-27 12:22:31 [INFO] | 
================================================================================
                             COMPLETE ITERATION 19                              
================================================================================
2024-07-27 12:22:31 [INFO] | setting current iteration to: 20
2024-07-27 12:22:31 [INFO] | #######################current offset: 33
2024-07-27 12:22:31 [INFO] | 
================================================================================
                              RUNNING ITERATION 20                              
================================================================================
2024-07-27 12:22:31 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:22:31 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:22:31 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:22:31 [INFO] | checking model parameters:
2024-07-27 12:22:31 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:22:31 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:22:31 [INFO] | vs: min=494.618; mean=716.504; max=942.660
2024-07-27 12:22:31 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:22:49 [INFO] | misfit f_new (i20s05) = 3.155E+01
2024-07-27 12:22:49 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:22:49 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:23:09 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:23:09 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:23:40 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:23:40 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:23:41 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:23:41 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:23:42 [INFO] | exporting gradient to disk
2024-07-27 12:23:42 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:23:42 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:23:42 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:23:42 [INFO] | LBFGS iteration incremented -> 20
2024-07-27 12:23:42 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:23:42 [INFO] | new search direction: 36.64째 from current
2024-07-27 12:23:42 [INFO] | new L-BFGS search direction found
2024-07-27 12:23:42 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:23:42 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:23:42 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:23:42 [INFO] | updating model with `dm` (dm_min=-5.63E+01, dm_max = 4.12E+01)
2024-07-27 12:23:44 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:23:44 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:23:44 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:23:44 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:23:44 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:23:44 [INFO] | vs: min=493.130; mean=713.158; max=942.660
2024-07-27 12:23:44 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:24:01 [INFO] | misfit f_try (i20s01) = 4.001E+01
2024-07-27 12:24:01 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:24:01 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:24:01 [INFO] | step count  =         0,         1
2024-07-27 12:24:01 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:24:01 [INFO] | misfit val  = 3.155E+01, 4.001E+01
2024-07-27 12:24:01 [INFO] | increment step count -> 2
2024-07-27 12:24:01 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:24:01 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 12:24:01 [INFO] | updating model with `dm` (dm_min=-2.82E+01, dm_max = 2.06E+01)
2024-07-27 12:24:01 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:24:02 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:24:02 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:24:02 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:24:02 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:24:02 [INFO] | vs: min=493.874; mean=714.831; max=942.660
2024-07-27 12:24:02 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:24:20 [INFO] | misfit f_try (i20s02) = 3.284E+01
2024-07-27 12:24:20 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:24:20 [INFO] | step count  =         0,         1,         2
2024-07-27 12:24:20 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 12:24:20 [INFO] | misfit val  = 3.155E+01, 3.284E+01, 4.001E+01
2024-07-27 12:24:20 [INFO] | increment step count -> 3
2024-07-27 12:24:20 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:24:20 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 12:24:20 [INFO] | updating model with `dm` (dm_min=-1.41E+01, dm_max = 1.03E+01)
2024-07-27 12:24:20 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:24:21 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:24:21 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:24:21 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:24:21 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:24:21 [INFO] | vs: min=494.246; mean=715.667; max=942.660
2024-07-27 12:24:21 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:24:39 [INFO] | misfit f_try (i20s03) = 3.148E+01
2024-07-27 12:24:39 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:24:39 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:24:39 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:24:39 [INFO] | misfit val  = 3.155E+01, 3.148E+01, 3.284E+01, 4.001E+01
2024-07-27 12:24:39 [INFO] | increment step count -> 4
2024-07-27 12:24:39 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:24:39 [INFO] | final accepted step count == 3
2024-07-27 12:24:39 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 12:24:39 [INFO] | updating model with `dm` (dm_min=-1.41E+01, dm_max = 1.03E+01)
2024-07-27 12:24:39 [INFO] | trial step successful. finalizing line search
2024-07-27 12:24:39 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:24:39 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:24:39 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:24:39 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:24:39 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:24:39 [INFO] | misfit of accepted trial model is f=3.148E+01
2024-07-27 12:24:39 [INFO] | resetting line search step count to 0
2024-07-27 12:24:39 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:24:39 [INFO] | Force update of model max and min bounds
2024-07-27 12:24:39 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_20
2024-07-27 12:24:40 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:24:42 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:24:42 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:24:43 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:24:46 [INFO] | completed 9 tasks from task list
2024-07-27 12:24:46 [INFO] | 
================================================================================
                             COMPLETE ITERATION 20                              
================================================================================
2024-07-27 12:24:46 [INFO] | setting current iteration to: 21
2024-07-27 12:24:46 [INFO] | 
================================================================================
                              RUNNING ITERATION 21                              
================================================================================
2024-07-27 12:24:46 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:24:46 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:24:46 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:24:48 [INFO] | checking model parameters:
2024-07-27 12:24:48 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:24:48 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:24:48 [INFO] | vs: min=494.246; mean=715.667; max=942.660
2024-07-27 12:24:48 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:25:07 [INFO] | misfit f_new (i21s00) = 3.148E+01
2024-07-27 12:25:07 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:25:07 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:25:27 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:25:27 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:25:58 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:25:58 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:26:00 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:26:00 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:26:00 [INFO] | exporting gradient to disk
2024-07-27 12:26:00 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:26:00 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:26:00 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:26:00 [INFO] | LBFGS iteration incremented -> 21
2024-07-27 12:26:00 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:26:00 [INFO] | new search direction: 40.76째 from current
2024-07-27 12:26:00 [INFO] | new L-BFGS search direction found
2024-07-27 12:26:00 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:26:00 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:26:00 [WARN] | `alpha` has exceeded maximum value 0.93, capping
2024-07-27 12:26:00 [INFO] | step length `alpha` = 5.778E-01
2024-07-27 12:26:00 [INFO] | updating model with `dm` (dm_min=-1.16E+02, dm_max = 7.20E+01)
2024-07-27 12:26:01 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:26:01 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:26:01 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:26:01 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:26:01 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:26:01 [INFO] | vs: min=490.945; mean=705.296; max=942.660
2024-07-27 12:26:01 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:26:19 [INFO] | misfit f_try (i21s01) = 8.570E+01
2024-07-27 12:26:19 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:26:19 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:26:19 [INFO] | step count  =         0,         1
2024-07-27 12:26:19 [INFO] | step length = 0.000E+00, 5.778E-01
2024-07-27 12:26:19 [INFO] | misfit val  = 3.148E+01, 8.570E+01
2024-07-27 12:26:19 [INFO] | increment step count -> 2
2024-07-27 12:26:19 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:26:19 [INFO] | step length `alpha` = 2.889E-01
2024-07-27 12:26:19 [INFO] | updating model with `dm` (dm_min=-5.78E+01, dm_max = 3.60E+01)
2024-07-27 12:26:19 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:26:20 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:26:20 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:26:20 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:26:20 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:26:20 [INFO] | vs: min=492.595; mean=710.482; max=942.660
2024-07-27 12:26:20 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:26:37 [INFO] | misfit f_try (i21s02) = 4.440E+01
2024-07-27 12:26:37 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:26:37 [INFO] | step count  =         0,         1,         2
2024-07-27 12:26:37 [INFO] | step length = 0.000E+00, 2.889E-01, 5.778E-01
2024-07-27 12:26:37 [INFO] | misfit val  = 3.148E+01, 4.440E+01, 8.570E+01
2024-07-27 12:26:37 [INFO] | increment step count -> 3
2024-07-27 12:26:37 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:26:37 [INFO] | step length `alpha` = 1.444E-01
2024-07-27 12:26:37 [INFO] | updating model with `dm` (dm_min=-2.89E+01, dm_max = 1.80E+01)
2024-07-27 12:26:37 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:26:39 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:26:39 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:26:39 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:26:39 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:26:39 [INFO] | vs: min=493.421; mean=713.075; max=942.660
2024-07-27 12:26:39 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:26:57 [INFO] | misfit f_try (i21s03) = 3.463E+01
2024-07-27 12:26:57 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:26:57 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:26:57 [INFO] | step length = 0.000E+00, 1.444E-01, 2.889E-01, 5.778E-01
2024-07-27 12:26:57 [INFO] | misfit val  = 3.148E+01, 3.463E+01, 4.440E+01, 8.570E+01
2024-07-27 12:26:57 [INFO] | increment step count -> 4
2024-07-27 12:26:57 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:26:57 [INFO] | step length `alpha` = 7.222E-02
2024-07-27 12:26:57 [INFO] | updating model with `dm` (dm_min=-1.44E+01, dm_max = 9.00E+00)
2024-07-27 12:26:57 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:26:58 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 12:26:58 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:26:58 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:26:58 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:26:58 [INFO] | vs: min=493.833; mean=714.371; max=942.660
2024-07-27 12:26:58 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:27:15 [INFO] | misfit f_try (i21s04) = 3.225E+01
2024-07-27 12:27:15 [INFO] | saving misfit and step length for step count == 4
2024-07-27 12:27:15 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 12:27:15 [INFO] | step length = 0.000E+00, 7.222E-02, 1.444E-01, 2.889E-01, 5.778E-01
2024-07-27 12:27:15 [INFO] | misfit val  = 3.148E+01, 3.225E+01, 3.463E+01, 4.440E+01, 8.570E+01
2024-07-27 12:27:15 [INFO] | increment step count -> 5
2024-07-27 12:27:15 [INFO] | fail: backtracking line search has failed because the maximum allowable step counts (5) has been exceeded
2024-07-27 12:27:15 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:27:15 [INFO] | Force update of model max and min bounds
2024-07-27 12:27:15 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_21
2024-07-27 12:27:17 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:27:17 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:27:17 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:27:17 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:27:20 [INFO] | completed 9 tasks from task list
2024-07-27 12:27:20 [INFO] | 
================================================================================
                             COMPLETE ITERATION 21                              
================================================================================
2024-07-27 12:27:20 [INFO] | setting current iteration to: 22
2024-07-27 12:27:20 [INFO] | #######################current offset: 30
2024-07-27 12:27:20 [INFO] | 
================================================================================
                              RUNNING ITERATION 22                              
================================================================================
2024-07-27 12:27:20 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:27:20 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:27:20 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:27:21 [INFO] | checking model parameters:
2024-07-27 12:27:21 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:27:21 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:27:21 [INFO] | vs: min=494.246; mean=715.667; max=942.660
2024-07-27 12:27:21 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:27:38 [INFO] | misfit f_new (i22s05) = 3.262E+01
2024-07-27 12:27:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:27:38 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:27:58 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:27:58 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:28:28 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:28:28 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:28:29 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:28:29 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:28:30 [INFO] | exporting gradient to disk
2024-07-27 12:28:30 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:28:30 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:28:30 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:28:30 [INFO] | LBFGS iteration incremented -> 22
2024-07-27 12:28:30 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:28:30 [INFO] | new search direction: 38.98째 from current
2024-07-27 12:28:30 [INFO] | new L-BFGS search direction found
2024-07-27 12:28:30 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:28:30 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:28:30 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:28:30 [INFO] | updating model with `dm` (dm_min=-1.29E+02, dm_max = 7.96E+01)
2024-07-27 12:28:30 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:28:30 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:28:30 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:28:30 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:28:30 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:28:30 [INFO] | vs: min=490.295; mean=705.502; max=942.660
2024-07-27 12:28:30 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:28:48 [INFO] | misfit f_try (i22s01) = 8.082E+01
2024-07-27 12:28:48 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:28:48 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:28:48 [INFO] | step count  =         0,         1
2024-07-27 12:28:48 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:28:48 [INFO] | misfit val  = 3.262E+01, 8.082E+01
2024-07-27 12:28:48 [INFO] | increment step count -> 2
2024-07-27 12:28:48 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:28:48 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 12:28:48 [INFO] | updating model with `dm` (dm_min=-6.46E+01, dm_max = 3.98E+01)
2024-07-27 12:28:48 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:28:49 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:28:49 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:28:49 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:28:49 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:28:49 [INFO] | vs: min=492.270; mean=710.587; max=942.660
2024-07-27 12:28:49 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:29:07 [INFO] | misfit f_try (i22s02) = 4.408E+01
2024-07-27 12:29:07 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:29:07 [INFO] | step count  =         0,         1,         2
2024-07-27 12:29:07 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 12:29:07 [INFO] | misfit val  = 3.262E+01, 4.408E+01, 8.082E+01
2024-07-27 12:29:07 [INFO] | increment step count -> 3
2024-07-27 12:29:07 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:29:07 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 12:29:07 [INFO] | updating model with `dm` (dm_min=-3.23E+01, dm_max = 1.99E+01)
2024-07-27 12:29:07 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:29:08 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:29:08 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:29:08 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:29:08 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:29:08 [INFO] | vs: min=493.258; mean=713.128; max=942.660
2024-07-27 12:29:08 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:29:26 [INFO] | misfit f_try (i22s03) = 3.529E+01
2024-07-27 12:29:26 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:29:26 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:29:26 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:29:26 [INFO] | misfit val  = 3.262E+01, 3.529E+01, 4.408E+01, 8.082E+01
2024-07-27 12:29:26 [INFO] | increment step count -> 4
2024-07-27 12:29:26 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:29:26 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 12:29:26 [INFO] | updating model with `dm` (dm_min=-1.61E+01, dm_max = 9.95E+00)
2024-07-27 12:29:26 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:29:28 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 12:29:28 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:29:28 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:29:28 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:29:28 [INFO] | vs: min=493.752; mean=714.399; max=942.660
2024-07-27 12:29:28 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:29:45 [INFO] | misfit f_try (i22s04) = 3.320E+01
2024-07-27 12:29:45 [INFO] | saving misfit and step length for step count == 4
2024-07-27 12:29:45 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 12:29:45 [INFO] | step length = 0.000E+00, 1.250E-01, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:29:45 [INFO] | misfit val  = 3.262E+01, 3.320E+01, 3.529E+01, 4.408E+01, 8.082E+01
2024-07-27 12:29:45 [INFO] | increment step count -> 5
2024-07-27 12:29:45 [INFO] | fail: backtracking line search has failed because the maximum allowable step counts (5) has been exceeded
2024-07-27 12:29:45 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:29:45 [INFO] | Force update of model max and min bounds
2024-07-27 12:29:45 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_22
2024-07-27 12:29:46 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:29:48 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:29:48 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:29:48 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:29:53 [INFO] | completed 9 tasks from task list
2024-07-27 12:29:53 [INFO] | 
================================================================================
                             COMPLETE ITERATION 22                              
================================================================================
2024-07-27 12:29:53 [INFO] | setting current iteration to: 23
2024-07-27 12:29:53 [INFO] | #######################current offset: 27
2024-07-27 12:29:53 [INFO] | 
================================================================================
                              RUNNING ITERATION 23                              
================================================================================
2024-07-27 12:29:53 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:29:53 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:29:53 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:29:53 [INFO] | checking model parameters:
2024-07-27 12:29:53 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:29:53 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:29:53 [INFO] | vs: min=494.246; mean=715.667; max=942.660
2024-07-27 12:29:53 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:30:11 [INFO] | misfit f_new (i23s05) = 3.452E+01
2024-07-27 12:30:11 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:30:11 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:30:31 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:30:31 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:31:00 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:31:00 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:31:02 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:31:02 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:31:03 [INFO] | exporting gradient to disk
2024-07-27 12:31:03 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:31:03 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:31:03 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:31:03 [INFO] | LBFGS iteration incremented -> 23
2024-07-27 12:31:03 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:31:03 [INFO] | new search direction: 40.08째 from current
2024-07-27 12:31:03 [INFO] | new L-BFGS search direction found
2024-07-27 12:31:03 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:31:03 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:31:03 [WARN] | `alpha` has exceeded maximum value 1.00, capping
2024-07-27 12:31:03 [INFO] | step length `alpha` = 6.174E-01
2024-07-27 12:31:03 [INFO] | updating model with `dm` (dm_min=-1.16E+02, dm_max = 7.47E+01)
2024-07-27 12:31:04 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:31:04 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:31:04 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:31:04 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:31:04 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:31:04 [INFO] | vs: min=491.031; mean=709.381; max=942.660
2024-07-27 12:31:04 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:31:21 [INFO] | misfit f_try (i23s01) = 7.393E+01
2024-07-27 12:31:21 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:31:21 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:31:21 [INFO] | step count  =         0,         1
2024-07-27 12:31:21 [INFO] | step length = 0.000E+00, 6.174E-01
2024-07-27 12:31:21 [INFO] | misfit val  = 3.452E+01, 7.393E+01
2024-07-27 12:31:21 [INFO] | increment step count -> 2
2024-07-27 12:31:21 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:31:21 [INFO] | step length `alpha` = 3.087E-01
2024-07-27 12:31:22 [INFO] | updating model with `dm` (dm_min=-5.78E+01, dm_max = 3.73E+01)
2024-07-27 12:31:22 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:31:22 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:31:22 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:31:22 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:31:22 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:31:22 [INFO] | vs: min=492.639; mean=712.524; max=942.660
2024-07-27 12:31:22 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:31:39 [INFO] | misfit f_try (i23s02) = 4.425E+01
2024-07-27 12:31:39 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:31:39 [INFO] | step count  =         0,         1,         2
2024-07-27 12:31:39 [INFO] | step length = 0.000E+00, 3.087E-01, 6.174E-01
2024-07-27 12:31:39 [INFO] | misfit val  = 3.452E+01, 4.425E+01, 7.393E+01
2024-07-27 12:31:39 [INFO] | increment step count -> 3
2024-07-27 12:31:39 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:31:39 [INFO] | step length `alpha` = 1.544E-01
2024-07-27 12:31:39 [INFO] | updating model with `dm` (dm_min=-2.89E+01, dm_max = 1.87E+01)
2024-07-27 12:31:39 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:31:41 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:31:41 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:31:41 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:31:41 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:31:41 [INFO] | vs: min=493.442; mean=714.096; max=942.660
2024-07-27 12:31:41 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:31:58 [INFO] | misfit f_try (i23s03) = 3.680E+01
2024-07-27 12:31:58 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:31:58 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:31:58 [INFO] | step length = 0.000E+00, 1.544E-01, 3.087E-01, 6.174E-01
2024-07-27 12:31:58 [INFO] | misfit val  = 3.452E+01, 3.680E+01, 4.425E+01, 7.393E+01
2024-07-27 12:31:58 [INFO] | increment step count -> 4
2024-07-27 12:31:58 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:31:58 [INFO] | step length `alpha` = 7.718E-02
2024-07-27 12:31:58 [INFO] | updating model with `dm` (dm_min=-1.44E+01, dm_max = 9.33E+00)
2024-07-27 12:31:58 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:32:00 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 12:32:00 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:32:00 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:32:00 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:32:00 [INFO] | vs: min=493.844; mean=714.882; max=942.660
2024-07-27 12:32:00 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:32:17 [INFO] | misfit f_try (i23s04) = 3.503E+01
2024-07-27 12:32:17 [INFO] | saving misfit and step length for step count == 4
2024-07-27 12:32:17 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 12:32:17 [INFO] | step length = 0.000E+00, 7.718E-02, 1.544E-01, 3.087E-01, 6.174E-01
2024-07-27 12:32:17 [INFO] | misfit val  = 3.452E+01, 3.503E+01, 3.680E+01, 4.425E+01, 7.393E+01
2024-07-27 12:32:17 [INFO] | increment step count -> 5
2024-07-27 12:32:17 [INFO] | fail: backtracking line search has failed because the maximum allowable step counts (5) has been exceeded
2024-07-27 12:32:17 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:32:17 [INFO] | Force update of model max and min bounds
2024-07-27 12:32:17 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_23
2024-07-27 12:32:18 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:32:19 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:32:19 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:32:20 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:32:23 [INFO] | completed 9 tasks from task list
2024-07-27 12:32:23 [INFO] | 
================================================================================
                             COMPLETE ITERATION 23                              
================================================================================
2024-07-27 12:32:23 [INFO] | setting current iteration to: 24
2024-07-27 12:32:23 [INFO] | #######################current offset: 24
2024-07-27 12:32:23 [INFO] | 
================================================================================
                              RUNNING ITERATION 24                              
================================================================================
2024-07-27 12:32:23 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:32:23 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:32:23 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:32:25 [INFO] | checking model parameters:
2024-07-27 12:32:25 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:32:25 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:32:25 [INFO] | vs: min=494.246; mean=715.667; max=942.660
2024-07-27 12:32:25 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:32:42 [INFO] | misfit f_new (i24s05) = 3.706E+01
2024-07-27 12:32:42 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:32:42 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:33:02 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:33:02 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:33:31 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:33:31 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:33:32 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:33:32 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:33:32 [INFO] | exporting gradient to disk
2024-07-27 12:33:32 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:33:32 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:33:32 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:33:32 [INFO] | LBFGS iteration incremented -> 24
2024-07-27 12:33:32 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:33:32 [INFO] | new search direction: 42.37째 from current
2024-07-27 12:33:32 [INFO] | new L-BFGS search direction found
2024-07-27 12:33:32 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:33:32 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:33:32 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:33:32 [INFO] | updating model with `dm` (dm_min=-1.59E+02, dm_max = 1.04E+02)
2024-07-27 12:33:34 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:33:34 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:33:34 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:33:34 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:33:34 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:33:34 [INFO] | vs: min=489.802; mean=707.570; max=942.660
2024-07-27 12:33:34 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:33:51 [INFO] | misfit f_try (i24s01) = 1.183E+02
2024-07-27 12:33:51 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:33:51 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:33:51 [INFO] | step count  =         0,         1
2024-07-27 12:33:51 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:33:51 [INFO] | misfit val  = 3.706E+01, 1.183E+02
2024-07-27 12:33:51 [INFO] | increment step count -> 2
2024-07-27 12:33:51 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:33:51 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 12:33:51 [INFO] | updating model with `dm` (dm_min=-7.97E+01, dm_max = 5.22E+01)
2024-07-27 12:33:51 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:33:52 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:33:52 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:33:52 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:33:52 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:33:52 [INFO] | vs: min=492.024; mean=711.625; max=942.545
2024-07-27 12:33:52 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:34:09 [INFO] | misfit f_try (i24s02) = 5.683E+01
2024-07-27 12:34:09 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:34:09 [INFO] | step count  =         0,         1,         2
2024-07-27 12:34:09 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 12:34:09 [INFO] | misfit val  = 3.706E+01, 5.683E+01, 1.183E+02
2024-07-27 12:34:09 [INFO] | increment step count -> 3
2024-07-27 12:34:09 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:34:09 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 12:34:09 [INFO] | updating model with `dm` (dm_min=-3.98E+01, dm_max = 2.61E+01)
2024-07-27 12:34:09 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:34:10 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:34:10 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:34:10 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:34:10 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:34:10 [INFO] | vs: min=493.135; mean=713.646; max=942.603
2024-07-27 12:34:10 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:34:27 [INFO] | misfit f_try (i24s03) = 4.149E+01
2024-07-27 12:34:27 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:34:27 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:34:27 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:34:27 [INFO] | misfit val  = 3.706E+01, 4.149E+01, 5.683E+01, 1.183E+02
2024-07-27 12:34:27 [INFO] | increment step count -> 4
2024-07-27 12:34:27 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:34:27 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 12:34:27 [INFO] | updating model with `dm` (dm_min=-1.99E+01, dm_max = 1.31E+01)
2024-07-27 12:34:27 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:34:27 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 12:34:27 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:34:27 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:34:27 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:34:27 [INFO] | vs: min=493.690; mean=714.657; max=942.631
2024-07-27 12:34:27 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:34:44 [INFO] | misfit f_try (i24s04) = 3.785E+01
2024-07-27 12:34:44 [INFO] | saving misfit and step length for step count == 4
2024-07-27 12:34:44 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 12:34:44 [INFO] | step length = 0.000E+00, 1.250E-01, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:34:44 [INFO] | misfit val  = 3.706E+01, 3.785E+01, 4.149E+01, 5.683E+01, 1.183E+02
2024-07-27 12:34:44 [INFO] | increment step count -> 5
2024-07-27 12:34:44 [INFO] | fail: backtracking line search has failed because the maximum allowable step counts (5) has been exceeded
2024-07-27 12:34:44 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:34:44 [INFO] | Force update of model max and min bounds
2024-07-27 12:34:44 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_24
2024-07-27 12:34:46 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:34:46 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:34:46 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:34:47 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:34:50 [INFO] | completed 9 tasks from task list
2024-07-27 12:34:50 [INFO] | 
================================================================================
                             COMPLETE ITERATION 24                              
================================================================================
2024-07-27 12:34:50 [INFO] | setting current iteration to: 25
2024-07-27 12:34:50 [INFO] | #######################current offset: 21
2024-07-27 12:34:50 [INFO] | 
================================================================================
                              RUNNING ITERATION 25                              
================================================================================
2024-07-27 12:34:50 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:34:50 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:34:50 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:34:51 [INFO] | checking model parameters:
2024-07-27 12:34:51 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:34:51 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:34:51 [INFO] | vs: min=494.246; mean=715.667; max=942.660
2024-07-27 12:34:51 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:35:08 [INFO] | misfit f_new (i25s05) = 4.102E+01
2024-07-27 12:35:08 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:35:08 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:35:28 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:35:28 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:35:59 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:35:59 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:36:01 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:36:01 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:36:01 [INFO] | exporting gradient to disk
2024-07-27 12:36:01 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:36:01 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:36:01 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:36:01 [INFO] | LBFGS iteration incremented -> 25
2024-07-27 12:36:01 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:36:01 [INFO] | new search direction: 40.89째 from current
2024-07-27 12:36:01 [INFO] | new L-BFGS search direction found
2024-07-27 12:36:01 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:36:01 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:36:01 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:36:01 [INFO] | updating model with `dm` (dm_min=-6.45E+01, dm_max = 4.04E+01)
2024-07-27 12:36:02 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:36:02 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:36:02 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:36:02 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:36:02 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:36:02 [INFO] | vs: min=492.438; mean=713.216; max=942.660
2024-07-27 12:36:02 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:36:19 [INFO] | misfit f_try (i25s01) = 4.847E+01
2024-07-27 12:36:19 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:36:19 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:36:19 [INFO] | step count  =         0,         1
2024-07-27 12:36:19 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:36:19 [INFO] | misfit val  = 4.102E+01, 4.847E+01
2024-07-27 12:36:19 [INFO] | increment step count -> 2
2024-07-27 12:36:19 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:36:19 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 12:36:19 [INFO] | updating model with `dm` (dm_min=-3.23E+01, dm_max = 2.02E+01)
2024-07-27 12:36:19 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:36:20 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:36:20 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:36:20 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:36:20 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:36:20 [INFO] | vs: min=493.342; mean=714.442; max=942.660
2024-07-27 12:36:20 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:36:37 [INFO] | misfit f_try (i25s02) = 4.131E+01
2024-07-27 12:36:37 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:36:37 [INFO] | step count  =         0,         1,         2
2024-07-27 12:36:37 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 12:36:37 [INFO] | misfit val  = 4.102E+01, 4.131E+01, 4.847E+01
2024-07-27 12:36:37 [INFO] | increment step count -> 3
2024-07-27 12:36:37 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:36:37 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 12:36:37 [INFO] | updating model with `dm` (dm_min=-1.61E+01, dm_max = 1.01E+01)
2024-07-27 12:36:37 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:36:38 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:36:38 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:36:38 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:36:38 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:36:38 [INFO] | vs: min=493.794; mean=715.055; max=942.660
2024-07-27 12:36:38 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:36:55 [INFO] | misfit f_try (i25s03) = 4.035E+01
2024-07-27 12:36:55 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:36:55 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:36:55 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:36:55 [INFO] | misfit val  = 4.102E+01, 4.035E+01, 4.131E+01, 4.847E+01
2024-07-27 12:36:55 [INFO] | increment step count -> 4
2024-07-27 12:36:55 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:36:55 [INFO] | final accepted step count == 3
2024-07-27 12:36:55 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 12:36:55 [INFO] | updating model with `dm` (dm_min=-1.61E+01, dm_max = 1.01E+01)
2024-07-27 12:36:55 [INFO] | trial step successful. finalizing line search
2024-07-27 12:36:55 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:36:55 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:36:55 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:36:56 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:36:56 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:36:56 [INFO] | misfit of accepted trial model is f=4.035E+01
2024-07-27 12:36:56 [INFO] | resetting line search step count to 0
2024-07-27 12:36:56 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:36:56 [INFO] | Force update of model max and min bounds
2024-07-27 12:36:56 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_25
2024-07-27 12:36:58 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:36:58 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:36:58 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:36:58 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:37:04 [INFO] | completed 9 tasks from task list
2024-07-27 12:37:04 [INFO] | 
================================================================================
                             COMPLETE ITERATION 25                              
================================================================================
2024-07-27 12:37:04 [INFO] | setting current iteration to: 26
2024-07-27 12:37:04 [INFO] | 
================================================================================
                              RUNNING ITERATION 26                              
================================================================================
2024-07-27 12:37:04 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:37:04 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:37:04 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:37:05 [INFO] | checking model parameters:
2024-07-27 12:37:05 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:37:05 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:37:05 [INFO] | vs: min=493.794; mean=715.055; max=942.660
2024-07-27 12:37:05 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:37:23 [INFO] | misfit f_new (i26s00) = 4.035E+01
2024-07-27 12:37:23 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:37:23 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:37:43 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:37:43 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:38:10 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:38:10 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:38:12 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:38:12 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:38:12 [INFO] | exporting gradient to disk
2024-07-27 12:38:12 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:38:12 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:38:12 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:38:12 [INFO] | LBFGS iteration incremented -> 26
2024-07-27 12:38:12 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:38:12 [INFO] | new search direction: 32.95째 from current
2024-07-27 12:38:12 [INFO] | new L-BFGS search direction found
2024-07-27 12:38:12 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:38:12 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:38:12 [WARN] | `alpha` has exceeded maximum value 0.63, capping
2024-07-27 12:38:13 [INFO] | step length `alpha` = 3.910E-01
2024-07-27 12:38:13 [INFO] | updating model with `dm` (dm_min=-1.16E+02, dm_max = 4.60E+01)
2024-07-27 12:38:14 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:38:14 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:38:14 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:38:14 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:38:14 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:38:14 [INFO] | vs: min=491.330; mean=706.600; max=942.660
2024-07-27 12:38:14 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:38:31 [INFO] | misfit f_try (i26s01) = 6.529E+01
2024-07-27 12:38:31 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:38:31 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:38:31 [INFO] | step count  =         0,         1
2024-07-27 12:38:31 [INFO] | step length = 0.000E+00, 3.910E-01
2024-07-27 12:38:31 [INFO] | misfit val  = 4.035E+01, 6.529E+01
2024-07-27 12:38:31 [INFO] | increment step count -> 2
2024-07-27 12:38:31 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:38:31 [INFO] | step length `alpha` = 1.955E-01
2024-07-27 12:38:31 [INFO] | updating model with `dm` (dm_min=-5.78E+01, dm_max = 2.30E+01)
2024-07-27 12:38:31 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:38:33 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:38:33 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:38:33 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:38:33 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:38:33 [INFO] | vs: min=492.562; mean=710.827; max=942.660
2024-07-27 12:38:33 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:38:51 [INFO] | misfit f_try (i26s02) = 4.388E+01
2024-07-27 12:38:51 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:38:51 [INFO] | step count  =         0,         1,         2
2024-07-27 12:38:51 [INFO] | step length = 0.000E+00, 1.955E-01, 3.910E-01
2024-07-27 12:38:51 [INFO] | misfit val  = 4.035E+01, 4.388E+01, 6.529E+01
2024-07-27 12:38:51 [INFO] | increment step count -> 3
2024-07-27 12:38:51 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:38:51 [INFO] | step length `alpha` = 9.775E-02
2024-07-27 12:38:51 [INFO] | updating model with `dm` (dm_min=-2.89E+01, dm_max = 1.15E+01)
2024-07-27 12:38:51 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:38:52 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:38:52 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:38:52 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:38:52 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:38:52 [INFO] | vs: min=493.178; mean=712.941; max=942.660
2024-07-27 12:38:53 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:39:10 [INFO] | misfit f_try (i26s03) = 3.995E+01
2024-07-27 12:39:10 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:39:10 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:39:10 [INFO] | step length = 0.000E+00, 9.775E-02, 1.955E-01, 3.910E-01
2024-07-27 12:39:10 [INFO] | misfit val  = 4.035E+01, 3.995E+01, 4.388E+01, 6.529E+01
2024-07-27 12:39:10 [INFO] | increment step count -> 4
2024-07-27 12:39:10 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:39:10 [INFO] | final accepted step count == 3
2024-07-27 12:39:10 [INFO] | step length `alpha` = 9.775E-02
2024-07-27 12:39:10 [INFO] | updating model with `dm` (dm_min=-2.89E+01, dm_max = 1.15E+01)
2024-07-27 12:39:10 [INFO] | trial step successful. finalizing line search
2024-07-27 12:39:10 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:39:10 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:39:10 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:39:10 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:39:10 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:39:10 [INFO] | misfit of accepted trial model is f=3.995E+01
2024-07-27 12:39:10 [INFO] | resetting line search step count to 0
2024-07-27 12:39:10 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:39:10 [INFO] | Force update of model max and min bounds
2024-07-27 12:39:10 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_26
2024-07-27 12:39:11 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:39:12 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:39:12 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:39:13 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:39:18 [INFO] | completed 9 tasks from task list
2024-07-27 12:39:18 [INFO] | 
================================================================================
                             COMPLETE ITERATION 26                              
================================================================================
2024-07-27 12:39:18 [INFO] | setting current iteration to: 27
2024-07-27 12:39:18 [INFO] | 
================================================================================
                              RUNNING ITERATION 27                              
================================================================================
2024-07-27 12:39:18 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:39:18 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:39:18 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:39:19 [INFO] | checking model parameters:
2024-07-27 12:39:19 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:39:19 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:39:19 [INFO] | vs: min=493.178; mean=712.941; max=942.660
2024-07-27 12:39:19 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:39:37 [INFO] | misfit f_new (i27s00) = 3.995E+01
2024-07-27 12:39:37 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:39:37 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:39:57 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:39:57 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:40:27 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:40:27 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:40:28 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:40:28 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:40:28 [INFO] | exporting gradient to disk
2024-07-27 12:40:28 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:40:28 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:40:28 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:40:28 [INFO] | LBFGS iteration incremented -> 27
2024-07-27 12:40:28 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:40:29 [INFO] | new search direction: 38.29째 from current
2024-07-27 12:40:29 [INFO] | new L-BFGS search direction found
2024-07-27 12:40:29 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:40:29 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:40:29 [WARN] | `alpha` has exceeded maximum value 0.59, capping
2024-07-27 12:40:29 [INFO] | step length `alpha` = 3.674E-01
2024-07-27 12:40:29 [INFO] | updating model with `dm` (dm_min=-1.16E+02, dm_max = 4.79E+01)
2024-07-27 12:40:30 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:40:30 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:40:30 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:40:30 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:40:30 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:40:30 [INFO] | vs: min=491.825; mean=706.413; max=942.660
2024-07-27 12:40:30 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:40:48 [INFO] | misfit f_try (i27s01) = 6.527E+01
2024-07-27 12:40:48 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:40:48 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:40:48 [INFO] | step count  =         0,         1
2024-07-27 12:40:48 [INFO] | step length = 0.000E+00, 3.674E-01
2024-07-27 12:40:48 [INFO] | misfit val  = 3.995E+01, 6.527E+01
2024-07-27 12:40:48 [INFO] | increment step count -> 2
2024-07-27 12:40:48 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:40:48 [INFO] | step length `alpha` = 1.837E-01
2024-07-27 12:40:48 [INFO] | updating model with `dm` (dm_min=-5.78E+01, dm_max = 2.39E+01)
2024-07-27 12:40:48 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:40:49 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:40:49 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:40:49 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:40:49 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:40:49 [INFO] | vs: min=492.501; mean=709.678; max=942.660
2024-07-27 12:40:49 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:41:06 [INFO] | misfit f_try (i27s02) = 4.696E+01
2024-07-27 12:41:06 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:41:06 [INFO] | step count  =         0,         1,         2
2024-07-27 12:41:06 [INFO] | step length = 0.000E+00, 1.837E-01, 3.674E-01
2024-07-27 12:41:06 [INFO] | misfit val  = 3.995E+01, 4.696E+01, 6.527E+01
2024-07-27 12:41:06 [INFO] | increment step count -> 3
2024-07-27 12:41:06 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:41:06 [INFO] | step length `alpha` = 9.186E-02
2024-07-27 12:41:06 [INFO] | updating model with `dm` (dm_min=-2.89E+01, dm_max = 1.20E+01)
2024-07-27 12:41:06 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:41:06 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:41:06 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:41:06 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:41:06 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:41:06 [INFO] | vs: min=492.840; mean=711.309; max=942.660
2024-07-27 12:41:06 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:41:23 [INFO] | misfit f_try (i27s03) = 4.205E+01
2024-07-27 12:41:23 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:41:23 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:41:23 [INFO] | step length = 0.000E+00, 9.186E-02, 1.837E-01, 3.674E-01
2024-07-27 12:41:23 [INFO] | misfit val  = 3.995E+01, 4.205E+01, 4.696E+01, 6.527E+01
2024-07-27 12:41:23 [INFO] | increment step count -> 4
2024-07-27 12:41:23 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:41:23 [INFO] | step length `alpha` = 4.593E-02
2024-07-27 12:41:23 [INFO] | updating model with `dm` (dm_min=-1.44E+01, dm_max = 5.99E+00)
2024-07-27 12:41:23 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:41:25 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 12:41:25 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:41:25 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:41:25 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:41:25 [INFO] | vs: min=493.009; mean=712.125; max=942.660
2024-07-27 12:41:25 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:41:42 [INFO] | misfit f_try (i27s04) = 4.063E+01
2024-07-27 12:41:42 [INFO] | saving misfit and step length for step count == 4
2024-07-27 12:41:42 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 12:41:42 [INFO] | step length = 0.000E+00, 4.593E-02, 9.186E-02, 1.837E-01, 3.674E-01
2024-07-27 12:41:42 [INFO] | misfit val  = 3.995E+01, 4.063E+01, 4.205E+01, 4.696E+01, 6.527E+01
2024-07-27 12:41:42 [INFO] | increment step count -> 5
2024-07-27 12:41:42 [INFO] | fail: backtracking line search has failed because the maximum allowable step counts (5) has been exceeded
2024-07-27 12:41:42 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:41:42 [INFO] | Force update of model max and min bounds
2024-07-27 12:41:42 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_27
2024-07-27 12:41:42 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:41:43 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:41:43 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:41:44 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:41:48 [INFO] | completed 9 tasks from task list
2024-07-27 12:41:48 [INFO] | 
================================================================================
                             COMPLETE ITERATION 27                              
================================================================================
2024-07-27 12:41:48 [INFO] | setting current iteration to: 28
2024-07-27 12:41:48 [INFO] | #######################current offset: 18
2024-07-27 12:41:48 [INFO] | 
================================================================================
                              RUNNING ITERATION 28                              
================================================================================
2024-07-27 12:41:48 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:41:48 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:41:48 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:41:49 [INFO] | checking model parameters:
2024-07-27 12:41:49 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:41:49 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:41:49 [INFO] | vs: min=493.178; mean=712.941; max=942.660
2024-07-27 12:41:49 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:42:06 [INFO] | misfit f_new (i28s05) = 4.393E+01
2024-07-27 12:42:06 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:42:06 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:42:26 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:42:26 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:42:54 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:42:54 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:42:55 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:42:55 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:42:56 [INFO] | exporting gradient to disk
2024-07-27 12:42:56 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:42:56 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:42:56 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:42:56 [INFO] | LBFGS iteration incremented -> 28
2024-07-27 12:42:56 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:42:56 [INFO] | new search direction: 35.86째 from current
2024-07-27 12:42:56 [INFO] | new L-BFGS search direction found
2024-07-27 12:42:56 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:42:56 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:42:56 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:42:56 [INFO] | updating model with `dm` (dm_min=-1.25E+02, dm_max = 6.37E+01)
2024-07-27 12:42:58 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:42:58 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:42:58 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:42:58 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:42:58 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:42:58 [INFO] | vs: min=491.679; mean=708.979; max=942.660
2024-07-27 12:42:58 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:43:15 [INFO] | misfit f_try (i28s01) = 6.821E+01
2024-07-27 12:43:15 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:43:15 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:43:15 [INFO] | step count  =         0,         1
2024-07-27 12:43:15 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:43:15 [INFO] | misfit val  = 4.393E+01, 6.821E+01
2024-07-27 12:43:15 [INFO] | increment step count -> 2
2024-07-27 12:43:15 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:43:15 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 12:43:15 [INFO] | updating model with `dm` (dm_min=-6.26E+01, dm_max = 3.19E+01)
2024-07-27 12:43:15 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:43:16 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:43:16 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:43:16 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:43:16 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:43:16 [INFO] | vs: min=492.428; mean=710.963; max=942.660
2024-07-27 12:43:16 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:43:33 [INFO] | misfit f_try (i28s02) = 4.804E+01
2024-07-27 12:43:33 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:43:33 [INFO] | step count  =         0,         1,         2
2024-07-27 12:43:33 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 12:43:33 [INFO] | misfit val  = 4.393E+01, 4.804E+01, 6.821E+01
2024-07-27 12:43:33 [INFO] | increment step count -> 3
2024-07-27 12:43:33 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:43:33 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 12:43:33 [INFO] | updating model with `dm` (dm_min=-3.13E+01, dm_max = 1.59E+01)
2024-07-27 12:43:33 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:43:34 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:43:34 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:43:34 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:43:34 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:43:34 [INFO] | vs: min=492.803; mean=711.952; max=942.660
2024-07-27 12:43:34 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:43:51 [INFO] | misfit f_try (i28s03) = 4.401E+01
2024-07-27 12:43:51 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:43:51 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:43:51 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:43:51 [INFO] | misfit val  = 4.393E+01, 4.401E+01, 4.804E+01, 6.821E+01
2024-07-27 12:43:51 [INFO] | increment step count -> 4
2024-07-27 12:43:51 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:43:51 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 12:43:51 [INFO] | updating model with `dm` (dm_min=-1.56E+01, dm_max = 7.96E+00)
2024-07-27 12:43:51 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:43:51 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 12:43:51 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:43:51 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:43:51 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:43:51 [INFO] | vs: min=492.990; mean=712.447; max=942.660
2024-07-27 12:43:51 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:44:08 [INFO] | misfit f_try (i28s04) = 4.343E+01
2024-07-27 12:44:08 [INFO] | saving misfit and step length for step count == 4
2024-07-27 12:44:08 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 12:44:08 [INFO] | step length = 0.000E+00, 1.250E-01, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:44:08 [INFO] | misfit val  = 4.393E+01, 4.343E+01, 4.401E+01, 4.804E+01, 6.821E+01
2024-07-27 12:44:08 [INFO] | increment step count -> 5
2024-07-27 12:44:08 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:44:08 [INFO] | final accepted step count == 4
2024-07-27 12:44:08 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 12:44:08 [INFO] | updating model with `dm` (dm_min=-1.56E+01, dm_max = 7.96E+00)
2024-07-27 12:44:08 [INFO] | trial step successful. finalizing line search
2024-07-27 12:44:08 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:44:08 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:44:08 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:44:08 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:44:08 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:44:08 [INFO] | misfit of accepted trial model is f=4.343E+01
2024-07-27 12:44:08 [INFO] | resetting line search step count to 0
2024-07-27 12:44:08 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:44:08 [INFO] | Force update of model max and min bounds
2024-07-27 12:44:08 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_28
2024-07-27 12:44:09 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:44:10 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:44:10 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:44:11 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:44:14 [INFO] | completed 9 tasks from task list
2024-07-27 12:44:14 [INFO] | 
================================================================================
                             COMPLETE ITERATION 28                              
================================================================================
2024-07-27 12:44:14 [INFO] | setting current iteration to: 29
2024-07-27 12:44:14 [INFO] | 
================================================================================
                              RUNNING ITERATION 29                              
================================================================================
2024-07-27 12:44:14 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:44:14 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:44:14 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:44:15 [INFO] | checking model parameters:
2024-07-27 12:44:15 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:44:15 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:44:15 [INFO] | vs: min=492.990; mean=712.447; max=942.660
2024-07-27 12:44:15 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:44:32 [INFO] | misfit f_new (i29s00) = 4.343E+01
2024-07-27 12:44:32 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:44:32 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:44:52 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:44:52 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:45:21 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:45:21 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:45:21 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:45:21 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:45:22 [INFO] | exporting gradient to disk
2024-07-27 12:45:22 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:45:22 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:45:22 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:45:22 [INFO] | LBFGS iteration incremented -> 29
2024-07-27 12:45:22 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:45:22 [INFO] | new search direction: 32.66째 from current
2024-07-27 12:45:22 [INFO] | new L-BFGS search direction found
2024-07-27 12:45:22 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:45:22 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:45:22 [WARN] | `alpha` has exceeded maximum value 0.50, capping
2024-07-27 12:45:22 [INFO] | step length `alpha` = 3.120E-01
2024-07-27 12:45:22 [INFO] | updating model with `dm` (dm_min=-1.16E+02, dm_max = 4.97E+01)
2024-07-27 12:45:24 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:45:24 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:45:24 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:45:24 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:45:24 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:45:24 [INFO] | vs: min=492.925; mean=709.319; max=942.660
2024-07-27 12:45:24 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:45:41 [INFO] | misfit f_try (i29s01) = 5.569E+01
2024-07-27 12:45:41 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:45:41 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:45:41 [INFO] | step count  =         0,         1
2024-07-27 12:45:41 [INFO] | step length = 0.000E+00, 3.120E-01
2024-07-27 12:45:41 [INFO] | misfit val  = 4.343E+01, 5.569E+01
2024-07-27 12:45:41 [INFO] | increment step count -> 2
2024-07-27 12:45:41 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:45:41 [INFO] | step length `alpha` = 1.560E-01
2024-07-27 12:45:41 [INFO] | updating model with `dm` (dm_min=-5.78E+01, dm_max = 2.49E+01)
2024-07-27 12:45:41 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:45:43 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:45:43 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:45:43 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:45:43 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:45:43 [INFO] | vs: min=492.958; mean=710.886; max=942.660
2024-07-27 12:45:43 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:46:01 [INFO] | misfit f_try (i29s02) = 4.512E+01
2024-07-27 12:46:01 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:46:01 [INFO] | step count  =         0,         1,         2
2024-07-27 12:46:01 [INFO] | step length = 0.000E+00, 1.560E-01, 3.120E-01
2024-07-27 12:46:01 [INFO] | misfit val  = 4.343E+01, 4.512E+01, 5.569E+01
2024-07-27 12:46:01 [INFO] | increment step count -> 3
2024-07-27 12:46:01 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:46:01 [INFO] | step length `alpha` = 7.800E-02
2024-07-27 12:46:01 [INFO] | updating model with `dm` (dm_min=-2.89E+01, dm_max = 1.24E+01)
2024-07-27 12:46:01 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:46:03 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:46:03 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:46:03 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:46:03 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:46:03 [INFO] | vs: min=492.974; mean=711.666; max=942.660
2024-07-27 12:46:03 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:46:20 [INFO] | misfit f_try (i29s03) = 4.326E+01
2024-07-27 12:46:20 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:46:20 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:46:20 [INFO] | step length = 0.000E+00, 7.800E-02, 1.560E-01, 3.120E-01
2024-07-27 12:46:20 [INFO] | misfit val  = 4.343E+01, 4.326E+01, 4.512E+01, 5.569E+01
2024-07-27 12:46:20 [INFO] | increment step count -> 4
2024-07-27 12:46:20 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:46:20 [INFO] | final accepted step count == 3
2024-07-27 12:46:20 [INFO] | step length `alpha` = 7.800E-02
2024-07-27 12:46:20 [INFO] | updating model with `dm` (dm_min=-2.89E+01, dm_max = 1.24E+01)
2024-07-27 12:46:20 [INFO] | trial step successful. finalizing line search
2024-07-27 12:46:20 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:46:20 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:46:20 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:46:20 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:46:20 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:46:20 [INFO] | misfit of accepted trial model is f=4.326E+01
2024-07-27 12:46:20 [INFO] | resetting line search step count to 0
2024-07-27 12:46:20 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:46:20 [INFO] | Force update of model max and min bounds
2024-07-27 12:46:20 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_29
2024-07-27 12:46:21 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:46:21 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:46:21 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:46:22 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:46:25 [INFO] | completed 9 tasks from task list
2024-07-27 12:46:25 [INFO] | 
================================================================================
                             COMPLETE ITERATION 29                              
================================================================================
2024-07-27 12:46:25 [INFO] | setting current iteration to: 30
2024-07-27 12:46:25 [INFO] | 
================================================================================
                              RUNNING ITERATION 30                              
================================================================================
2024-07-27 12:46:25 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:46:25 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:46:25 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:46:26 [INFO] | checking model parameters:
2024-07-27 12:46:26 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:46:26 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:46:26 [INFO] | vs: min=492.974; mean=711.666; max=942.660
2024-07-27 12:46:26 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:46:43 [INFO] | misfit f_new (i30s00) = 4.326E+01
2024-07-27 12:46:43 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:46:43 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:47:03 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:47:03 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:47:34 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:47:34 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:47:35 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:47:35 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:47:36 [INFO] | exporting gradient to disk
2024-07-27 12:47:36 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:47:36 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:47:36 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:47:36 [INFO] | LBFGS iteration incremented -> 30
2024-07-27 12:47:36 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:47:36 [INFO] | new search direction: 29.58째 from current
2024-07-27 12:47:36 [INFO] | new L-BFGS search direction found
2024-07-27 12:47:36 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:47:36 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:47:36 [WARN] | `alpha` has exceeded maximum value 0.62, capping
2024-07-27 12:47:36 [INFO] | step length `alpha` = 3.836E-01
2024-07-27 12:47:36 [INFO] | updating model with `dm` (dm_min=-1.16E+02, dm_max = 4.88E+01)
2024-07-27 12:47:37 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:47:37 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:47:37 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:47:37 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:47:37 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:47:37 [INFO] | vs: min=481.780; mean=709.059; max=942.660
2024-07-27 12:47:37 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:47:54 [INFO] | misfit f_try (i30s01) = 5.442E+01
2024-07-27 12:47:54 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:47:54 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:47:54 [INFO] | step count  =         0,         1
2024-07-27 12:47:54 [INFO] | step length = 0.000E+00, 3.836E-01
2024-07-27 12:47:54 [INFO] | misfit val  = 4.326E+01, 5.442E+01
2024-07-27 12:47:54 [INFO] | increment step count -> 2
2024-07-27 12:47:54 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:47:54 [INFO] | step length `alpha` = 1.918E-01
2024-07-27 12:47:54 [INFO] | updating model with `dm` (dm_min=-5.78E+01, dm_max = 2.44E+01)
2024-07-27 12:47:54 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:47:56 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:47:56 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:47:56 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:47:56 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:47:56 [INFO] | vs: min=492.907; mean=710.368; max=942.660
2024-07-27 12:47:56 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:48:12 [INFO] | misfit f_try (i30s02) = 4.480E+01
2024-07-27 12:48:12 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:48:12 [INFO] | step count  =         0,         1,         2
2024-07-27 12:48:12 [INFO] | step length = 0.000E+00, 1.918E-01, 3.836E-01
2024-07-27 12:48:12 [INFO] | misfit val  = 4.326E+01, 4.480E+01, 5.442E+01
2024-07-27 12:48:12 [INFO] | increment step count -> 3
2024-07-27 12:48:12 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:48:12 [INFO] | step length `alpha` = 9.591E-02
2024-07-27 12:48:12 [INFO] | updating model with `dm` (dm_min=-2.89E+01, dm_max = 1.22E+01)
2024-07-27 12:48:12 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:48:14 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:48:14 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:48:14 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:48:14 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:48:14 [INFO] | vs: min=492.941; mean=711.017; max=942.660
2024-07-27 12:48:14 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:48:32 [INFO] | misfit f_try (i30s03) = 4.320E+01
2024-07-27 12:48:32 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:48:32 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:48:32 [INFO] | step length = 0.000E+00, 9.591E-02, 1.918E-01, 3.836E-01
2024-07-27 12:48:32 [INFO] | misfit val  = 4.326E+01, 4.320E+01, 4.480E+01, 5.442E+01
2024-07-27 12:48:32 [INFO] | increment step count -> 4
2024-07-27 12:48:32 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:48:32 [INFO] | final accepted step count == 3
2024-07-27 12:48:32 [INFO] | step length `alpha` = 9.591E-02
2024-07-27 12:48:32 [INFO] | updating model with `dm` (dm_min=-2.89E+01, dm_max = 1.22E+01)
2024-07-27 12:48:32 [INFO] | trial step successful. finalizing line search
2024-07-27 12:48:32 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:48:32 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:48:32 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:48:32 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:48:32 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:48:32 [INFO] | misfit of accepted trial model is f=4.320E+01
2024-07-27 12:48:32 [INFO] | resetting line search step count to 0
2024-07-27 12:48:32 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:48:32 [INFO] | Force update of model max and min bounds
2024-07-27 12:48:32 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_30
2024-07-27 12:48:33 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:48:33 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:48:33 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:48:33 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:48:38 [INFO] | completed 9 tasks from task list
2024-07-27 12:48:38 [INFO] | 
================================================================================
                             COMPLETE ITERATION 30                              
================================================================================
2024-07-27 12:48:38 [INFO] | setting current iteration to: 31
2024-07-27 12:48:38 [INFO] | 
================================================================================
                              RUNNING ITERATION 31                              
================================================================================
2024-07-27 12:48:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:48:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:48:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:48:40 [INFO] | checking model parameters:
2024-07-27 12:48:40 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:48:40 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:48:40 [INFO] | vs: min=492.941; mean=711.017; max=942.660
2024-07-27 12:48:40 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:48:56 [INFO] | misfit f_new (i31s00) = 4.320E+01
2024-07-27 12:48:56 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:48:56 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:49:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:49:16 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:49:47 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:49:47 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:49:48 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:49:48 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:49:49 [INFO] | exporting gradient to disk
2024-07-27 12:49:49 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:49:49 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:49:49 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:49:49 [INFO] | LBFGS iteration incremented -> 31
2024-07-27 12:49:49 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:49:49 [INFO] | new search direction: 21.55째 from current
2024-07-27 12:49:49 [INFO] | new L-BFGS search direction found
2024-07-27 12:49:49 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:49:49 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:49:49 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:49:49 [INFO] | updating model with `dm` (dm_min=-8.81E+01, dm_max = 6.41E+01)
2024-07-27 12:49:51 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:49:51 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:49:51 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:49:51 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:49:51 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:49:51 [INFO] | vs: min=481.780; mean=712.211; max=942.660
2024-07-27 12:49:51 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:50:08 [INFO] | misfit f_try (i31s01) = 5.096E+01
2024-07-27 12:50:08 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:50:08 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:50:08 [INFO] | step count  =         0,         1
2024-07-27 12:50:08 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:50:08 [INFO] | misfit val  = 4.320E+01, 5.096E+01
2024-07-27 12:50:08 [INFO] | increment step count -> 2
2024-07-27 12:50:08 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:50:08 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 12:50:08 [INFO] | updating model with `dm` (dm_min=-4.40E+01, dm_max = 3.20E+01)
2024-07-27 12:50:08 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:50:09 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:50:09 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:50:09 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:50:09 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:50:09 [INFO] | vs: min=493.707; mean=711.622; max=942.660
2024-07-27 12:50:09 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:50:26 [INFO] | misfit f_try (i31s02) = 4.335E+01
2024-07-27 12:50:26 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:50:26 [INFO] | step count  =         0,         1,         2
2024-07-27 12:50:26 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 12:50:26 [INFO] | misfit val  = 4.320E+01, 4.335E+01, 5.096E+01
2024-07-27 12:50:26 [INFO] | increment step count -> 3
2024-07-27 12:50:26 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:50:26 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 12:50:26 [INFO] | updating model with `dm` (dm_min=-2.20E+01, dm_max = 1.60E+01)
2024-07-27 12:50:26 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:50:26 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 12:50:26 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:50:26 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:50:26 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:50:26 [INFO] | vs: min=493.324; mean=711.322; max=942.660
2024-07-27 12:50:26 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:50:45 [INFO] | misfit f_try (i31s03) = 4.246E+01
2024-07-27 12:50:45 [INFO] | saving misfit and step length for step count == 3
2024-07-27 12:50:45 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 12:50:45 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 12:50:45 [INFO] | misfit val  = 4.320E+01, 4.246E+01, 4.335E+01, 5.096E+01
2024-07-27 12:50:45 [INFO] | increment step count -> 4
2024-07-27 12:50:45 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:50:45 [INFO] | final accepted step count == 3
2024-07-27 12:50:45 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 12:50:45 [INFO] | updating model with `dm` (dm_min=-2.20E+01, dm_max = 1.60E+01)
2024-07-27 12:50:45 [INFO] | trial step successful. finalizing line search
2024-07-27 12:50:45 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:50:45 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:50:45 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:50:45 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:50:45 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:50:45 [INFO] | misfit of accepted trial model is f=4.246E+01
2024-07-27 12:50:45 [INFO] | resetting line search step count to 0
2024-07-27 12:50:45 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:50:45 [INFO] | Force update of model max and min bounds
2024-07-27 12:50:45 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_31
2024-07-27 12:50:46 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:50:47 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:50:47 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:50:49 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:50:53 [INFO] | completed 9 tasks from task list
2024-07-27 12:50:53 [INFO] | 
================================================================================
                             COMPLETE ITERATION 31                              
================================================================================
2024-07-27 12:50:53 [INFO] | setting current iteration to: 32
2024-07-27 12:50:53 [INFO] | 
================================================================================
                              RUNNING ITERATION 32                              
================================================================================
2024-07-27 12:50:53 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:50:53 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:50:53 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:50:54 [INFO] | checking model parameters:
2024-07-27 12:50:54 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:50:54 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:50:54 [INFO] | vs: min=493.324; mean=711.322; max=942.660
2024-07-27 12:50:54 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:51:11 [INFO] | misfit f_new (i32s00) = 4.246E+01
2024-07-27 12:51:11 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:51:11 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:51:31 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:51:31 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:52:02 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:52:02 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:52:03 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:52:03 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:52:04 [INFO] | exporting gradient to disk
2024-07-27 12:52:04 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:52:04 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:52:04 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:52:04 [INFO] | LBFGS iteration incremented -> 32
2024-07-27 12:52:04 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:52:04 [INFO] | new search direction: 31.56째 from current
2024-07-27 12:52:04 [INFO] | new L-BFGS search direction found
2024-07-27 12:52:04 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:52:04 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:52:04 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:52:04 [INFO] | updating model with `dm` (dm_min=-3.52E+01, dm_max = 2.64E+01)
2024-07-27 12:52:05 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:52:05 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:52:05 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:52:05 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:52:05 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:52:05 [INFO] | vs: min=493.968; mean=710.535; max=942.660
2024-07-27 12:52:05 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:52:22 [INFO] | misfit f_try (i32s01) = 4.275E+01
2024-07-27 12:52:22 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:52:22 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:52:22 [INFO] | step count  =         0,         1
2024-07-27 12:52:22 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:52:22 [INFO] | misfit val  = 4.246E+01, 4.275E+01
2024-07-27 12:52:22 [INFO] | increment step count -> 2
2024-07-27 12:52:22 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 12:52:22 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 12:52:22 [INFO] | updating model with `dm` (dm_min=-1.76E+01, dm_max = 1.32E+01)
2024-07-27 12:52:22 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 12:52:22 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 12:52:22 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:52:22 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:52:22 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:52:22 [INFO] | vs: min=493.646; mean=710.930; max=942.660
2024-07-27 12:52:22 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:52:40 [INFO] | misfit f_try (i32s02) = 4.208E+01
2024-07-27 12:52:40 [INFO] | saving misfit and step length for step count == 2
2024-07-27 12:52:40 [INFO] | step count  =         0,         1,         2
2024-07-27 12:52:40 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 12:52:40 [INFO] | misfit val  = 4.246E+01, 4.208E+01, 4.275E+01
2024-07-27 12:52:40 [INFO] | increment step count -> 3
2024-07-27 12:52:40 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:52:40 [INFO] | final accepted step count == 2
2024-07-27 12:52:40 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 12:52:40 [INFO] | updating model with `dm` (dm_min=-1.76E+01, dm_max = 1.32E+01)
2024-07-27 12:52:40 [INFO] | trial step successful. finalizing line search
2024-07-27 12:52:40 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:52:40 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:52:40 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:52:40 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:52:40 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:52:40 [INFO] | misfit of accepted trial model is f=4.208E+01
2024-07-27 12:52:40 [INFO] | resetting line search step count to 0
2024-07-27 12:52:40 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:52:40 [INFO] | Force update of model max and min bounds
2024-07-27 12:52:40 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_32
2024-07-27 12:52:41 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:52:41 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:52:41 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:52:43 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:52:49 [INFO] | completed 9 tasks from task list
2024-07-27 12:52:49 [INFO] | 
================================================================================
                             COMPLETE ITERATION 32                              
================================================================================
2024-07-27 12:52:49 [INFO] | setting current iteration to: 33
2024-07-27 12:52:49 [INFO] | 
================================================================================
                              RUNNING ITERATION 33                              
================================================================================
2024-07-27 12:52:49 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:52:49 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:52:49 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:52:51 [INFO] | checking model parameters:
2024-07-27 12:52:51 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:52:51 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:52:51 [INFO] | vs: min=493.646; mean=710.930; max=942.660
2024-07-27 12:52:51 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:53:09 [INFO] | misfit f_new (i33s00) = 4.208E+01
2024-07-27 12:53:09 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:53:09 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:53:29 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:53:29 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:53:57 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:53:57 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:53:59 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:53:59 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:53:59 [INFO] | exporting gradient to disk
2024-07-27 12:53:59 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:53:59 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:53:59 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:53:59 [INFO] | LBFGS iteration incremented -> 33
2024-07-27 12:53:59 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:53:59 [INFO] | new search direction: 31.11째 from current
2024-07-27 12:53:59 [INFO] | new L-BFGS search direction found
2024-07-27 12:53:59 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:53:59 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:53:59 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:53:59 [INFO] | updating model with `dm` (dm_min=-2.95E+01, dm_max = 4.60E+01)
2024-07-27 12:54:00 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:54:00 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:54:00 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:54:00 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:54:00 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:54:00 [INFO] | vs: min=490.903; mean=712.107; max=942.660
2024-07-27 12:54:00 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:54:17 [INFO] | misfit f_try (i33s01) = 3.597E+01
2024-07-27 12:54:17 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:54:17 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:54:17 [INFO] | step count  =         0,         1
2024-07-27 12:54:17 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:54:17 [INFO] | misfit val  = 4.208E+01, 3.597E+01
2024-07-27 12:54:17 [INFO] | increment step count -> 2
2024-07-27 12:54:17 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:54:17 [INFO] | final accepted step count == 1
2024-07-27 12:54:17 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:54:17 [INFO] | updating model with `dm` (dm_min=-2.95E+01, dm_max = 4.60E+01)
2024-07-27 12:54:17 [INFO] | trial step successful. finalizing line search
2024-07-27 12:54:17 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:54:17 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:54:17 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:54:18 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:54:18 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:54:18 [INFO] | misfit of accepted trial model is f=3.597E+01
2024-07-27 12:54:18 [INFO] | resetting line search step count to 0
2024-07-27 12:54:18 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:54:18 [INFO] | Force update of model max and min bounds
2024-07-27 12:54:18 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_33
2024-07-27 12:54:19 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:54:20 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:54:20 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:54:22 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:54:26 [INFO] | completed 9 tasks from task list
2024-07-27 12:54:26 [INFO] | 
================================================================================
                             COMPLETE ITERATION 33                              
================================================================================
2024-07-27 12:54:26 [INFO] | setting current iteration to: 34
2024-07-27 12:54:26 [INFO] | 
================================================================================
                              RUNNING ITERATION 34                              
================================================================================
2024-07-27 12:54:26 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:54:26 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:54:26 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:54:27 [INFO] | checking model parameters:
2024-07-27 12:54:27 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:54:27 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:54:27 [INFO] | vs: min=490.903; mean=712.107; max=942.660
2024-07-27 12:54:27 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:54:44 [INFO] | misfit f_new (i34s00) = 3.597E+01
2024-07-27 12:54:44 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:54:44 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:55:04 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:55:04 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:55:34 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:55:34 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:55:34 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:55:34 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:55:36 [INFO] | exporting gradient to disk
2024-07-27 12:55:36 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:55:36 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:55:36 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:55:36 [INFO] | LBFGS iteration incremented -> 34
2024-07-27 12:55:36 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:55:36 [INFO] | new search direction: 51.18째 from current
2024-07-27 12:55:36 [INFO] | new L-BFGS search direction found
2024-07-27 12:55:36 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:55:36 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:55:36 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:55:36 [INFO] | updating model with `dm` (dm_min=-1.10E+01, dm_max = 2.39E+01)
2024-07-27 12:55:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:55:38 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:55:38 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:55:38 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:55:38 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:55:38 [INFO] | vs: min=491.011; mean=712.511; max=942.660
2024-07-27 12:55:38 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:55:55 [INFO] | misfit f_try (i34s01) = 3.145E+01
2024-07-27 12:55:55 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:55:55 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:55:55 [INFO] | step count  =         0,         1
2024-07-27 12:55:55 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:55:55 [INFO] | misfit val  = 3.597E+01, 3.145E+01
2024-07-27 12:55:55 [INFO] | increment step count -> 2
2024-07-27 12:55:55 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:55:55 [INFO] | final accepted step count == 1
2024-07-27 12:55:55 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:55:55 [INFO] | updating model with `dm` (dm_min=-1.10E+01, dm_max = 2.39E+01)
2024-07-27 12:55:55 [INFO] | trial step successful. finalizing line search
2024-07-27 12:55:55 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:55:55 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:55:55 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:55:55 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:55:55 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:55:55 [INFO] | misfit of accepted trial model is f=3.145E+01
2024-07-27 12:55:55 [INFO] | resetting line search step count to 0
2024-07-27 12:55:55 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:55:55 [INFO] | Force update of model max and min bounds
2024-07-27 12:55:55 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_34
2024-07-27 12:55:56 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:55:56 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:55:56 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:55:57 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:56:03 [INFO] | completed 9 tasks from task list
2024-07-27 12:56:03 [INFO] | 
================================================================================
                             COMPLETE ITERATION 34                              
================================================================================
2024-07-27 12:56:03 [INFO] | setting current iteration to: 35
2024-07-27 12:56:03 [INFO] | 
================================================================================
                              RUNNING ITERATION 35                              
================================================================================
2024-07-27 12:56:03 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:56:03 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:56:03 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:56:05 [INFO] | checking model parameters:
2024-07-27 12:56:05 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:56:05 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:56:05 [INFO] | vs: min=491.011; mean=712.511; max=942.660
2024-07-27 12:56:05 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:56:23 [INFO] | misfit f_new (i35s00) = 3.145E+01
2024-07-27 12:56:23 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:56:23 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:56:43 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:56:43 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:57:13 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:57:13 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:57:14 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:57:14 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:57:15 [INFO] | exporting gradient to disk
2024-07-27 12:57:15 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:57:15 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:57:15 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:57:15 [INFO] | LBFGS iteration incremented -> 35
2024-07-27 12:57:15 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:57:15 [INFO] | new search direction: 52.74째 from current
2024-07-27 12:57:15 [INFO] | new L-BFGS search direction found
2024-07-27 12:57:15 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:57:15 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:57:15 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:57:15 [INFO] | updating model with `dm` (dm_min=-3.39E+01, dm_max = 7.05E+01)
2024-07-27 12:57:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:57:16 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:57:16 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:57:16 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:57:16 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:57:16 [INFO] | vs: min=487.594; mean=714.519; max=942.660
2024-07-27 12:57:16 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:57:32 [INFO] | misfit f_try (i35s01) = 2.119E+01
2024-07-27 12:57:32 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:57:32 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:57:32 [INFO] | step count  =         0,         1
2024-07-27 12:57:32 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:57:32 [INFO] | misfit val  = 3.145E+01, 2.119E+01
2024-07-27 12:57:32 [INFO] | increment step count -> 2
2024-07-27 12:57:32 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:57:32 [INFO] | final accepted step count == 1
2024-07-27 12:57:32 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:57:32 [INFO] | updating model with `dm` (dm_min=-3.39E+01, dm_max = 7.05E+01)
2024-07-27 12:57:32 [INFO] | trial step successful. finalizing line search
2024-07-27 12:57:32 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:57:32 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:57:32 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:57:33 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:57:33 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:57:33 [INFO] | misfit of accepted trial model is f=2.119E+01
2024-07-27 12:57:33 [INFO] | resetting line search step count to 0
2024-07-27 12:57:33 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:57:33 [INFO] | Force update of model max and min bounds
2024-07-27 12:57:33 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_35
2024-07-27 12:57:34 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:57:35 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:57:35 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:57:36 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:57:39 [INFO] | completed 9 tasks from task list
2024-07-27 12:57:39 [INFO] | 
================================================================================
                             COMPLETE ITERATION 35                              
================================================================================
2024-07-27 12:57:39 [INFO] | setting current iteration to: 36
2024-07-27 12:57:39 [INFO] | 
================================================================================
                              RUNNING ITERATION 36                              
================================================================================
2024-07-27 12:57:39 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:57:39 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:57:39 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:57:41 [INFO] | checking model parameters:
2024-07-27 12:57:41 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:57:41 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:57:41 [INFO] | vs: min=487.594; mean=714.519; max=942.660
2024-07-27 12:57:41 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:57:58 [INFO] | misfit f_new (i36s00) = 2.119E+01
2024-07-27 12:57:58 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:57:58 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:58:19 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:58:19 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 12:58:47 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:58:47 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:58:48 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:58:48 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 12:58:48 [INFO] | exporting gradient to disk
2024-07-27 12:58:48 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 12:58:48 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:58:48 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 12:58:48 [INFO] | LBFGS iteration incremented -> 36
2024-07-27 12:58:48 [INFO] | applying inverse Hessian to gradient
2024-07-27 12:58:48 [INFO] | new search direction: 46.77째 from current
2024-07-27 12:58:48 [INFO] | new L-BFGS search direction found
2024-07-27 12:58:48 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:58:48 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 12:58:48 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:58:48 [INFO] | updating model with `dm` (dm_min=-2.83E+01, dm_max = 2.08E+01)
2024-07-27 12:58:50 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:58:50 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 12:58:50 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 12:58:50 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:58:50 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:58:50 [INFO] | vs: min=498.680; mean=714.673; max=942.660
2024-07-27 12:58:50 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:59:06 [INFO] | misfit f_try (i36s01) = 2.038E+01
2024-07-27 12:59:06 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:59:06 [INFO] | saving misfit and step length for step count == 1
2024-07-27 12:59:06 [INFO] | step count  =         0,         1
2024-07-27 12:59:06 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 12:59:06 [INFO] | misfit val  = 2.119E+01, 2.038E+01
2024-07-27 12:59:06 [INFO] | increment step count -> 2
2024-07-27 12:59:06 [INFO] | pass: misfit decreased, line search successful
2024-07-27 12:59:06 [INFO] | final accepted step count == 1
2024-07-27 12:59:06 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 12:59:06 [INFO] | updating model with `dm` (dm_min=-2.83E+01, dm_max = 2.08E+01)
2024-07-27 12:59:06 [INFO] | trial step successful. finalizing line search
2024-07-27 12:59:06 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 12:59:06 [INFO] | removing previously accepted model files (?_old)
2024-07-27 12:59:06 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 12:59:07 [INFO] | setting current model as previous model (new -> old)
2024-07-27 12:59:07 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 12:59:07 [INFO] | misfit of accepted trial model is f=2.038E+01
2024-07-27 12:59:07 [INFO] | resetting line search step count to 0
2024-07-27 12:59:07 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:59:07 [INFO] | Force update of model max and min bounds
2024-07-27 12:59:07 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_36
2024-07-27 12:59:07 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 12:59:09 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 12:59:09 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 12:59:10 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 12:59:15 [INFO] | completed 9 tasks from task list
2024-07-27 12:59:15 [INFO] | 
================================================================================
                             COMPLETE ITERATION 36                              
================================================================================
2024-07-27 12:59:15 [INFO] | setting current iteration to: 37
2024-07-27 12:59:15 [INFO] | 
================================================================================
                              RUNNING ITERATION 37                              
================================================================================
2024-07-27 12:59:15 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:59:15 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:59:15 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:59:15 [INFO] | checking model parameters:
2024-07-27 12:59:15 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 12:59:15 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 12:59:15 [INFO] | vs: min=498.680; mean=714.673; max=942.660
2024-07-27 12:59:15 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 12:59:32 [INFO] | misfit f_new (i37s00) = 2.038E+01
2024-07-27 12:59:32 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:59:32 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 12:59:52 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 12:59:52 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:00:22 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:00:22 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:00:24 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:00:24 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:00:25 [INFO] | exporting gradient to disk
2024-07-27 13:00:25 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:00:25 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:00:25 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:00:25 [INFO] | LBFGS iteration incremented -> 37
2024-07-27 13:00:25 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:00:25 [INFO] | new search direction: 70.41째 from current
2024-07-27 13:00:25 [INFO] | new L-BFGS search direction found
2024-07-27 13:00:25 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:00:25 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:00:26 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:00:26 [INFO] | updating model with `dm` (dm_min=-2.01E+01, dm_max = 7.02E+00)
2024-07-27 13:00:26 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:00:26 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:00:26 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:00:26 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:00:26 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:00:26 [INFO] | vs: min=498.010; mean=713.843; max=942.660
2024-07-27 13:00:26 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:00:43 [INFO] | misfit f_try (i37s01) = 2.218E+01
2024-07-27 13:00:43 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:00:43 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:00:43 [INFO] | step count  =         0,         1
2024-07-27 13:00:43 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:00:43 [INFO] | misfit val  = 2.038E+01, 2.218E+01
2024-07-27 13:00:43 [INFO] | increment step count -> 2
2024-07-27 13:00:43 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:00:43 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 13:00:43 [INFO] | updating model with `dm` (dm_min=-1.00E+01, dm_max = 3.51E+00)
2024-07-27 13:00:43 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:00:44 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 13:00:44 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:00:44 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:00:44 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:00:44 [INFO] | vs: min=498.345; mean=714.258; max=942.660
2024-07-27 13:00:44 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:01:01 [INFO] | misfit f_try (i37s02) = 2.123E+01
2024-07-27 13:01:01 [INFO] | saving misfit and step length for step count == 2
2024-07-27 13:01:01 [INFO] | step count  =         0,         1,         2
2024-07-27 13:01:01 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 13:01:01 [INFO] | misfit val  = 2.038E+01, 2.123E+01, 2.218E+01
2024-07-27 13:01:01 [INFO] | increment step count -> 3
2024-07-27 13:01:01 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:01:01 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 13:01:01 [INFO] | updating model with `dm` (dm_min=-5.02E+00, dm_max = 1.76E+00)
2024-07-27 13:01:01 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:01:02 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 13:01:02 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:01:02 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:01:02 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:01:02 [INFO] | vs: min=498.513; mean=714.465; max=942.660
2024-07-27 13:01:02 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:01:19 [INFO] | misfit f_try (i37s03) = 2.078E+01
2024-07-27 13:01:19 [INFO] | saving misfit and step length for step count == 3
2024-07-27 13:01:19 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 13:01:19 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 13:01:19 [INFO] | misfit val  = 2.038E+01, 2.078E+01, 2.123E+01, 2.218E+01
2024-07-27 13:01:19 [INFO] | increment step count -> 4
2024-07-27 13:01:19 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:01:19 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 13:01:19 [INFO] | updating model with `dm` (dm_min=-2.51E+00, dm_max = 8.78E-01)
2024-07-27 13:01:19 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:01:21 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 13:01:21 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:01:21 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:01:21 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:01:21 [INFO] | vs: min=498.597; mean=714.569; max=942.660
2024-07-27 13:01:21 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:01:38 [INFO] | misfit f_try (i37s04) = 2.056E+01
2024-07-27 13:01:38 [INFO] | saving misfit and step length for step count == 4
2024-07-27 13:01:38 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 13:01:38 [INFO] | step length = 0.000E+00, 1.250E-01, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 13:01:38 [INFO] | misfit val  = 2.038E+01, 2.056E+01, 2.078E+01, 2.123E+01, 2.218E+01
2024-07-27 13:01:38 [INFO] | increment step count -> 5
2024-07-27 13:01:38 [INFO] | fail: backtracking line search has failed because the maximum allowable step counts (5) has been exceeded
2024-07-27 13:01:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:01:38 [INFO] | Force update of model max and min bounds
2024-07-27 13:01:38 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_37
2024-07-27 13:01:39 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:01:39 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:01:39 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:01:41 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:01:45 [INFO] | completed 9 tasks from task list
2024-07-27 13:01:45 [INFO] | 
================================================================================
                             COMPLETE ITERATION 37                              
================================================================================
2024-07-27 13:01:45 [INFO] | setting current iteration to: 38
2024-07-27 13:01:45 [INFO] | #######################current offset: 15
2024-07-27 13:01:45 [INFO] | 
================================================================================
                              RUNNING ITERATION 38                              
================================================================================
2024-07-27 13:01:45 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:01:45 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:01:45 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:01:47 [INFO] | checking model parameters:
2024-07-27 13:01:47 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:01:47 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:01:47 [INFO] | vs: min=498.680; mean=714.673; max=942.660
2024-07-27 13:01:47 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:02:03 [INFO] | misfit f_new (i38s05) = 2.096E+01
2024-07-27 13:02:03 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:02:03 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:02:24 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:02:24 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:02:56 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:02:56 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:02:57 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:02:57 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:02:59 [INFO] | exporting gradient to disk
2024-07-27 13:02:59 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:02:59 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:02:59 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:02:59 [INFO] | LBFGS iteration incremented -> 38
2024-07-27 13:02:59 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:02:59 [INFO] | new search direction: 69.35째 from current
2024-07-27 13:02:59 [INFO] | new L-BFGS search direction found
2024-07-27 13:02:59 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:02:59 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:02:59 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:02:59 [INFO] | updating model with `dm` (dm_min=-2.94E+01, dm_max = 8.29E+00)
2024-07-27 13:03:00 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:03:00 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:03:00 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:03:00 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:03:00 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:03:00 [INFO] | vs: min=497.806; mean=713.811; max=942.660
2024-07-27 13:03:00 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:03:17 [INFO] | misfit f_try (i38s01) = 2.320E+01
2024-07-27 13:03:17 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:03:17 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:03:17 [INFO] | step count  =         0,         1
2024-07-27 13:03:17 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:03:17 [INFO] | misfit val  = 2.096E+01, 2.320E+01
2024-07-27 13:03:17 [INFO] | increment step count -> 2
2024-07-27 13:03:17 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:03:17 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 13:03:17 [INFO] | updating model with `dm` (dm_min=-1.47E+01, dm_max = 4.14E+00)
2024-07-27 13:03:17 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:03:18 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 13:03:18 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:03:18 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:03:18 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:03:18 [INFO] | vs: min=498.243; mean=714.242; max=942.660
2024-07-27 13:03:18 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:03:35 [INFO] | misfit f_try (i38s02) = 2.195E+01
2024-07-27 13:03:35 [INFO] | saving misfit and step length for step count == 2
2024-07-27 13:03:35 [INFO] | step count  =         0,         1,         2
2024-07-27 13:03:35 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 13:03:35 [INFO] | misfit val  = 2.096E+01, 2.195E+01, 2.320E+01
2024-07-27 13:03:35 [INFO] | increment step count -> 3
2024-07-27 13:03:35 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:03:35 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 13:03:35 [INFO] | updating model with `dm` (dm_min=-7.34E+00, dm_max = 2.07E+00)
2024-07-27 13:03:35 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:03:35 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 13:03:35 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:03:35 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:03:35 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:03:35 [INFO] | vs: min=498.462; mean=714.457; max=942.660
2024-07-27 13:03:35 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:03:52 [INFO] | misfit f_try (i38s03) = 2.140E+01
2024-07-27 13:03:52 [INFO] | saving misfit and step length for step count == 3
2024-07-27 13:03:52 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 13:03:52 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 13:03:52 [INFO] | misfit val  = 2.096E+01, 2.140E+01, 2.195E+01, 2.320E+01
2024-07-27 13:03:52 [INFO] | increment step count -> 4
2024-07-27 13:03:52 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:03:52 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 13:03:52 [INFO] | updating model with `dm` (dm_min=-3.67E+00, dm_max = 1.04E+00)
2024-07-27 13:03:52 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:03:54 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 13:03:54 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:03:54 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:03:54 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:03:54 [INFO] | vs: min=498.571; mean=714.565; max=942.660
2024-07-27 13:03:54 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:04:11 [INFO] | misfit f_try (i38s04) = 2.115E+01
2024-07-27 13:04:11 [INFO] | saving misfit and step length for step count == 4
2024-07-27 13:04:11 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 13:04:11 [INFO] | step length = 0.000E+00, 1.250E-01, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 13:04:11 [INFO] | misfit val  = 2.096E+01, 2.115E+01, 2.140E+01, 2.195E+01, 2.320E+01
2024-07-27 13:04:11 [INFO] | increment step count -> 5
2024-07-27 13:04:11 [INFO] | fail: backtracking line search has failed because the maximum allowable step counts (5) has been exceeded
2024-07-27 13:04:11 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:04:11 [INFO] | Force update of model max and min bounds
2024-07-27 13:04:11 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_38
2024-07-27 13:04:12 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:04:13 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:04:13 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:04:14 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:04:19 [INFO] | completed 9 tasks from task list
2024-07-27 13:04:19 [INFO] | 
================================================================================
                             COMPLETE ITERATION 38                              
================================================================================
2024-07-27 13:04:19 [INFO] | setting current iteration to: 39
2024-07-27 13:04:19 [INFO] | #######################current offset: 12
2024-07-27 13:04:19 [INFO] | 
================================================================================
                              RUNNING ITERATION 39                              
================================================================================
2024-07-27 13:04:19 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:04:19 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:04:19 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:04:20 [INFO] | checking model parameters:
2024-07-27 13:04:20 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:04:20 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:04:20 [INFO] | vs: min=498.680; mean=714.673; max=942.660
2024-07-27 13:04:20 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:04:36 [INFO] | misfit f_new (i39s05) = 2.364E+01
2024-07-27 13:04:36 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:04:36 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:04:56 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:04:56 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:05:26 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:05:26 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:05:28 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:05:28 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:05:29 [INFO] | exporting gradient to disk
2024-07-27 13:05:29 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:05:29 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:05:29 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:05:29 [INFO] | LBFGS iteration incremented -> 39
2024-07-27 13:05:29 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:05:29 [INFO] | new search direction: 59.63째 from current
2024-07-27 13:05:29 [INFO] | new L-BFGS search direction found
2024-07-27 13:05:29 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:05:29 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:05:29 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:05:29 [INFO] | updating model with `dm` (dm_min=-1.89E+01, dm_max = 8.53E+00)
2024-07-27 13:05:30 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:05:30 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:05:30 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:05:30 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:05:30 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:05:30 [INFO] | vs: min=498.375; mean=714.508; max=942.660
2024-07-27 13:05:30 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:05:46 [INFO] | misfit f_try (i39s01) = 2.332E+01
2024-07-27 13:05:46 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:05:46 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:05:46 [INFO] | step count  =         0,         1
2024-07-27 13:05:46 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:05:46 [INFO] | misfit val  = 2.364E+01, 2.332E+01
2024-07-27 13:05:46 [INFO] | increment step count -> 2
2024-07-27 13:05:46 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:05:46 [INFO] | final accepted step count == 1
2024-07-27 13:05:46 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:05:46 [INFO] | updating model with `dm` (dm_min=-1.89E+01, dm_max = 8.53E+00)
2024-07-27 13:05:46 [INFO] | trial step successful. finalizing line search
2024-07-27 13:05:46 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:05:46 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:05:46 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:05:47 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:05:47 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:05:47 [INFO] | misfit of accepted trial model is f=2.332E+01
2024-07-27 13:05:47 [INFO] | resetting line search step count to 0
2024-07-27 13:05:47 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:05:47 [INFO] | Force update of model max and min bounds
2024-07-27 13:05:47 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_39
2024-07-27 13:05:48 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:05:50 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:05:50 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:05:51 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:05:56 [INFO] | completed 9 tasks from task list
2024-07-27 13:05:56 [INFO] | 
================================================================================
                             COMPLETE ITERATION 39                              
================================================================================
2024-07-27 13:05:56 [INFO] | setting current iteration to: 40
2024-07-27 13:05:56 [INFO] | 
================================================================================
                              RUNNING ITERATION 40                              
================================================================================
2024-07-27 13:05:56 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:05:56 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:05:56 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:05:57 [INFO] | checking model parameters:
2024-07-27 13:05:57 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:05:57 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:05:57 [INFO] | vs: min=498.375; mean=714.508; max=942.660
2024-07-27 13:05:57 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:06:15 [INFO] | misfit f_new (i40s00) = 2.332E+01
2024-07-27 13:06:15 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:06:15 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:06:35 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:06:35 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:07:04 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:07:04 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:07:05 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:07:05 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:07:05 [INFO] | exporting gradient to disk
2024-07-27 13:07:05 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:07:05 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:07:05 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:07:05 [INFO] | LBFGS iteration incremented -> 40
2024-07-27 13:07:05 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:07:05 [INFO] | new search direction: 49.37째 from current
2024-07-27 13:07:05 [INFO] | new L-BFGS search direction found
2024-07-27 13:07:05 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:07:05 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:07:05 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:07:05 [INFO] | updating model with `dm` (dm_min=-3.33E+01, dm_max = 1.64E+01)
2024-07-27 13:07:07 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:07:07 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:07:07 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:07:07 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:07:07 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:07:07 [INFO] | vs: min=498.255; mean=713.588; max=942.660
2024-07-27 13:07:07 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:07:23 [INFO] | misfit f_try (i40s01) = 2.333E+01
2024-07-27 13:07:23 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:07:23 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:07:23 [INFO] | step count  =         0,         1
2024-07-27 13:07:23 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:07:23 [INFO] | misfit val  = 2.332E+01, 2.333E+01
2024-07-27 13:07:23 [INFO] | increment step count -> 2
2024-07-27 13:07:23 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:07:23 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 13:07:23 [INFO] | updating model with `dm` (dm_min=-1.66E+01, dm_max = 8.19E+00)
2024-07-27 13:07:24 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:07:24 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 13:07:24 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:07:24 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:07:24 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:07:24 [INFO] | vs: min=498.315; mean=714.049; max=942.660
2024-07-27 13:07:24 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:07:41 [INFO] | misfit f_try (i40s02) = 2.290E+01
2024-07-27 13:07:41 [INFO] | saving misfit and step length for step count == 2
2024-07-27 13:07:41 [INFO] | step count  =         0,         1,         2
2024-07-27 13:07:41 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 13:07:41 [INFO] | misfit val  = 2.332E+01, 2.290E+01, 2.333E+01
2024-07-27 13:07:41 [INFO] | increment step count -> 3
2024-07-27 13:07:41 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:07:41 [INFO] | final accepted step count == 2
2024-07-27 13:07:41 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 13:07:41 [INFO] | updating model with `dm` (dm_min=-1.66E+01, dm_max = 8.19E+00)
2024-07-27 13:07:41 [INFO] | trial step successful. finalizing line search
2024-07-27 13:07:41 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:07:41 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:07:41 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:07:41 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:07:41 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:07:41 [INFO] | misfit of accepted trial model is f=2.290E+01
2024-07-27 13:07:41 [INFO] | resetting line search step count to 0
2024-07-27 13:07:41 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:07:41 [INFO] | Force update of model max and min bounds
2024-07-27 13:07:41 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_40
2024-07-27 13:07:41 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:07:42 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:07:42 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:07:42 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:07:47 [INFO] | completed 9 tasks from task list
2024-07-27 13:07:47 [INFO] | 
================================================================================
                             COMPLETE ITERATION 40                              
================================================================================
2024-07-27 13:07:47 [INFO] | setting current iteration to: 41
2024-07-27 13:07:47 [INFO] | 
================================================================================
                              RUNNING ITERATION 41                              
================================================================================
2024-07-27 13:07:47 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:07:47 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:07:47 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:07:48 [INFO] | checking model parameters:
2024-07-27 13:07:48 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:07:48 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:07:48 [INFO] | vs: min=498.315; mean=714.049; max=942.660
2024-07-27 13:07:48 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:08:05 [INFO] | misfit f_new (i41s00) = 2.290E+01
2024-07-27 13:08:05 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:08:05 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:08:25 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:08:25 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:08:56 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:08:56 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:08:56 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:08:56 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:08:57 [INFO] | exporting gradient to disk
2024-07-27 13:08:57 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:08:57 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:08:57 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:08:57 [INFO] | LBFGS iteration incremented -> 41
2024-07-27 13:08:57 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:08:58 [INFO] | new search direction: 35.73째 from current
2024-07-27 13:08:58 [INFO] | new L-BFGS search direction found
2024-07-27 13:08:58 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:08:58 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:08:58 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:08:58 [INFO] | updating model with `dm` (dm_min=-3.08E+01, dm_max = 3.11E+01)
2024-07-27 13:08:59 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:08:59 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:08:59 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:08:59 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:08:59 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:08:59 [INFO] | vs: min=485.499; mean=712.726; max=942.660
2024-07-27 13:08:59 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:09:16 [INFO] | misfit f_try (i41s01) = 2.245E+01
2024-07-27 13:09:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:09:16 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:09:16 [INFO] | step count  =         0,         1
2024-07-27 13:09:16 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:09:16 [INFO] | misfit val  = 2.290E+01, 2.245E+01
2024-07-27 13:09:16 [INFO] | increment step count -> 2
2024-07-27 13:09:16 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:09:16 [INFO] | final accepted step count == 1
2024-07-27 13:09:16 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:09:16 [INFO] | updating model with `dm` (dm_min=-3.08E+01, dm_max = 3.11E+01)
2024-07-27 13:09:16 [INFO] | trial step successful. finalizing line search
2024-07-27 13:09:16 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:09:16 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:09:16 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:09:17 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:09:17 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:09:17 [INFO] | misfit of accepted trial model is f=2.245E+01
2024-07-27 13:09:17 [INFO] | resetting line search step count to 0
2024-07-27 13:09:17 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:09:17 [INFO] | Force update of model max and min bounds
2024-07-27 13:09:17 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_41
2024-07-27 13:09:17 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:09:19 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:09:19 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:09:21 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:09:22 [INFO] | completed 9 tasks from task list
2024-07-27 13:09:22 [INFO] | 
================================================================================
                             COMPLETE ITERATION 41                              
================================================================================
2024-07-27 13:09:22 [INFO] | setting current iteration to: 42
2024-07-27 13:09:22 [INFO] | 
================================================================================
                              RUNNING ITERATION 42                              
================================================================================
2024-07-27 13:09:22 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:09:22 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:09:22 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:09:23 [INFO] | checking model parameters:
2024-07-27 13:09:23 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:09:23 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:09:23 [INFO] | vs: min=485.499; mean=712.726; max=942.660
2024-07-27 13:09:23 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:09:41 [INFO] | misfit f_new (i42s00) = 2.245E+01
2024-07-27 13:09:41 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:09:41 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:10:01 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:10:01 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:10:32 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:10:32 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:10:33 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:10:33 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:10:34 [INFO] | exporting gradient to disk
2024-07-27 13:10:34 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:10:34 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:10:34 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:10:34 [INFO] | LBFGS iteration incremented -> 42
2024-07-27 13:10:34 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:10:34 [INFO] | new search direction: 28.44째 from current
2024-07-27 13:10:34 [INFO] | new L-BFGS search direction found
2024-07-27 13:10:34 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:10:34 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:10:34 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:10:34 [INFO] | updating model with `dm` (dm_min=-1.66E+01, dm_max = 1.40E+01)
2024-07-27 13:10:35 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:10:35 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:10:35 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:10:35 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:10:35 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:10:35 [INFO] | vs: min=494.903; mean=712.800; max=942.660
2024-07-27 13:10:35 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:10:52 [INFO] | misfit f_try (i42s01) = 2.110E+01
2024-07-27 13:10:52 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:10:52 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:10:52 [INFO] | step count  =         0,         1
2024-07-27 13:10:52 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:10:52 [INFO] | misfit val  = 2.245E+01, 2.110E+01
2024-07-27 13:10:52 [INFO] | increment step count -> 2
2024-07-27 13:10:52 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:10:52 [INFO] | final accepted step count == 1
2024-07-27 13:10:52 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:10:52 [INFO] | updating model with `dm` (dm_min=-1.66E+01, dm_max = 1.40E+01)
2024-07-27 13:10:52 [INFO] | trial step successful. finalizing line search
2024-07-27 13:10:52 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:10:52 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:10:52 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:10:52 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:10:52 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:10:52 [INFO] | misfit of accepted trial model is f=2.110E+01
2024-07-27 13:10:52 [INFO] | resetting line search step count to 0
2024-07-27 13:10:52 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:10:52 [INFO] | Force update of model max and min bounds
2024-07-27 13:10:52 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_42
2024-07-27 13:10:53 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:10:53 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:10:53 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:10:55 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:10:59 [INFO] | completed 9 tasks from task list
2024-07-27 13:10:59 [INFO] | 
================================================================================
                             COMPLETE ITERATION 42                              
================================================================================
2024-07-27 13:10:59 [INFO] | setting current iteration to: 43
2024-07-27 13:10:59 [INFO] | 
================================================================================
                              RUNNING ITERATION 43                              
================================================================================
2024-07-27 13:10:59 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:10:59 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:10:59 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:10:59 [INFO] | checking model parameters:
2024-07-27 13:10:59 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:10:59 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:10:59 [INFO] | vs: min=494.903; mean=712.800; max=942.660
2024-07-27 13:10:59 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:11:15 [INFO] | misfit f_new (i43s00) = 2.110E+01
2024-07-27 13:11:15 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:11:16 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:11:35 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:11:35 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:12:04 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:12:04 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:12:05 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:12:05 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:12:06 [INFO] | exporting gradient to disk
2024-07-27 13:12:06 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:12:06 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:12:06 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:12:06 [INFO] | LBFGS iteration incremented -> 43
2024-07-27 13:12:06 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:12:06 [INFO] | new search direction: 52.65째 from current
2024-07-27 13:12:06 [INFO] | new L-BFGS search direction found
2024-07-27 13:12:06 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:12:06 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:12:06 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:12:06 [INFO] | updating model with `dm` (dm_min=-6.87E+00, dm_max = 1.32E+01)
2024-07-27 13:12:07 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:12:07 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:12:07 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:12:07 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:12:07 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:12:07 [INFO] | vs: min=496.756; mean=713.454; max=942.660
2024-07-27 13:12:07 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:12:23 [INFO] | misfit f_try (i43s01) = 2.051E+01
2024-07-27 13:12:23 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:12:23 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:12:23 [INFO] | step count  =         0,         1
2024-07-27 13:12:23 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:12:23 [INFO] | misfit val  = 2.110E+01, 2.051E+01
2024-07-27 13:12:23 [INFO] | increment step count -> 2
2024-07-27 13:12:23 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:12:23 [INFO] | final accepted step count == 1
2024-07-27 13:12:23 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:12:23 [INFO] | updating model with `dm` (dm_min=-6.87E+00, dm_max = 1.32E+01)
2024-07-27 13:12:23 [INFO] | trial step successful. finalizing line search
2024-07-27 13:12:23 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:12:23 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:12:23 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:12:24 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:12:24 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:12:24 [INFO] | misfit of accepted trial model is f=2.051E+01
2024-07-27 13:12:24 [INFO] | resetting line search step count to 0
2024-07-27 13:12:24 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:12:24 [INFO] | Force update of model max and min bounds
2024-07-27 13:12:24 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_43
2024-07-27 13:12:26 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:12:26 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:12:26 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:12:28 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:12:32 [INFO] | completed 9 tasks from task list
2024-07-27 13:12:32 [INFO] | 
================================================================================
                             COMPLETE ITERATION 43                              
================================================================================
2024-07-27 13:12:32 [INFO] | setting current iteration to: 44
2024-07-27 13:12:32 [INFO] | 
================================================================================
                              RUNNING ITERATION 44                              
================================================================================
2024-07-27 13:12:32 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:12:32 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:12:32 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:12:33 [INFO] | checking model parameters:
2024-07-27 13:12:33 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:12:33 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:12:33 [INFO] | vs: min=496.756; mean=713.454; max=942.660
2024-07-27 13:12:33 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:12:50 [INFO] | misfit f_new (i44s00) = 2.051E+01
2024-07-27 13:12:50 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:12:50 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:13:10 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:13:10 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:13:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:13:38 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:13:40 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:13:40 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:13:41 [INFO] | exporting gradient to disk
2024-07-27 13:13:41 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:13:41 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:13:41 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:13:41 [INFO] | LBFGS iteration incremented -> 44
2024-07-27 13:13:41 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:13:41 [INFO] | new search direction: 32.61째 from current
2024-07-27 13:13:41 [INFO] | new L-BFGS search direction found
2024-07-27 13:13:41 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:13:41 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:13:41 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:13:41 [INFO] | updating model with `dm` (dm_min=-8.05E+00, dm_max = 5.47E+00)
2024-07-27 13:13:42 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:13:42 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:13:42 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:13:42 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:13:42 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:13:42 [INFO] | vs: min=492.584; mean=713.247; max=942.660
2024-07-27 13:13:42 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:13:59 [INFO] | misfit f_try (i44s01) = 1.997E+01
2024-07-27 13:13:59 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:13:59 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:13:59 [INFO] | step count  =         0,         1
2024-07-27 13:13:59 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:13:59 [INFO] | misfit val  = 2.051E+01, 1.997E+01
2024-07-27 13:13:59 [INFO] | increment step count -> 2
2024-07-27 13:13:59 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:13:59 [INFO] | final accepted step count == 1
2024-07-27 13:13:59 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:13:59 [INFO] | updating model with `dm` (dm_min=-8.05E+00, dm_max = 5.47E+00)
2024-07-27 13:13:59 [INFO] | trial step successful. finalizing line search
2024-07-27 13:13:59 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:13:59 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:13:59 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:13:59 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:13:59 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:13:59 [INFO] | misfit of accepted trial model is f=1.997E+01
2024-07-27 13:13:59 [INFO] | resetting line search step count to 0
2024-07-27 13:13:59 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:13:59 [INFO] | Force update of model max and min bounds
2024-07-27 13:13:59 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_44
2024-07-27 13:14:00 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:14:02 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:14:02 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:14:03 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:14:07 [INFO] | completed 9 tasks from task list
2024-07-27 13:14:07 [INFO] | 
================================================================================
                             COMPLETE ITERATION 44                              
================================================================================
2024-07-27 13:14:07 [INFO] | setting current iteration to: 45
2024-07-27 13:14:07 [INFO] | 
================================================================================
                              RUNNING ITERATION 45                              
================================================================================
2024-07-27 13:14:07 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:14:07 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:14:07 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:14:09 [INFO] | checking model parameters:
2024-07-27 13:14:09 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:14:09 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:14:09 [INFO] | vs: min=492.584; mean=713.247; max=942.660
2024-07-27 13:14:09 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:14:26 [INFO] | misfit f_new (i45s00) = 1.997E+01
2024-07-27 13:14:26 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:14:26 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:14:46 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:14:46 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:15:18 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:15:18 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:15:18 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:15:18 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:15:18 [INFO] | exporting gradient to disk
2024-07-27 13:15:18 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:15:18 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:15:18 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:15:18 [INFO] | LBFGS iteration incremented -> 45
2024-07-27 13:15:18 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:15:18 [INFO] | new search direction: 43.01째 from current
2024-07-27 13:15:18 [INFO] | new L-BFGS search direction found
2024-07-27 13:15:18 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:15:18 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:15:18 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:15:18 [INFO] | updating model with `dm` (dm_min=-1.95E+01, dm_max = 1.24E+01)
2024-07-27 13:15:20 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:15:20 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:15:20 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:15:20 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:15:20 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:15:20 [INFO] | vs: min=487.088; mean=712.864; max=942.660
2024-07-27 13:15:20 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:15:37 [INFO] | misfit f_try (i45s01) = 1.894E+01
2024-07-27 13:15:37 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:15:37 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:15:37 [INFO] | step count  =         0,         1
2024-07-27 13:15:37 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:15:37 [INFO] | misfit val  = 1.997E+01, 1.894E+01
2024-07-27 13:15:37 [INFO] | increment step count -> 2
2024-07-27 13:15:37 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:15:37 [INFO] | final accepted step count == 1
2024-07-27 13:15:37 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:15:37 [INFO] | updating model with `dm` (dm_min=-1.95E+01, dm_max = 1.24E+01)
2024-07-27 13:15:37 [INFO] | trial step successful. finalizing line search
2024-07-27 13:15:37 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:15:37 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:15:37 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:15:37 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:15:37 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:15:37 [INFO] | misfit of accepted trial model is f=1.894E+01
2024-07-27 13:15:37 [INFO] | resetting line search step count to 0
2024-07-27 13:15:37 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:15:37 [INFO] | Force update of model max and min bounds
2024-07-27 13:15:37 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_45
2024-07-27 13:15:39 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:15:40 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:15:40 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:15:41 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:15:45 [INFO] | completed 9 tasks from task list
2024-07-27 13:15:45 [INFO] | 
================================================================================
                             COMPLETE ITERATION 45                              
================================================================================
2024-07-27 13:15:45 [INFO] | setting current iteration to: 46
2024-07-27 13:15:45 [INFO] | 
================================================================================
                              RUNNING ITERATION 46                              
================================================================================
2024-07-27 13:15:45 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:15:45 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:15:45 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:15:46 [INFO] | checking model parameters:
2024-07-27 13:15:46 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:15:46 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:15:46 [INFO] | vs: min=487.088; mean=712.864; max=942.660
2024-07-27 13:15:46 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:16:02 [INFO] | misfit f_new (i46s00) = 1.894E+01
2024-07-27 13:16:02 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:16:02 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:16:23 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:16:23 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:16:53 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:16:53 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:16:53 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:16:53 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:16:53 [INFO] | exporting gradient to disk
2024-07-27 13:16:53 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:16:53 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:16:53 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:16:53 [INFO] | LBFGS iteration incremented -> 46
2024-07-27 13:16:53 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:16:53 [INFO] | new search direction: 62.29째 from current
2024-07-27 13:16:53 [INFO] | new L-BFGS search direction found
2024-07-27 13:16:53 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:16:53 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:16:53 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:16:53 [INFO] | updating model with `dm` (dm_min=-2.41E+01, dm_max = 1.77E+01)
2024-07-27 13:16:55 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:16:55 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:16:55 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:16:55 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:16:55 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:16:55 [INFO] | vs: min=482.641; mean=712.969; max=942.660
2024-07-27 13:16:55 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:17:11 [INFO] | misfit f_try (i46s01) = 1.712E+01
2024-07-27 13:17:11 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:17:11 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:17:11 [INFO] | step count  =         0,         1
2024-07-27 13:17:11 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:17:11 [INFO] | misfit val  = 1.894E+01, 1.712E+01
2024-07-27 13:17:11 [INFO] | increment step count -> 2
2024-07-27 13:17:11 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:17:11 [INFO] | final accepted step count == 1
2024-07-27 13:17:11 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:17:11 [INFO] | updating model with `dm` (dm_min=-2.41E+01, dm_max = 1.77E+01)
2024-07-27 13:17:11 [INFO] | trial step successful. finalizing line search
2024-07-27 13:17:11 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:17:11 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:17:11 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:17:12 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:17:12 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:17:12 [INFO] | misfit of accepted trial model is f=1.712E+01
2024-07-27 13:17:12 [INFO] | resetting line search step count to 0
2024-07-27 13:17:12 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:17:12 [INFO] | Force update of model max and min bounds
2024-07-27 13:17:12 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_46
2024-07-27 13:17:13 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:17:14 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:17:14 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:17:14 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:17:19 [INFO] | completed 9 tasks from task list
2024-07-27 13:17:19 [INFO] | 
================================================================================
                             COMPLETE ITERATION 46                              
================================================================================
2024-07-27 13:17:19 [INFO] | setting current iteration to: 47
2024-07-27 13:17:19 [INFO] | 
================================================================================
                              RUNNING ITERATION 47                              
================================================================================
2024-07-27 13:17:19 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:17:19 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:17:19 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:17:20 [INFO] | checking model parameters:
2024-07-27 13:17:20 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:17:20 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:17:20 [INFO] | vs: min=482.641; mean=712.969; max=942.660
2024-07-27 13:17:20 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:17:37 [INFO] | misfit f_new (i47s00) = 1.712E+01
2024-07-27 13:17:37 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:17:37 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:17:57 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:17:57 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:18:26 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:18:26 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:18:27 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:18:27 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:18:29 [INFO] | exporting gradient to disk
2024-07-27 13:18:29 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:18:29 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:18:29 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:18:29 [INFO] | LBFGS iteration incremented -> 47
2024-07-27 13:18:29 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:18:29 [INFO] | new search direction: 69.16째 from current
2024-07-27 13:18:29 [INFO] | new L-BFGS search direction found
2024-07-27 13:18:29 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:18:29 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:18:29 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:18:29 [INFO] | updating model with `dm` (dm_min=-4.33E+01, dm_max = 3.57E+01)
2024-07-27 13:18:30 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:18:30 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:18:30 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:18:30 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:18:30 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:18:30 [INFO] | vs: min=481.780; mean=713.211; max=942.660
2024-07-27 13:18:30 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:18:47 [INFO] | misfit f_try (i47s01) = 1.425E+01
2024-07-27 13:18:47 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:18:47 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:18:47 [INFO] | step count  =         0,         1
2024-07-27 13:18:47 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:18:47 [INFO] | misfit val  = 1.712E+01, 1.425E+01
2024-07-27 13:18:47 [INFO] | increment step count -> 2
2024-07-27 13:18:47 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:18:47 [INFO] | final accepted step count == 1
2024-07-27 13:18:47 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:18:47 [INFO] | updating model with `dm` (dm_min=-4.33E+01, dm_max = 3.57E+01)
2024-07-27 13:18:48 [INFO] | trial step successful. finalizing line search
2024-07-27 13:18:48 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:18:48 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:18:48 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:18:48 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:18:48 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:18:48 [INFO] | misfit of accepted trial model is f=1.425E+01
2024-07-27 13:18:48 [INFO] | resetting line search step count to 0
2024-07-27 13:18:48 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:18:48 [INFO] | Force update of model max and min bounds
2024-07-27 13:18:48 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_47
2024-07-27 13:18:50 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:18:51 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:18:51 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:18:52 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:18:55 [INFO] | completed 9 tasks from task list
2024-07-27 13:18:55 [INFO] | 
================================================================================
                             COMPLETE ITERATION 47                              
================================================================================
2024-07-27 13:18:55 [INFO] | setting current iteration to: 48
2024-07-27 13:18:55 [INFO] | 
================================================================================
                              RUNNING ITERATION 48                              
================================================================================
2024-07-27 13:18:55 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:18:55 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:18:55 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:18:57 [INFO] | checking model parameters:
2024-07-27 13:18:57 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:18:57 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:18:57 [INFO] | vs: min=481.780; mean=713.211; max=942.660
2024-07-27 13:18:57 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:19:14 [INFO] | misfit f_new (i48s00) = 1.425E+01
2024-07-27 13:19:14 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:19:14 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:19:33 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:19:33 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:20:04 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:20:04 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:20:04 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:20:04 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:20:05 [INFO] | exporting gradient to disk
2024-07-27 13:20:05 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:20:05 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:20:05 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:20:05 [INFO] | LBFGS iteration incremented -> 48
2024-07-27 13:20:05 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:20:05 [INFO] | new search direction: 54.87째 from current
2024-07-27 13:20:05 [INFO] | new L-BFGS search direction found
2024-07-27 13:20:05 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:20:05 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:20:05 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:20:06 [INFO] | updating model with `dm` (dm_min=-7.69E+00, dm_max = 1.11E+01)
2024-07-27 13:20:07 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:20:07 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:20:07 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:20:07 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:20:07 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:20:07 [INFO] | vs: min=482.749; mean=713.778; max=942.660
2024-07-27 13:20:07 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:20:23 [INFO] | misfit f_try (i48s01) = 1.438E+01
2024-07-27 13:20:23 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:20:23 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:20:23 [INFO] | step count  =         0,         1
2024-07-27 13:20:23 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:20:23 [INFO] | misfit val  = 1.425E+01, 1.438E+01
2024-07-27 13:20:23 [INFO] | increment step count -> 2
2024-07-27 13:20:23 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:20:23 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 13:20:23 [INFO] | updating model with `dm` (dm_min=-3.84E+00, dm_max = 5.53E+00)
2024-07-27 13:20:23 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:20:23 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 13:20:23 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:20:23 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:20:23 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:20:23 [INFO] | vs: min=482.264; mean=713.494; max=942.660
2024-07-27 13:20:23 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:20:40 [INFO] | misfit f_try (i48s02) = 1.424E+01
2024-07-27 13:20:40 [INFO] | saving misfit and step length for step count == 2
2024-07-27 13:20:40 [INFO] | step count  =         0,         1,         2
2024-07-27 13:20:40 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 13:20:40 [INFO] | misfit val  = 1.425E+01, 1.424E+01, 1.438E+01
2024-07-27 13:20:40 [INFO] | increment step count -> 3
2024-07-27 13:20:40 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:20:40 [INFO] | final accepted step count == 2
2024-07-27 13:20:40 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 13:20:40 [INFO] | updating model with `dm` (dm_min=-3.84E+00, dm_max = 5.53E+00)
2024-07-27 13:20:40 [INFO] | trial step successful. finalizing line search
2024-07-27 13:20:40 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:20:40 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:20:40 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:20:40 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:20:40 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:20:40 [INFO] | misfit of accepted trial model is f=1.424E+01
2024-07-27 13:20:40 [INFO] | resetting line search step count to 0
2024-07-27 13:20:40 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:20:40 [INFO] | Force update of model max and min bounds
2024-07-27 13:20:40 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_48
2024-07-27 13:20:41 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:20:43 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:20:43 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:20:44 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:20:48 [INFO] | completed 9 tasks from task list
2024-07-27 13:20:48 [INFO] | 
================================================================================
                             COMPLETE ITERATION 48                              
================================================================================
2024-07-27 13:20:48 [INFO] | setting current iteration to: 49
2024-07-27 13:20:48 [INFO] | 
================================================================================
                              RUNNING ITERATION 49                              
================================================================================
2024-07-27 13:20:48 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:20:48 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:20:48 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:20:48 [INFO] | checking model parameters:
2024-07-27 13:20:48 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:20:48 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:20:48 [INFO] | vs: min=482.264; mean=713.494; max=942.660
2024-07-27 13:20:48 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:21:05 [INFO] | misfit f_new (i49s00) = 1.424E+01
2024-07-27 13:21:05 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:21:05 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:21:25 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:21:25 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:21:55 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:21:55 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:21:56 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:21:56 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:21:57 [INFO] | exporting gradient to disk
2024-07-27 13:21:57 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:21:57 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:21:57 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:21:57 [INFO] | LBFGS iteration incremented -> 49
2024-07-27 13:21:57 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:21:57 [INFO] | new search direction: 55.39째 from current
2024-07-27 13:21:57 [INFO] | new L-BFGS search direction found
2024-07-27 13:21:57 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:21:57 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:21:57 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:21:57 [INFO] | updating model with `dm` (dm_min=-1.69E+01, dm_max = 2.33E+01)
2024-07-27 13:21:59 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:21:59 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:21:59 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:21:59 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:21:59 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:21:59 [INFO] | vs: min=484.365; mean=714.378; max=942.660
2024-07-27 13:21:59 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:22:16 [INFO] | misfit f_try (i49s01) = 1.503E+01
2024-07-27 13:22:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:22:16 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:22:16 [INFO] | step count  =         0,         1
2024-07-27 13:22:16 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:22:16 [INFO] | misfit val  = 1.424E+01, 1.503E+01
2024-07-27 13:22:16 [INFO] | increment step count -> 2
2024-07-27 13:22:16 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:22:16 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 13:22:16 [INFO] | updating model with `dm` (dm_min=-8.45E+00, dm_max = 1.16E+01)
2024-07-27 13:22:16 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:22:17 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 13:22:17 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:22:17 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:22:17 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:22:17 [INFO] | vs: min=483.315; mean=713.936; max=942.660
2024-07-27 13:22:17 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:22:34 [INFO] | misfit f_try (i49s02) = 1.455E+01
2024-07-27 13:22:34 [INFO] | saving misfit and step length for step count == 2
2024-07-27 13:22:34 [INFO] | step count  =         0,         1,         2
2024-07-27 13:22:34 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 13:22:34 [INFO] | misfit val  = 1.424E+01, 1.455E+01, 1.503E+01
2024-07-27 13:22:34 [INFO] | increment step count -> 3
2024-07-27 13:22:34 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:22:34 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 13:22:34 [INFO] | updating model with `dm` (dm_min=-4.23E+00, dm_max = 5.81E+00)
2024-07-27 13:22:34 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:22:35 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 13:22:35 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:22:35 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:22:35 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:22:35 [INFO] | vs: min=482.790; mean=713.715; max=942.660
2024-07-27 13:22:35 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:22:52 [INFO] | misfit f_try (i49s03) = 1.438E+01
2024-07-27 13:22:52 [INFO] | saving misfit and step length for step count == 3
2024-07-27 13:22:52 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 13:22:52 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 13:22:52 [INFO] | misfit val  = 1.424E+01, 1.438E+01, 1.455E+01, 1.503E+01
2024-07-27 13:22:52 [INFO] | increment step count -> 4
2024-07-27 13:22:52 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:22:52 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 13:22:52 [INFO] | updating model with `dm` (dm_min=-2.11E+00, dm_max = 2.91E+00)
2024-07-27 13:22:52 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:22:52 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 13:22:52 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:22:52 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:22:52 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:22:52 [INFO] | vs: min=482.527; mean=713.605; max=942.660
2024-07-27 13:22:52 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:23:08 [INFO] | misfit f_try (i49s04) = 1.430E+01
2024-07-27 13:23:08 [INFO] | saving misfit and step length for step count == 4
2024-07-27 13:23:08 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 13:23:08 [INFO] | step length = 0.000E+00, 1.250E-01, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 13:23:08 [INFO] | misfit val  = 1.424E+01, 1.430E+01, 1.438E+01, 1.455E+01, 1.503E+01
2024-07-27 13:23:08 [INFO] | increment step count -> 5
2024-07-27 13:23:08 [INFO] | fail: backtracking line search has failed because the maximum allowable step counts (5) has been exceeded
2024-07-27 13:23:08 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:23:08 [INFO] | Force update of model max and min bounds
2024-07-27 13:23:08 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_49
2024-07-27 13:23:09 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:23:11 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:23:11 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:23:12 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:23:16 [INFO] | completed 9 tasks from task list
2024-07-27 13:23:16 [INFO] | 
================================================================================
                             COMPLETE ITERATION 49                              
================================================================================
2024-07-27 13:23:16 [INFO] | setting current iteration to: 50
2024-07-27 13:23:16 [INFO] | #######################current offset: 9
2024-07-27 13:23:16 [INFO] | 
================================================================================
                              RUNNING ITERATION 50                              
================================================================================
2024-07-27 13:23:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:23:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:23:16 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:23:17 [INFO] | checking model parameters:
2024-07-27 13:23:17 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:23:17 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:23:17 [INFO] | vs: min=482.264; mean=713.494; max=942.660
2024-07-27 13:23:17 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:23:33 [INFO] | misfit f_new (i50s05) = 1.584E+01
2024-07-27 13:23:33 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:23:33 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:23:53 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:23:53 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:24:24 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:24:24 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:24:26 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:24:26 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:24:27 [INFO] | exporting gradient to disk
2024-07-27 13:24:27 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:24:27 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:24:27 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:24:27 [INFO] | LBFGS iteration incremented -> 50
2024-07-27 13:24:27 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:24:28 [INFO] | new search direction: 67.61째 from current
2024-07-27 13:24:28 [INFO] | new L-BFGS search direction found
2024-07-27 13:24:28 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:24:28 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:24:28 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:24:28 [INFO] | updating model with `dm` (dm_min=-9.87E+00, dm_max = 1.48E+01)
2024-07-27 13:24:29 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:24:29 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:24:29 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:24:29 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:24:29 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:24:29 [INFO] | vs: min=483.709; mean=713.732; max=942.660
2024-07-27 13:24:29 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:24:45 [INFO] | misfit f_try (i50s01) = 1.632E+01
2024-07-27 13:24:45 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:24:45 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:24:45 [INFO] | step count  =         0,         1
2024-07-27 13:24:45 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:24:45 [INFO] | misfit val  = 1.584E+01, 1.632E+01
2024-07-27 13:24:45 [INFO] | increment step count -> 2
2024-07-27 13:24:45 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:24:45 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 13:24:45 [INFO] | updating model with `dm` (dm_min=-4.94E+00, dm_max = 7.39E+00)
2024-07-27 13:24:45 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:24:47 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 13:24:47 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:24:47 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:24:47 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:24:47 [INFO] | vs: min=482.991; mean=713.613; max=942.660
2024-07-27 13:24:47 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:25:03 [INFO] | misfit f_try (i50s02) = 1.604E+01
2024-07-27 13:25:03 [INFO] | saving misfit and step length for step count == 2
2024-07-27 13:25:03 [INFO] | step count  =         0,         1,         2
2024-07-27 13:25:03 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 13:25:03 [INFO] | misfit val  = 1.584E+01, 1.604E+01, 1.632E+01
2024-07-27 13:25:03 [INFO] | increment step count -> 3
2024-07-27 13:25:03 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:25:04 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 13:25:04 [INFO] | updating model with `dm` (dm_min=-2.47E+00, dm_max = 3.70E+00)
2024-07-27 13:25:04 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:25:05 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 13:25:05 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:25:05 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:25:05 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:25:05 [INFO] | vs: min=482.632; mean=713.554; max=942.660
2024-07-27 13:25:05 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:25:21 [INFO] | misfit f_try (i50s03) = 1.592E+01
2024-07-27 13:25:21 [INFO] | saving misfit and step length for step count == 3
2024-07-27 13:25:21 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 13:25:21 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 13:25:21 [INFO] | misfit val  = 1.584E+01, 1.592E+01, 1.604E+01, 1.632E+01
2024-07-27 13:25:21 [INFO] | increment step count -> 4
2024-07-27 13:25:21 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:25:21 [WARN] | step length `alpha` is below minimum threshold value 0.13
2024-07-27 13:25:21 [CRIT] | 
================================================================================
                                EXITING WORKFLOW                                
================================================================================
2024-07-27 13:25:21 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 13:25:21 [INFO] | updating model with `dm` (dm_min=-1.23E+00, dm_max = 1.85E+00)
2024-07-27 13:25:21 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:25:22 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 13:25:22 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:25:22 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:25:22 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:25:22 [INFO] | vs: min=482.453; mean=713.524; max=942.660
2024-07-27 13:25:23 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:25:39 [INFO] | misfit f_try (i50s04) = 1.590E+01
2024-07-27 13:25:39 [INFO] | saving misfit and step length for step count == 4
2024-07-27 13:25:39 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 13:25:39 [INFO] | step length = 0.000E+00, 1.250E-01, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 13:25:39 [INFO] | misfit val  = 1.584E+01, 1.590E+01, 1.592E+01, 1.604E+01, 1.632E+01
2024-07-27 13:25:39 [INFO] | increment step count -> 5
2024-07-27 13:25:39 [INFO] | fail: backtracking line search has failed because the maximum allowable step counts (5) has been exceeded
2024-07-27 13:25:39 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:25:39 [INFO] | Force update of model max and min bounds
2024-07-27 13:25:39 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_50
2024-07-27 13:25:39 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:25:41 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:25:41 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:25:41 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:25:45 [INFO] | completed 9 tasks from task list
2024-07-27 13:25:45 [INFO] | 
================================================================================
                             COMPLETE ITERATION 50                              
================================================================================
2024-07-27 13:25:45 [INFO] | setting current iteration to: 51
2024-07-27 13:25:45 [INFO] | #######################current offset: 6
2024-07-27 13:25:45 [INFO] | 
================================================================================
                              RUNNING ITERATION 51                              
================================================================================
2024-07-27 13:25:45 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:25:45 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:25:45 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:25:47 [INFO] | checking model parameters:
2024-07-27 13:25:47 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:25:47 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:25:47 [INFO] | vs: min=482.264; mean=713.494; max=942.660
2024-07-27 13:25:47 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:26:03 [INFO] | misfit f_new (i51s05) = 2.197E+01
2024-07-27 13:26:03 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:26:03 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:26:23 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:26:23 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:26:52 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:26:52 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:26:53 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:26:53 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:26:53 [INFO] | exporting gradient to disk
2024-07-27 13:26:53 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:26:53 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:26:53 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:26:53 [INFO] | LBFGS iteration incremented -> 51
2024-07-27 13:26:53 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:26:54 [INFO] | new search direction: 60.47째 from current
2024-07-27 13:26:54 [INFO] | new L-BFGS search direction found
2024-07-27 13:26:54 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:26:54 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:26:54 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:26:54 [INFO] | updating model with `dm` (dm_min=-2.59E+00, dm_max = 3.68E+00)
2024-07-27 13:26:55 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:26:55 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:26:55 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:26:55 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:26:55 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:26:55 [INFO] | vs: min=482.591; mean=713.600; max=942.660
2024-07-27 13:26:55 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:27:11 [INFO] | misfit f_try (i51s01) = 2.182E+01
2024-07-27 13:27:11 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:27:11 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:27:11 [INFO] | step count  =         0,         1
2024-07-27 13:27:11 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:27:11 [INFO] | misfit val  = 2.197E+01, 2.182E+01
2024-07-27 13:27:11 [INFO] | increment step count -> 2
2024-07-27 13:27:11 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:27:11 [INFO] | final accepted step count == 1
2024-07-27 13:27:11 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:27:11 [INFO] | updating model with `dm` (dm_min=-2.59E+00, dm_max = 3.68E+00)
2024-07-27 13:27:11 [INFO] | trial step successful. finalizing line search
2024-07-27 13:27:11 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:27:11 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:27:11 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:27:12 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:27:12 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:27:12 [INFO] | misfit of accepted trial model is f=2.182E+01
2024-07-27 13:27:12 [INFO] | resetting line search step count to 0
2024-07-27 13:27:12 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:27:12 [INFO] | Force update of model max and min bounds
2024-07-27 13:27:12 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_51
2024-07-27 13:27:13 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:27:14 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:27:14 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:27:15 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:27:21 [INFO] | completed 9 tasks from task list
2024-07-27 13:27:21 [INFO] | 
================================================================================
                             COMPLETE ITERATION 51                              
================================================================================
2024-07-27 13:27:21 [INFO] | setting current iteration to: 52
2024-07-27 13:27:21 [INFO] | 
================================================================================
                              RUNNING ITERATION 52                              
================================================================================
2024-07-27 13:27:21 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:27:21 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:27:21 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:27:21 [INFO] | checking model parameters:
2024-07-27 13:27:21 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:27:21 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:27:21 [INFO] | vs: min=482.591; mean=713.600; max=942.660
2024-07-27 13:27:21 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:27:38 [INFO] | misfit f_new (i52s00) = 2.182E+01
2024-07-27 13:27:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:27:38 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:27:58 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:27:58 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:28:29 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:28:29 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:28:30 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:28:30 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:28:31 [INFO] | exporting gradient to disk
2024-07-27 13:28:31 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:28:31 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:28:31 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:28:31 [INFO] | LBFGS iteration incremented -> 52
2024-07-27 13:28:31 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:28:31 [INFO] | new search direction: 53.97째 from current
2024-07-27 13:28:31 [INFO] | new L-BFGS search direction found
2024-07-27 13:28:31 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:28:31 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:28:31 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:28:31 [INFO] | updating model with `dm` (dm_min=-2.93E+01, dm_max = 4.45E+01)
2024-07-27 13:28:31 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:28:31 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:28:31 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:28:31 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:28:31 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:28:31 [INFO] | vs: min=484.704; mean=715.786; max=942.660
2024-07-27 13:28:31 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:28:47 [INFO] | misfit f_try (i52s01) = 2.229E+01
2024-07-27 13:28:47 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:28:47 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:28:47 [INFO] | step count  =         0,         1
2024-07-27 13:28:47 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:28:47 [INFO] | misfit val  = 2.182E+01, 2.229E+01
2024-07-27 13:28:47 [INFO] | increment step count -> 2
2024-07-27 13:28:47 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:28:47 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 13:28:47 [INFO] | updating model with `dm` (dm_min=-1.47E+01, dm_max = 2.23E+01)
2024-07-27 13:28:47 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:28:47 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 13:28:47 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:28:47 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:28:47 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:28:47 [INFO] | vs: min=483.649; mean=714.696; max=942.660
2024-07-27 13:28:47 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:29:04 [INFO] | misfit f_try (i52s02) = 2.097E+01
2024-07-27 13:29:04 [INFO] | saving misfit and step length for step count == 2
2024-07-27 13:29:04 [INFO] | step count  =         0,         1,         2
2024-07-27 13:29:04 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 13:29:04 [INFO] | misfit val  = 2.182E+01, 2.097E+01, 2.229E+01
2024-07-27 13:29:04 [INFO] | increment step count -> 3
2024-07-27 13:29:04 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:29:04 [INFO] | final accepted step count == 2
2024-07-27 13:29:04 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 13:29:04 [INFO] | updating model with `dm` (dm_min=-1.47E+01, dm_max = 2.23E+01)
2024-07-27 13:29:04 [INFO] | trial step successful. finalizing line search
2024-07-27 13:29:04 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:29:04 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:29:04 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:29:04 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:29:04 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:29:04 [INFO] | misfit of accepted trial model is f=2.097E+01
2024-07-27 13:29:04 [INFO] | resetting line search step count to 0
2024-07-27 13:29:04 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:29:04 [INFO] | Force update of model max and min bounds
2024-07-27 13:29:04 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_52
2024-07-27 13:29:05 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:29:05 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:29:05 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:29:06 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:29:11 [INFO] | completed 9 tasks from task list
2024-07-27 13:29:11 [INFO] | 
================================================================================
                             COMPLETE ITERATION 52                              
================================================================================
2024-07-27 13:29:11 [INFO] | setting current iteration to: 53
2024-07-27 13:29:11 [INFO] | 
================================================================================
                              RUNNING ITERATION 53                              
================================================================================
2024-07-27 13:29:11 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:29:11 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:29:11 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:29:12 [INFO] | checking model parameters:
2024-07-27 13:29:12 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:29:12 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:29:12 [INFO] | vs: min=483.649; mean=714.696; max=942.660
2024-07-27 13:29:12 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:29:28 [INFO] | misfit f_new (i53s00) = 2.097E+01
2024-07-27 13:29:28 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:29:28 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:29:48 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:29:48 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:30:19 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:30:19 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:30:19 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:30:19 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:30:19 [INFO] | exporting gradient to disk
2024-07-27 13:30:19 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:30:19 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:30:19 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:30:19 [INFO] | LBFGS iteration incremented -> 53
2024-07-27 13:30:19 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:30:19 [INFO] | new search direction: 59.00째 from current
2024-07-27 13:30:19 [INFO] | new L-BFGS search direction found
2024-07-27 13:30:19 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:30:19 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:30:19 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:30:19 [INFO] | updating model with `dm` (dm_min=-1.39E+01, dm_max = 2.42E+01)
2024-07-27 13:30:21 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:30:21 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:30:21 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:30:21 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:30:21 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:30:21 [INFO] | vs: min=482.970; mean=715.827; max=942.660
2024-07-27 13:30:21 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:30:37 [INFO] | misfit f_try (i53s01) = 2.178E+01
2024-07-27 13:30:37 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:30:37 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:30:37 [INFO] | step count  =         0,         1
2024-07-27 13:30:37 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:30:37 [INFO] | misfit val  = 2.097E+01, 2.178E+01
2024-07-27 13:30:37 [INFO] | increment step count -> 2
2024-07-27 13:30:37 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:30:37 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 13:30:37 [INFO] | updating model with `dm` (dm_min=-6.94E+00, dm_max = 1.21E+01)
2024-07-27 13:30:37 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:30:38 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 13:30:38 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:30:38 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:30:38 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:30:38 [INFO] | vs: min=483.309; mean=715.270; max=942.660
2024-07-27 13:30:38 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:30:53 [INFO] | misfit f_try (i53s02) = 2.076E+01
2024-07-27 13:30:53 [INFO] | saving misfit and step length for step count == 2
2024-07-27 13:30:53 [INFO] | step count  =         0,         1,         2
2024-07-27 13:30:53 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 13:30:53 [INFO] | misfit val  = 2.097E+01, 2.076E+01, 2.178E+01
2024-07-27 13:30:53 [INFO] | increment step count -> 3
2024-07-27 13:30:53 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:30:53 [INFO] | final accepted step count == 2
2024-07-27 13:30:53 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 13:30:53 [INFO] | updating model with `dm` (dm_min=-6.94E+00, dm_max = 1.21E+01)
2024-07-27 13:30:53 [INFO] | trial step successful. finalizing line search
2024-07-27 13:30:53 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:30:53 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:30:53 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:30:54 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:30:54 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:30:54 [INFO] | misfit of accepted trial model is f=2.076E+01
2024-07-27 13:30:54 [INFO] | resetting line search step count to 0
2024-07-27 13:30:54 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:30:54 [INFO] | Force update of model max and min bounds
2024-07-27 13:30:54 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_53
2024-07-27 13:30:55 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:30:55 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:30:55 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:30:57 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:31:01 [INFO] | completed 9 tasks from task list
2024-07-27 13:31:01 [INFO] | 
================================================================================
                             COMPLETE ITERATION 53                              
================================================================================
2024-07-27 13:31:01 [INFO] | setting current iteration to: 54
2024-07-27 13:31:01 [INFO] | 
================================================================================
                              RUNNING ITERATION 54                              
================================================================================
2024-07-27 13:31:01 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:31:01 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:31:01 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:31:02 [INFO] | checking model parameters:
2024-07-27 13:31:02 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:31:02 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:31:02 [INFO] | vs: min=483.309; mean=715.270; max=942.660
2024-07-27 13:31:02 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:31:18 [INFO] | misfit f_new (i54s00) = 2.076E+01
2024-07-27 13:31:18 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:31:18 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:31:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:31:38 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:32:07 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:32:07 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:32:09 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:32:09 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:32:10 [INFO] | exporting gradient to disk
2024-07-27 13:32:10 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:32:10 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:32:10 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:32:10 [INFO] | LBFGS iteration incremented -> 54
2024-07-27 13:32:10 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:32:10 [INFO] | new search direction: 54.51째 from current
2024-07-27 13:32:10 [INFO] | new L-BFGS search direction found
2024-07-27 13:32:10 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:32:10 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:32:10 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:32:10 [INFO] | updating model with `dm` (dm_min=-1.20E+01, dm_max = 2.24E+01)
2024-07-27 13:32:11 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:32:11 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:32:11 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:32:11 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:32:11 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:32:11 [INFO] | vs: min=483.936; mean=716.637; max=942.660
2024-07-27 13:32:11 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:32:27 [INFO] | misfit f_try (i54s01) = 2.058E+01
2024-07-27 13:32:27 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:32:27 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:32:27 [INFO] | step count  =         0,         1
2024-07-27 13:32:27 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:32:27 [INFO] | misfit val  = 2.076E+01, 2.058E+01
2024-07-27 13:32:27 [INFO] | increment step count -> 2
2024-07-27 13:32:27 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:32:27 [INFO] | final accepted step count == 1
2024-07-27 13:32:27 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:32:27 [INFO] | updating model with `dm` (dm_min=-1.20E+01, dm_max = 2.24E+01)
2024-07-27 13:32:27 [INFO] | trial step successful. finalizing line search
2024-07-27 13:32:27 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:32:27 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:32:27 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:32:27 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:32:27 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:32:27 [INFO] | misfit of accepted trial model is f=2.058E+01
2024-07-27 13:32:27 [INFO] | resetting line search step count to 0
2024-07-27 13:32:27 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:32:27 [INFO] | Force update of model max and min bounds
2024-07-27 13:32:27 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_54
2024-07-27 13:32:27 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:32:29 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:32:29 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:32:30 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:32:34 [INFO] | completed 9 tasks from task list
2024-07-27 13:32:34 [INFO] | 
================================================================================
                             COMPLETE ITERATION 54                              
================================================================================
2024-07-27 13:32:34 [INFO] | setting current iteration to: 55
2024-07-27 13:32:34 [INFO] | 
================================================================================
                              RUNNING ITERATION 55                              
================================================================================
2024-07-27 13:32:34 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:32:34 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:32:34 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:32:34 [INFO] | checking model parameters:
2024-07-27 13:32:34 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:32:34 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:32:34 [INFO] | vs: min=483.936; mean=716.637; max=942.660
2024-07-27 13:32:34 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:32:51 [INFO] | misfit f_new (i55s00) = 2.058E+01
2024-07-27 13:32:51 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:32:51 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:33:11 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:33:11 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:33:41 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:33:41 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:33:42 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:33:42 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:33:43 [INFO] | exporting gradient to disk
2024-07-27 13:33:43 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:33:43 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:33:43 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:33:43 [INFO] | LBFGS iteration incremented -> 55
2024-07-27 13:33:43 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:33:43 [INFO] | new search direction: 57.45째 from current
2024-07-27 13:33:43 [INFO] | new L-BFGS search direction found
2024-07-27 13:33:43 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:33:43 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:33:43 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:33:43 [INFO] | updating model with `dm` (dm_min=-1.49E+01, dm_max = 2.90E+01)
2024-07-27 13:33:45 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:33:45 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:33:45 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:33:45 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:33:45 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:33:45 [INFO] | vs: min=484.246; mean=718.621; max=942.660
2024-07-27 13:33:45 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:34:01 [INFO] | misfit f_try (i55s01) = 1.980E+01
2024-07-27 13:34:01 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:34:01 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:34:01 [INFO] | step count  =         0,         1
2024-07-27 13:34:01 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:34:01 [INFO] | misfit val  = 2.058E+01, 1.980E+01
2024-07-27 13:34:01 [INFO] | increment step count -> 2
2024-07-27 13:34:01 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:34:01 [INFO] | final accepted step count == 1
2024-07-27 13:34:01 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:34:01 [INFO] | updating model with `dm` (dm_min=-1.49E+01, dm_max = 2.90E+01)
2024-07-27 13:34:01 [INFO] | trial step successful. finalizing line search
2024-07-27 13:34:01 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:34:01 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:34:01 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:34:02 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:34:02 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:34:02 [INFO] | misfit of accepted trial model is f=1.980E+01
2024-07-27 13:34:02 [INFO] | resetting line search step count to 0
2024-07-27 13:34:02 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:34:02 [INFO] | Force update of model max and min bounds
2024-07-27 13:34:02 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_55
2024-07-27 13:34:03 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:34:04 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:34:04 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:34:05 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:34:09 [INFO] | completed 9 tasks from task list
2024-07-27 13:34:09 [INFO] | 
================================================================================
                             COMPLETE ITERATION 55                              
================================================================================
2024-07-27 13:34:09 [INFO] | setting current iteration to: 56
2024-07-27 13:34:09 [INFO] | 
================================================================================
                              RUNNING ITERATION 56                              
================================================================================
2024-07-27 13:34:09 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:34:09 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:34:09 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:34:10 [INFO] | checking model parameters:
2024-07-27 13:34:10 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:34:10 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:34:10 [INFO] | vs: min=484.246; mean=718.621; max=942.660
2024-07-27 13:34:10 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:34:27 [INFO] | misfit f_new (i56s00) = 1.980E+01
2024-07-27 13:34:27 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:34:27 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:34:47 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:34:47 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:35:17 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:35:17 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:35:19 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:35:19 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:35:20 [INFO] | exporting gradient to disk
2024-07-27 13:35:20 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:35:20 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:35:20 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:35:20 [INFO] | LBFGS iteration incremented -> 56
2024-07-27 13:35:20 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:35:20 [INFO] | new search direction: 59.33째 from current
2024-07-27 13:35:20 [INFO] | new L-BFGS search direction found
2024-07-27 13:35:20 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:35:20 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:35:20 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:35:20 [INFO] | updating model with `dm` (dm_min=-1.74E+01, dm_max = 2.54E+01)
2024-07-27 13:35:21 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:35:21 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:35:21 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:35:21 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:35:21 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:35:21 [INFO] | vs: min=482.622; mean=720.219; max=942.660
2024-07-27 13:35:21 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:35:38 [INFO] | misfit f_try (i56s01) = 1.691E+01
2024-07-27 13:35:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:35:38 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:35:38 [INFO] | step count  =         0,         1
2024-07-27 13:35:38 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:35:38 [INFO] | misfit val  = 1.980E+01, 1.691E+01
2024-07-27 13:35:38 [INFO] | increment step count -> 2
2024-07-27 13:35:38 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:35:38 [INFO] | final accepted step count == 1
2024-07-27 13:35:38 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:35:38 [INFO] | updating model with `dm` (dm_min=-1.74E+01, dm_max = 2.54E+01)
2024-07-27 13:35:38 [INFO] | trial step successful. finalizing line search
2024-07-27 13:35:38 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:35:38 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:35:38 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:35:38 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:35:38 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:35:38 [INFO] | misfit of accepted trial model is f=1.691E+01
2024-07-27 13:35:38 [INFO] | resetting line search step count to 0
2024-07-27 13:35:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:35:38 [INFO] | Force update of model max and min bounds
2024-07-27 13:35:38 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_56
2024-07-27 13:35:39 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:35:41 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:35:41 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:35:42 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:35:47 [INFO] | completed 9 tasks from task list
2024-07-27 13:35:47 [INFO] | 
================================================================================
                             COMPLETE ITERATION 56                              
================================================================================
2024-07-27 13:35:47 [INFO] | setting current iteration to: 57
2024-07-27 13:35:47 [INFO] | 
================================================================================
                              RUNNING ITERATION 57                              
================================================================================
2024-07-27 13:35:47 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:35:47 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:35:47 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:35:48 [INFO] | checking model parameters:
2024-07-27 13:35:48 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:35:48 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:35:48 [INFO] | vs: min=482.622; mean=720.219; max=942.660
2024-07-27 13:35:48 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:36:04 [INFO] | misfit f_new (i57s00) = 1.691E+01
2024-07-27 13:36:04 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:36:04 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:36:24 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:36:24 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:36:54 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:36:54 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:36:55 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:36:55 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:36:56 [INFO] | exporting gradient to disk
2024-07-27 13:36:56 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:36:56 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:36:56 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:36:56 [INFO] | LBFGS iteration incremented -> 57
2024-07-27 13:36:56 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:36:56 [INFO] | new search direction: 56.93째 from current
2024-07-27 13:36:56 [INFO] | new L-BFGS search direction found
2024-07-27 13:36:56 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:36:56 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:36:56 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:36:56 [INFO] | updating model with `dm` (dm_min=-1.91E+01, dm_max = 2.27E+01)
2024-07-27 13:36:58 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:36:58 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:36:58 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:36:58 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:36:58 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:36:58 [INFO] | vs: min=483.510; mean=721.489; max=942.660
2024-07-27 13:36:58 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:37:14 [INFO] | misfit f_try (i57s01) = 1.309E+01
2024-07-27 13:37:14 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:37:14 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:37:14 [INFO] | step count  =         0,         1
2024-07-27 13:37:14 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:37:14 [INFO] | misfit val  = 1.691E+01, 1.309E+01
2024-07-27 13:37:14 [INFO] | increment step count -> 2
2024-07-27 13:37:14 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:37:14 [INFO] | final accepted step count == 1
2024-07-27 13:37:14 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:37:14 [INFO] | updating model with `dm` (dm_min=-1.91E+01, dm_max = 2.27E+01)
2024-07-27 13:37:14 [INFO] | trial step successful. finalizing line search
2024-07-27 13:37:14 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:37:14 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:37:14 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:37:14 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:37:14 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:37:14 [INFO] | misfit of accepted trial model is f=1.309E+01
2024-07-27 13:37:14 [INFO] | resetting line search step count to 0
2024-07-27 13:37:14 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:37:14 [INFO] | Force update of model max and min bounds
2024-07-27 13:37:14 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_57
2024-07-27 13:37:16 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:37:17 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:37:17 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:37:18 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:37:21 [INFO] | completed 9 tasks from task list
2024-07-27 13:37:21 [INFO] | 
================================================================================
                             COMPLETE ITERATION 57                              
================================================================================
2024-07-27 13:37:21 [INFO] | setting current iteration to: 58
2024-07-27 13:37:21 [INFO] | 
================================================================================
                              RUNNING ITERATION 58                              
================================================================================
2024-07-27 13:37:21 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:37:21 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:37:21 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:37:21 [INFO] | checking model parameters:
2024-07-27 13:37:21 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:37:21 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:37:21 [INFO] | vs: min=483.510; mean=721.489; max=942.660
2024-07-27 13:37:21 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:37:38 [INFO] | misfit f_new (i58s00) = 1.309E+01
2024-07-27 13:37:38 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:37:38 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:37:58 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:37:58 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:38:26 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:38:26 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:38:26 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:38:26 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:38:27 [INFO] | exporting gradient to disk
2024-07-27 13:38:27 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:38:27 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:38:27 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:38:27 [INFO] | LBFGS iteration incremented -> 58
2024-07-27 13:38:27 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:38:27 [INFO] | new search direction: 57.67째 from current
2024-07-27 13:38:27 [INFO] | new L-BFGS search direction found
2024-07-27 13:38:27 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:38:27 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:38:27 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:38:27 [INFO] | updating model with `dm` (dm_min=-2.69E+01, dm_max = 1.43E+01)
2024-07-27 13:38:27 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:38:27 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:38:27 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:38:27 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:38:27 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:38:27 [INFO] | vs: min=481.780; mean=720.657; max=942.660
2024-07-27 13:38:27 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:38:44 [INFO] | misfit f_try (i58s01) = 1.165E+01
2024-07-27 13:38:44 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:38:44 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:38:44 [INFO] | step count  =         0,         1
2024-07-27 13:38:44 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:38:44 [INFO] | misfit val  = 1.309E+01, 1.165E+01
2024-07-27 13:38:44 [INFO] | increment step count -> 2
2024-07-27 13:38:44 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:38:44 [INFO] | final accepted step count == 1
2024-07-27 13:38:44 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:38:44 [INFO] | updating model with `dm` (dm_min=-2.69E+01, dm_max = 1.43E+01)
2024-07-27 13:38:44 [INFO] | trial step successful. finalizing line search
2024-07-27 13:38:44 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:38:44 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:38:44 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:38:44 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:38:44 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:38:44 [INFO] | misfit of accepted trial model is f=1.165E+01
2024-07-27 13:38:44 [INFO] | resetting line search step count to 0
2024-07-27 13:38:44 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:38:44 [INFO] | Force update of model max and min bounds
2024-07-27 13:38:44 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_58
2024-07-27 13:38:45 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:38:45 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:38:45 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:38:47 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:38:52 [INFO] | completed 9 tasks from task list
2024-07-27 13:38:52 [INFO] | 
================================================================================
                             COMPLETE ITERATION 58                              
================================================================================
2024-07-27 13:38:52 [INFO] | setting current iteration to: 59
2024-07-27 13:38:52 [INFO] | 
================================================================================
                              RUNNING ITERATION 59                              
================================================================================
2024-07-27 13:38:52 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:38:52 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:38:52 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:38:52 [INFO] | checking model parameters:
2024-07-27 13:38:52 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:38:52 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:38:52 [INFO] | vs: min=481.780; mean=720.657; max=942.660
2024-07-27 13:38:52 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:39:09 [INFO] | misfit f_new (i59s00) = 1.165E+01
2024-07-27 13:39:09 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:39:09 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:39:29 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:39:29 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:40:01 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:40:01 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:40:01 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:40:01 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:40:01 [INFO] | exporting gradient to disk
2024-07-27 13:40:01 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:40:01 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:40:01 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:40:01 [INFO] | LBFGS iteration incremented -> 59
2024-07-27 13:40:01 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:40:01 [INFO] | new search direction: 55.65째 from current
2024-07-27 13:40:01 [INFO] | new L-BFGS search direction found
2024-07-27 13:40:01 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:40:01 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:40:01 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:40:01 [INFO] | updating model with `dm` (dm_min=-1.58E+01, dm_max = 1.23E+01)
2024-07-27 13:40:03 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:40:03 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:40:03 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:40:03 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:40:03 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:40:03 [INFO] | vs: min=481.780; mean=719.659; max=942.660
2024-07-27 13:40:03 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:40:19 [INFO] | misfit f_try (i59s01) = 1.133E+01
2024-07-27 13:40:19 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:40:19 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:40:19 [INFO] | step count  =         0,         1
2024-07-27 13:40:19 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:40:19 [INFO] | misfit val  = 1.165E+01, 1.133E+01
2024-07-27 13:40:19 [INFO] | increment step count -> 2
2024-07-27 13:40:19 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:40:19 [INFO] | final accepted step count == 1
2024-07-27 13:40:19 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:40:19 [INFO] | updating model with `dm` (dm_min=-1.58E+01, dm_max = 1.23E+01)
2024-07-27 13:40:19 [INFO] | trial step successful. finalizing line search
2024-07-27 13:40:19 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:40:19 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:40:19 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:40:20 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:40:20 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:40:20 [INFO] | misfit of accepted trial model is f=1.133E+01
2024-07-27 13:40:20 [INFO] | resetting line search step count to 0
2024-07-27 13:40:20 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:40:20 [INFO] | Force update of model max and min bounds
2024-07-27 13:40:20 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_59
2024-07-27 13:40:21 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:40:22 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:40:22 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:40:24 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:40:28 [INFO] | completed 9 tasks from task list
2024-07-27 13:40:28 [INFO] | 
================================================================================
                             COMPLETE ITERATION 59                              
================================================================================
2024-07-27 13:40:28 [INFO] | setting current iteration to: 60
2024-07-27 13:40:28 [INFO] | 
================================================================================
                              RUNNING ITERATION 60                              
================================================================================
2024-07-27 13:40:28 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:40:28 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:40:28 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:40:29 [INFO] | checking model parameters:
2024-07-27 13:40:29 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:40:29 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:40:29 [INFO] | vs: min=481.780; mean=719.659; max=942.660
2024-07-27 13:40:29 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:40:44 [INFO] | misfit f_new (i60s00) = 1.133E+01
2024-07-27 13:40:44 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:40:44 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:41:04 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:41:04 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:41:35 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:41:35 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:41:37 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:41:37 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:41:39 [INFO] | exporting gradient to disk
2024-07-27 13:41:39 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:41:39 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:41:39 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:41:39 [INFO] | LBFGS iteration incremented -> 60
2024-07-27 13:41:39 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:41:39 [INFO] | new search direction: 46.64째 from current
2024-07-27 13:41:39 [INFO] | new L-BFGS search direction found
2024-07-27 13:41:39 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:41:39 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:41:39 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:41:39 [INFO] | updating model with `dm` (dm_min=-1.02E+01, dm_max = 7.90E+00)
2024-07-27 13:41:40 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:41:40 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:41:40 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:41:40 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:41:40 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:41:40 [INFO] | vs: min=483.487; mean=718.783; max=942.660
2024-07-27 13:41:40 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:41:57 [INFO] | misfit f_try (i60s01) = 1.186E+01
2024-07-27 13:41:57 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:41:57 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:41:57 [INFO] | step count  =         0,         1
2024-07-27 13:41:57 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:41:57 [INFO] | misfit val  = 1.133E+01, 1.186E+01
2024-07-27 13:41:57 [INFO] | increment step count -> 2
2024-07-27 13:41:57 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:41:57 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 13:41:57 [INFO] | updating model with `dm` (dm_min=-5.08E+00, dm_max = 3.95E+00)
2024-07-27 13:41:57 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:41:57 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 13:41:57 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:41:57 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:41:57 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:41:57 [INFO] | vs: min=482.934; mean=719.222; max=942.660
2024-07-27 13:41:57 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:42:13 [INFO] | misfit f_try (i60s02) = 1.123E+01
2024-07-27 13:42:13 [INFO] | saving misfit and step length for step count == 2
2024-07-27 13:42:13 [INFO] | step count  =         0,         1,         2
2024-07-27 13:42:13 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 13:42:13 [INFO] | misfit val  = 1.133E+01, 1.123E+01, 1.186E+01
2024-07-27 13:42:13 [INFO] | increment step count -> 3
2024-07-27 13:42:13 [INFO] | pass: misfit decreased, line search successful
2024-07-27 13:42:13 [INFO] | final accepted step count == 2
2024-07-27 13:42:13 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 13:42:13 [INFO] | updating model with `dm` (dm_min=-5.08E+00, dm_max = 3.95E+00)
2024-07-27 13:42:13 [INFO] | trial step successful. finalizing line search
2024-07-27 13:42:13 [INFO] | 
FINALIZING LINE SEARCH
--------------------------------------------------------------------------------
2024-07-27 13:42:13 [INFO] | removing previously accepted model files (?_old)
2024-07-27 13:42:13 [INFO] | writing optimization stats: '/csim1/zhangchang/testmodel2/output/optimize/output_optim.txt'
2024-07-27 13:42:14 [INFO] | setting current model as previous model (new -> old)
2024-07-27 13:42:14 [INFO] | setting trial model as starting model (m_try -> m_new)
2024-07-27 13:42:14 [INFO] | misfit of accepted trial model is f=1.123E+01
2024-07-27 13:42:14 [INFO] | resetting line search step count to 0
2024-07-27 13:42:14 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:42:14 [INFO] | Force update of model max and min bounds
2024-07-27 13:42:14 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_60
2024-07-27 13:42:14 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:42:15 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:42:15 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:42:16 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:42:19 [INFO] | completed 9 tasks from task list
2024-07-27 13:42:19 [INFO] | 
================================================================================
                             COMPLETE ITERATION 60                              
================================================================================
2024-07-27 13:42:19 [INFO] | setting current iteration to: 61
2024-07-27 13:42:19 [INFO] | 
================================================================================
                              RUNNING ITERATION 61                              
================================================================================
2024-07-27 13:42:19 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            GENERATE SYNTHETIC DATA                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:42:19 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            EVALUATE INITIAL MISFIT                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:42:19 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                      EVALUATING MISFIT FOR MODEL `m_new`                       
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:42:20 [INFO] | checking model parameters:
2024-07-27 13:42:20 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:42:20 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:42:20 [INFO] | vs: min=482.934; mean=719.222; max=942.660
2024-07-27 13:42:20 [INFO] | running functions ['prepare_data_for_solver', 'run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:42:37 [INFO] | misfit f_new (i61s00) = 1.123E+01
2024-07-27 13:42:37 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                            RUN ADJOINT SIMULATIONS                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:42:37 [INFO] | running functions ['_run_adjoint_simulation_single'] on system 30 times
2024-07-27 13:42:57 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                           POSTPROCESS EVENT KERNELS                            
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:42:57 [INFO] | running functions ['combine_event_kernels', 'smooth_misfit_kernel', 'update_with_hessian'] on system 1 times
2024-07-27 13:43:27 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                         EVALUATE GRADIENT FROM KERNELS                         
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:43:27 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:43:29 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:43:29 [INFO] | scaling gradient to absolute model perturbations
2024-07-27 13:43:29 [INFO] | exporting gradient to disk
2024-07-27 13:43:29 [INFO] | exposing gradient `g_new` to optimization library
2024-07-27 13:43:29 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:43:29 [INFO] | calculating search direction `p_new` from gradient
2024-07-27 13:43:29 [INFO] | LBFGS iteration incremented -> 61
2024-07-27 13:43:29 [INFO] | applying inverse Hessian to gradient
2024-07-27 13:43:29 [INFO] | new search direction: 43.45째 from current
2024-07-27 13:43:29 [INFO] | new L-BFGS search direction found
2024-07-27 13:43:29 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                             INITIALIZE LINE SEARCH                             
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:43:29 [INFO] | try: first step of iteration, attempt unit step
2024-07-27 13:43:29 [INFO] | step length `alpha` = 1.000E+00
2024-07-27 13:43:29 [INFO] | updating model with `dm` (dm_min=-9.10E+00, dm_max = 1.20E+01)
2024-07-27 13:43:30 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                          EVALUATE LINE SEARCH MISFIT                           
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:43:30 [INFO] | 
LINE SEARCH STEP COUNT 01
--------------------------------------------------------------------------------
2024-07-27 13:43:30 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:43:30 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:43:30 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:43:30 [INFO] | vs: min=484.712; mean=719.191; max=942.660
2024-07-27 13:43:30 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:43:46 [INFO] | misfit f_try (i61s01) = 1.217E+01
2024-07-27 13:43:46 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               UPDATE LINE SEARCH                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:43:46 [INFO] | saving misfit and step length for step count == 1
2024-07-27 13:43:46 [INFO] | step count  =         0,         1
2024-07-27 13:43:46 [INFO] | step length = 0.000E+00, 1.000E+00
2024-07-27 13:43:46 [INFO] | misfit val  = 1.123E+01, 1.217E+01
2024-07-27 13:43:46 [INFO] | increment step count -> 2
2024-07-27 13:43:46 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:43:46 [INFO] | step length `alpha` = 5.000E-01
2024-07-27 13:43:46 [INFO] | updating model with `dm` (dm_min=-4.55E+00, dm_max = 5.99E+00)
2024-07-27 13:43:46 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:43:46 [INFO] | 
LINE SEARCH STEP COUNT 02
--------------------------------------------------------------------------------
2024-07-27 13:43:46 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:43:46 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:43:46 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:43:46 [INFO] | vs: min=484.117; mean=719.209; max=942.660
2024-07-27 13:43:47 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:44:03 [INFO] | misfit f_try (i61s02) = 1.155E+01
2024-07-27 13:44:03 [INFO] | saving misfit and step length for step count == 2
2024-07-27 13:44:03 [INFO] | step count  =         0,         1,         2
2024-07-27 13:44:03 [INFO] | step length = 0.000E+00, 5.000E-01, 1.000E+00
2024-07-27 13:44:03 [INFO] | misfit val  = 1.123E+01, 1.155E+01, 1.217E+01
2024-07-27 13:44:03 [INFO] | increment step count -> 3
2024-07-27 13:44:03 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:44:03 [INFO] | step length `alpha` = 2.500E-01
2024-07-27 13:44:03 [INFO] | updating model with `dm` (dm_min=-2.27E+00, dm_max = 3.00E+00)
2024-07-27 13:44:03 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:44:05 [INFO] | 
LINE SEARCH STEP COUNT 03
--------------------------------------------------------------------------------
2024-07-27 13:44:05 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:44:05 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:44:05 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:44:05 [INFO] | vs: min=483.526; mean=719.216; max=942.660
2024-07-27 13:44:05 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:44:21 [INFO] | misfit f_try (i61s03) = 1.136E+01
2024-07-27 13:44:21 [INFO] | saving misfit and step length for step count == 3
2024-07-27 13:44:21 [INFO] | step count  =         0,         1,         2,         3
2024-07-27 13:44:21 [INFO] | step length = 0.000E+00, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 13:44:21 [INFO] | misfit val  = 1.123E+01, 1.136E+01, 1.155E+01, 1.217E+01
2024-07-27 13:44:21 [INFO] | increment step count -> 4
2024-07-27 13:44:21 [INFO] | try: misfit increasing, parabloic backtrack to decrease step length
2024-07-27 13:44:21 [WARN] | step length `alpha` is below minimum threshold value 0.16
2024-07-27 13:44:21 [CRIT] | 
================================================================================
                                EXITING WORKFLOW                                
================================================================================
2024-07-27 13:44:21 [INFO] | step length `alpha` = 1.250E-01
2024-07-27 13:44:21 [INFO] | updating model with `dm` (dm_min=-1.14E+00, dm_max = 1.50E+00)
2024-07-27 13:44:21 [INFO] | trial step unsuccessful. re-attempting line search
2024-07-27 13:44:23 [INFO] | 
LINE SEARCH STEP COUNT 04
--------------------------------------------------------------------------------
2024-07-27 13:44:23 [INFO] | `m_try` model parameters for line search evaluation:
2024-07-27 13:44:23 [WARN] | no coordinates found for assumed SPECFEM2D model, will not be able to plot figures
2024-07-27 13:44:23 [INFO] | vp: min=963.552; mean=1409.087; max=1869.695
2024-07-27 13:44:23 [INFO] | vs: min=483.230; mean=719.219; max=942.660
2024-07-27 13:44:23 [INFO] | running functions ['run_forward_simulations', 'evaluate_objective_function'] on system 30 times
2024-07-27 13:44:40 [INFO] | misfit f_try (i61s04) = 1.127E+01
2024-07-27 13:44:40 [INFO] | saving misfit and step length for step count == 4
2024-07-27 13:44:40 [INFO] | step count  =         0,         1,         2,         3,         4
2024-07-27 13:44:40 [INFO] | step length = 0.000E+00, 1.250E-01, 2.500E-01, 5.000E-01, 1.000E+00
2024-07-27 13:44:40 [INFO] | misfit val  = 1.123E+01, 1.127E+01, 1.136E+01, 1.155E+01, 1.217E+01
2024-07-27 13:44:40 [INFO] | increment step count -> 5
2024-07-27 13:44:40 [INFO] | fail: backtracking line search has failed because the maximum allowable step counts (5) has been exceeded
2024-07-27 13:44:40 [INFO] | 
////////////////////////////////////////////////////////////////////////////////
                               FINALIZE ITERATION                               
////////////////////////////////////////////////////////////////////////////////
2024-07-27 13:44:40 [INFO] | Force update of model max and min bounds
2024-07-27 13:44:40 [INFO] | writing model `m_new` to /csim1/zhangchang/testmodel2/output/MODEL_61
2024-07-27 13:44:41 [INFO] | running finalization for module 'system.Cluster'
2024-07-27 13:44:42 [INFO] | running finalization for module 'solver.Specfem2Dwd'
2024-07-27 13:44:42 [INFO] | running finalization for module 'preprocess.Default'
2024-07-27 13:44:43 [INFO] | cleaning out scratch directory for next iteration
2024-07-27 13:44:46 [INFO] | completed 9 tasks from task list
2024-07-27 13:44:46 [INFO] | 
================================================================================
                             COMPLETE ITERATION 61                              
================================================================================
2024-07-27 13:44:46 [INFO] | setting current iteration to: 62
2024-07-27 13:44:46 [INFO] | #######################current offset: 3
